(()=>{var e={129:(e,t,n)=>{"use strict";n.d(t,{Z:()=>c});e=n.hmd(e);const o=window.ipcRenderer,a={},i={},r={};let s=0;class c{static on(e){var t=this;let n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(e=Object.assign({id:null,name:null,namespace:null,caller:null,onlyInvoke:!1},e),"string"!==$.type(e.id)||!e.id.length)throw new Error("Event id must be a non-empty string");if("string"!==$.type(e.name)||!e.name.length)throw new Error("Event name must be a non-empty string");if(n&&Object.prototype.hasOwnProperty.call(a,e.id)&&this.off(e.id),Object.prototype.hasOwnProperty.call(a,e.id))throw new Error("Duplicating declaration of event.".concat(e.id));return"string"===$.type(e.namespace)&&e.namespace.length||(e.namespace=e.id),a[e.id]={name:e.name,namespace:e.namespace,caller:e.caller,onlyInvoke:e.onlyInvoke},"function"===$.type(e.caller)&&o.on(e.name,(function(n){for(var o=arguments.length,a=new Array(o>1?o-1:0),i=1;i<o;i++)a[i-1]=arguments[i];Object.values(r,(n=>{(async()=>{n.apply(t.events[e.id],[e.id].concat(a))})()})),n.returnValue=e.caller.apply(t.events[e.id],[n].concat(a))})),this}static off(e){if(!(arguments.length>1&&void 0!==arguments[1]&&arguments[1])&&!Object.prototype.hasOwnProperty.call(a,e))throw new Error("Removing non-existing event.".concat(e," is not allowed"));return o.removeAllListeners(a[e].name),delete i[a[e].namespace],delete a[e],this}static cache(e){if("string"===$.type(e))throw new Error("Cache namespace must be a string");return Object.prototype.hasOwnProperty.call(i,e)||(i[e]={}),i[e]}static subscribe(e){return r[++s]=e,s}static unsubscribe(e){delete r[e]}}var l,d,u;l=c,d="events",u=new Proxy(a,{get(t,n){if("__having__"===n)return e=>Object.prototype.hasOwnProperty.call(t,e);const a=Object.prototype.hasOwnProperty.call(t,n)?{invoke:function(){for(var e=arguments.length,a=new Array(e),i=0;i<e;i++)a[i]=arguments[i];return o.invoke.apply(null,[t[n].name].concat(a))},send:function(){if(t[n].onlyInvoke)throw new Error("Event `".concat(n,"` is only invoke-able"));for(var e=arguments.length,a=new Array(e),i=0;i<e;i++)a[i]=arguments[i];o.send.apply(null,[t[n].name].concat(a))},sendSync:function(){if(t[n].onlyInvoke)throw new Error("Event `".concat(n,"` is only invoke-able"));for(var e=arguments.length,a=new Array(e),i=0;i<e;i++)a[i]=arguments[i];return o.sendSync.apply(null,[t[n].name].concat(a))},trigger:function(e){for(var o=arguments.length,i=new Array(o>1?o-1:0),r=1;r<o;r++)i[r-1]=arguments[r];return"function"===$.type(t[n].caller)?t[n].caller.apply(a,[e].concat(i)):null},get cache(){return o=t[n].namespace,e.exports.cache(o);var o}}:null;return a}}),d in l?Object.defineProperty(l,d,{value:u,enumerable:!0,configurable:!0,writable:!0}):l[d]=u},279:e=>{e.exports=function(e){"use strict";var t=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"];function n(e,t){var n=e[0],o=e[1],a=e[2],i=e[3];o=((o+=((a=((a+=((i=((i+=((n=((n+=(o&a|~o&i)+t[0]-680876936|0)<<7|n>>>25)+o|0)&o|~n&a)+t[1]-389564586|0)<<12|i>>>20)+n|0)&n|~i&o)+t[2]+606105819|0)<<17|a>>>15)+i|0)&i|~a&n)+t[3]-1044525330|0)<<22|o>>>10)+a|0,o=((o+=((a=((a+=((i=((i+=((n=((n+=(o&a|~o&i)+t[4]-176418897|0)<<7|n>>>25)+o|0)&o|~n&a)+t[5]+1200080426|0)<<12|i>>>20)+n|0)&n|~i&o)+t[6]-1473231341|0)<<17|a>>>15)+i|0)&i|~a&n)+t[7]-45705983|0)<<22|o>>>10)+a|0,o=((o+=((a=((a+=((i=((i+=((n=((n+=(o&a|~o&i)+t[8]+1770035416|0)<<7|n>>>25)+o|0)&o|~n&a)+t[9]-1958414417|0)<<12|i>>>20)+n|0)&n|~i&o)+t[10]-42063|0)<<17|a>>>15)+i|0)&i|~a&n)+t[11]-1990404162|0)<<22|o>>>10)+a|0,o=((o+=((a=((a+=((i=((i+=((n=((n+=(o&a|~o&i)+t[12]+1804603682|0)<<7|n>>>25)+o|0)&o|~n&a)+t[13]-40341101|0)<<12|i>>>20)+n|0)&n|~i&o)+t[14]-1502002290|0)<<17|a>>>15)+i|0)&i|~a&n)+t[15]+1236535329|0)<<22|o>>>10)+a|0,o=((o+=((a=((a+=((i=((i+=((n=((n+=(o&i|a&~i)+t[1]-165796510|0)<<5|n>>>27)+o|0)&a|o&~a)+t[6]-1069501632|0)<<9|i>>>23)+n|0)&o|n&~o)+t[11]+643717713|0)<<14|a>>>18)+i|0)&n|i&~n)+t[0]-373897302|0)<<20|o>>>12)+a|0,o=((o+=((a=((a+=((i=((i+=((n=((n+=(o&i|a&~i)+t[5]-701558691|0)<<5|n>>>27)+o|0)&a|o&~a)+t[10]+38016083|0)<<9|i>>>23)+n|0)&o|n&~o)+t[15]-660478335|0)<<14|a>>>18)+i|0)&n|i&~n)+t[4]-405537848|0)<<20|o>>>12)+a|0,o=((o+=((a=((a+=((i=((i+=((n=((n+=(o&i|a&~i)+t[9]+568446438|0)<<5|n>>>27)+o|0)&a|o&~a)+t[14]-1019803690|0)<<9|i>>>23)+n|0)&o|n&~o)+t[3]-187363961|0)<<14|a>>>18)+i|0)&n|i&~n)+t[8]+1163531501|0)<<20|o>>>12)+a|0,o=((o+=((a=((a+=((i=((i+=((n=((n+=(o&i|a&~i)+t[13]-1444681467|0)<<5|n>>>27)+o|0)&a|o&~a)+t[2]-51403784|0)<<9|i>>>23)+n|0)&o|n&~o)+t[7]+1735328473|0)<<14|a>>>18)+i|0)&n|i&~n)+t[12]-1926607734|0)<<20|o>>>12)+a|0,o=((o+=((a=((a+=((i=((i+=((n=((n+=(o^a^i)+t[5]-378558|0)<<4|n>>>28)+o|0)^o^a)+t[8]-2022574463|0)<<11|i>>>21)+n|0)^n^o)+t[11]+1839030562|0)<<16|a>>>16)+i|0)^i^n)+t[14]-35309556|0)<<23|o>>>9)+a|0,o=((o+=((a=((a+=((i=((i+=((n=((n+=(o^a^i)+t[1]-1530992060|0)<<4|n>>>28)+o|0)^o^a)+t[4]+1272893353|0)<<11|i>>>21)+n|0)^n^o)+t[7]-155497632|0)<<16|a>>>16)+i|0)^i^n)+t[10]-1094730640|0)<<23|o>>>9)+a|0,o=((o+=((a=((a+=((i=((i+=((n=((n+=(o^a^i)+t[13]+681279174|0)<<4|n>>>28)+o|0)^o^a)+t[0]-358537222|0)<<11|i>>>21)+n|0)^n^o)+t[3]-722521979|0)<<16|a>>>16)+i|0)^i^n)+t[6]+76029189|0)<<23|o>>>9)+a|0,o=((o+=((a=((a+=((i=((i+=((n=((n+=(o^a^i)+t[9]-640364487|0)<<4|n>>>28)+o|0)^o^a)+t[12]-421815835|0)<<11|i>>>21)+n|0)^n^o)+t[15]+530742520|0)<<16|a>>>16)+i|0)^i^n)+t[2]-995338651|0)<<23|o>>>9)+a|0,o=((o+=((i=((i+=(o^((n=((n+=(a^(o|~i))+t[0]-198630844|0)<<6|n>>>26)+o|0)|~a))+t[7]+1126891415|0)<<10|i>>>22)+n|0)^((a=((a+=(n^(i|~o))+t[14]-1416354905|0)<<15|a>>>17)+i|0)|~n))+t[5]-57434055|0)<<21|o>>>11)+a|0,o=((o+=((i=((i+=(o^((n=((n+=(a^(o|~i))+t[12]+1700485571|0)<<6|n>>>26)+o|0)|~a))+t[3]-1894986606|0)<<10|i>>>22)+n|0)^((a=((a+=(n^(i|~o))+t[10]-1051523|0)<<15|a>>>17)+i|0)|~n))+t[1]-2054922799|0)<<21|o>>>11)+a|0,o=((o+=((i=((i+=(o^((n=((n+=(a^(o|~i))+t[8]+1873313359|0)<<6|n>>>26)+o|0)|~a))+t[15]-30611744|0)<<10|i>>>22)+n|0)^((a=((a+=(n^(i|~o))+t[6]-1560198380|0)<<15|a>>>17)+i|0)|~n))+t[13]+1309151649|0)<<21|o>>>11)+a|0,o=((o+=((i=((i+=(o^((n=((n+=(a^(o|~i))+t[4]-145523070|0)<<6|n>>>26)+o|0)|~a))+t[11]-1120210379|0)<<10|i>>>22)+n|0)^((a=((a+=(n^(i|~o))+t[2]+718787259|0)<<15|a>>>17)+i|0)|~n))+t[9]-343485551|0)<<21|o>>>11)+a|0,e[0]=n+e[0]|0,e[1]=o+e[1]|0,e[2]=a+e[2]|0,e[3]=i+e[3]|0}function o(e){var t,n=[];for(t=0;t<64;t+=4)n[t>>2]=e.charCodeAt(t)+(e.charCodeAt(t+1)<<8)+(e.charCodeAt(t+2)<<16)+(e.charCodeAt(t+3)<<24);return n}function a(e){var t,n=[];for(t=0;t<64;t+=4)n[t>>2]=e[t]+(e[t+1]<<8)+(e[t+2]<<16)+(e[t+3]<<24);return n}function i(e){var t,a,i,r,s,c,l=e.length,d=[1732584193,-271733879,-1732584194,271733878];for(t=64;t<=l;t+=64)n(d,o(e.substring(t-64,t)));for(a=(e=e.substring(t-64)).length,i=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],t=0;t<a;t+=1)i[t>>2]|=e.charCodeAt(t)<<(t%4<<3);if(i[t>>2]|=128<<(t%4<<3),t>55)for(n(d,i),t=0;t<16;t+=1)i[t]=0;return r=(r=8*l).toString(16).match(/(.*?)(.{0,8})$/),s=parseInt(r[2],16),c=parseInt(r[1],16)||0,i[14]=s,i[15]=c,n(d,i),d}function r(e){var t,o,i,r,s,c,l=e.length,d=[1732584193,-271733879,-1732584194,271733878];for(t=64;t<=l;t+=64)n(d,a(e.subarray(t-64,t)));for(o=(e=t-64<l?e.subarray(t-64):new Uint8Array(0)).length,i=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],t=0;t<o;t+=1)i[t>>2]|=e[t]<<(t%4<<3);if(i[t>>2]|=128<<(t%4<<3),t>55)for(n(d,i),t=0;t<16;t+=1)i[t]=0;return r=(r=8*l).toString(16).match(/(.*?)(.{0,8})$/),s=parseInt(r[2],16),c=parseInt(r[1],16)||0,i[14]=s,i[15]=c,n(d,i),d}function s(e){var n,o="";for(n=0;n<4;n+=1)o+=t[e>>8*n+4&15]+t[e>>8*n&15];return o}function c(e){var t;for(t=0;t<e.length;t+=1)e[t]=s(e[t]);return e.join("")}function l(e){return/[\u0080-\uFFFF]/.test(e)&&(e=unescape(encodeURIComponent(e))),e}function d(e,t){var n,o=e.length,a=new ArrayBuffer(o),i=new Uint8Array(a);for(n=0;n<o;n+=1)i[n]=e.charCodeAt(n);return t?i:a}function u(e){return String.fromCharCode.apply(null,new Uint8Array(e))}function p(e,t,n){var o=new Uint8Array(e.byteLength+t.byteLength);return o.set(new Uint8Array(e)),o.set(new Uint8Array(t),e.byteLength),n?o:o.buffer}function m(e){var t,n=[],o=e.length;for(t=0;t<o-1;t+=2)n.push(parseInt(e.substr(t,2),16));return String.fromCharCode.apply(String,n)}function h(){this.reset()}return c(i("hello")),"undefined"==typeof ArrayBuffer||ArrayBuffer.prototype.slice||function(){function t(e,t){return(e=0|e||0)<0?Math.max(e+t,0):Math.min(e,t)}ArrayBuffer.prototype.slice=function(n,o){var a,i,r,s,c=this.byteLength,l=t(n,c),d=c;return o!==e&&(d=t(o,c)),l>d?new ArrayBuffer(0):(a=d-l,i=new ArrayBuffer(a),r=new Uint8Array(i),s=new Uint8Array(this,l,a),r.set(s),i)}}(),h.prototype.append=function(e){return this.appendBinary(l(e)),this},h.prototype.appendBinary=function(e){this._buff+=e,this._length+=e.length;var t,a=this._buff.length;for(t=64;t<=a;t+=64)n(this._hash,o(this._buff.substring(t-64,t)));return this._buff=this._buff.substring(t-64),this},h.prototype.end=function(e){var t,n,o=this._buff,a=o.length,i=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(t=0;t<a;t+=1)i[t>>2]|=o.charCodeAt(t)<<(t%4<<3);return this._finish(i,a),n=c(this._hash),e&&(n=m(n)),this.reset(),n},h.prototype.reset=function(){return this._buff="",this._length=0,this._hash=[1732584193,-271733879,-1732584194,271733878],this},h.prototype.getState=function(){return{buff:this._buff,length:this._length,hash:this._hash.slice()}},h.prototype.setState=function(e){return this._buff=e.buff,this._length=e.length,this._hash=e.hash,this},h.prototype.destroy=function(){delete this._hash,delete this._buff,delete this._length},h.prototype._finish=function(e,t){var o,a,i,r=t;if(e[r>>2]|=128<<(r%4<<3),r>55)for(n(this._hash,e),r=0;r<16;r+=1)e[r]=0;o=(o=8*this._length).toString(16).match(/(.*?)(.{0,8})$/),a=parseInt(o[2],16),i=parseInt(o[1],16)||0,e[14]=a,e[15]=i,n(this._hash,e)},h.hash=function(e,t){return h.hashBinary(l(e),t)},h.hashBinary=function(e,t){var n=c(i(e));return t?m(n):n},h.ArrayBuffer=function(){this.reset()},h.ArrayBuffer.prototype.append=function(e){var t,o=p(this._buff.buffer,e,!0),i=o.length;for(this._length+=e.byteLength,t=64;t<=i;t+=64)n(this._hash,a(o.subarray(t-64,t)));return this._buff=t-64<i?new Uint8Array(o.buffer.slice(t-64)):new Uint8Array(0),this},h.ArrayBuffer.prototype.end=function(e){var t,n,o=this._buff,a=o.length,i=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(t=0;t<a;t+=1)i[t>>2]|=o[t]<<(t%4<<3);return this._finish(i,a),n=c(this._hash),e&&(n=m(n)),this.reset(),n},h.ArrayBuffer.prototype.reset=function(){return this._buff=new Uint8Array(0),this._length=0,this._hash=[1732584193,-271733879,-1732584194,271733878],this},h.ArrayBuffer.prototype.getState=function(){var e=h.prototype.getState.call(this);return e.buff=u(e.buff),e},h.ArrayBuffer.prototype.setState=function(e){return e.buff=d(e.buff,!0),h.prototype.setState.call(this,e)},h.ArrayBuffer.prototype.destroy=h.prototype.destroy,h.ArrayBuffer.prototype._finish=h.prototype._finish,h.ArrayBuffer.hash=function(e,t){var n=c(r(new Uint8Array(e)));return t?m(n):n},h}()}},t={};function n(o){var a=t[o];if(void 0!==a)return a.exports;var i=t[o]={id:o,loaded:!1,exports:{}};return e[o](i,i.exports,n),i.loaded=!0,i.exports}n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},n.d=(e,t)=>{for(var o in t)n.o(t,o)&&!n.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:t[o]})},n.hmd=e=>((e=Object.create(e)).children||(e.children=[]),Object.defineProperty(e,"exports",{enumerable:!0,set:()=>{throw new Error("ES Modules may not assign module.exports or exports.*, Use ESM export syntax, instead: "+e.id)}}),e),n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{"use strict";function e(e){const t={mainMenu:{},_menuID:l.uniqueID("bc"),_events:d()};let n=!1;const o="main",a=l.duration.normalPace,i=l.duration.fastPace,r=l.duration.fastPace;let s;(e=$.extend(!0,{},e)).id=o;const c={userDict:{},focusCounter:{},idle:{},opening:{},explicit:{}};let u=!1,p=!1,m=!1,h=!1,f=!1,_=1e6,g=0,b=[];const w=function(){const e={};return e.start=function(e,t){const n=s.find('.menubar[data-menu-id="'.concat(e,'"]'));if(!n.length)return!1;let o=n.hasClass("horizontal");const a=n.children();if(!a.length)return!1;const i=()=>n.hasAttr("data-triggered"),r=e=>a.eq(e).hasClass("menubar__item")&&!a.eq(e).hasClass("disabled"),c=function(e){for(let t=(e+1)%a.length;t!==e;t=(t+1)%a.length)if(r(t))return a.eq(t).addClass("keyboard").siblings().removeClass("keyboard"),t;return e};let l=t?c(-1):-1,d=-1===l?$():a.eq(l);const u={menuId:e,isHorizontal:o,moveToPosition:e=>!(e<0||e>=a.length)&&(e!==l&&(d.trigger("mouseleave").removeClass("keyboard"),d=a.eq(e).addClass("keyboard"),i()&&d.trigger("mouseenter",[!0]),l=e,!0)),up:()=>o?!d.hasClass("more")||!i()||("hover"===d.attr("data-submenu-type")?d.trigger("mouseleave"):d.trigger("click"),k(0,d.attr("data-trigger"),!0),n.removeAttr("data-triggered"),!1):(u.moveToPosition(function(e){for(let t=(e-1+2*a.length)%a.length;t!==e;t=(t-1+2*a.length)%a.length)if(r(t))return a.eq(t).addClass("keyboard").siblings().removeClass("keyboard"),t;return e}(l)),!1),down:()=>o?!(d.hasClass("more")&&!i())||(d.trigger("hover"===d.attr("data-submenu-type")?"mouseenter":"click",[!0]),n.attr("data-triggered",!0),!1):(u.moveToPosition(c(l)),!1),left:()=>{o=!o;const e=u.up();return o=!o,e},right:()=>{o=!o;const e=u.down();return o=!o,e},enter:()=>(d.trigger("hover"===d.attr("data-submenu-type")?"mouseenter":"click",[!0]),!1),esc:()=>!d.hasClass("more")||!i()||(o?u.up():u.left())};return u},e}();let I=!0;function x(){u=p=!1,s.find("[data-triggered]").removeAttr("data-triggered"),s.find(".alt-keydown").removeClass("alt-keydown"),s.find(".alt").removeClass("alt"),s.find(".keyboard").removeClass("keyboard"),s.find(".hover").removeClass("hover"),D(0)}function C(e,n,o){if(c.opening[n]||c.explicit[n])return!1;const a=s.find('.menubar[data-menu-id="'.concat(n,'"]')),i=s.find('.menubar__item[data-trigger="'.concat(n,'"]'));if(!a.length)return!1;"string"===$.type(o)&&o.match(/^(b|t){1}(l|r){1}$/)?i.is(":visible")||(o={top:0,left:0}):o=$.extend({top:0,left:0},o),a.parent().finish().show().css({height:"auto",width:"auto"});const r=window.innerHeight,l=window.innerWidth,d=a[0].getBoundingClientRect().height+parseFloat(a.css("marginTop"))+parseFloat(a.css("marginBottom")),u=a[0].getBoundingClientRect().width+parseFloat(a.css("marginLeft"))+parseFloat(a.css("marginRight")),m="string"===$.type(o)&&o.match(/^(b|t){1}(l|r){1}$/)?i[0].getBoundingClientRect():null,h=m?"b"===o[0]?m.bottom:m.top-2:o.top,f=m?"l"===o[1]?m.left:m.right:o.left,g=Math.max(m?i.parent()[0].getBoundingClientRect().top+4:0,r-d),v=Math.max(0,l-u),y=Math.min(h,g),I=Math.min(f,v);a.parent().css({top:y,left:I,height:Math.min(d,r-y),width:Math.min(u,l-I),zIndex:_++}).hide();const x=parseInt(a.attr("data-menu-level"));return D(x+1),D(x,!1),a.parent().fadeIn(e),i.addClass("active"),c.focusCounter[n]=1,c.opening[n]=!0,b.push(w.start(n,p)),t._events.call("_show",t,n),!0}function k(e,n,o){if(!c.opening[n]||c.explicit[n])return!1;const a=s.find('.menubar[data-menu-id="'.concat(n,'"]')),i=s.find('.menubar__item[data-trigger="'.concat(n,'"]'));return a.removeAttr("data-triggered").parent().finish().fadeOut(e),a.children().removeClass("hover active keyboard").removeAttr("data-mouse-entered"),i.removeClass("active"),o&&i.parent().children().removeAttr("data-clicked"),delete c.focusCounter[n],delete c.opening[n],b=b.filter((e=>e.menuId!==n)),t._events.call("_hide",t,n),!0}function D(e,t){!1!==t&&(t=!0);let n=!1;for(const o in c.opening)parseInt(s.find('.menubar[data-menu-id="'.concat(o,'"]')).attr("data-menu-level"))>=e&&(n|=k(0,o,t));return n}function P(e,t){const n={};let o;return o=t&&t instanceof jQuery?t.filter('.menubar__item[data-trigger="'.concat(v(e),'"]')):$(),o.length||(o=s.find('.menubar__item[data-trigger="'.concat(v(e),'"]'))),Object.defineProperty(n,"$",{get:()=>o}),Object.defineProperty(n,"name",{get:()=>o.find(".menubar__item__name").html(),set:e=>{o.hasAttr("data-altkey")||o.find(".menubar__item__name").html(e)}}),n.enable=()=>(o.removeClass("disabled"),n),n.disable=()=>(o.trigger("mouseleave").addClass("disabled"),n),n.isDisabled=()=>o.hasClass("disabled"),n.show=()=>(o.show(),n),n.hide=()=>(o.trigger("mouseleave").hide(),n),n.isHidden=()=>o.is(":visible"),n.tick=()=>(o.addClass("checked"),n),n.untick=()=>(o.removeClass("checked"),n),n.isTicked=()=>o.hasClass("checked"),n}return function e(){const t=[];for(const e in c.focusCounter)t.push({menuId:e,level:parseInt(s.find('.menubar[data-menu-id="'.concat(e,'"]')).attr("data-menu-level"))});t.sort(((e,t)=>e.level>=t.level?-1:1));for(let e=0;e<t.length;++e){const n=t[e].menuId,o=s.find('.menubar[data-menu-id="'.concat(n,'"]'));if(c.focusCounter[n]||o.hasAttr("data-clicked"))break;{const e=c.idle[n];setTimeout((()=>{c.idle[n]===e&&k(a,n)}),r),delete c.focusCounter[n]}}I&&setTimeout(e,50)}(),t.init=function(o){if(n)return t;const r=$('<div class="'.concat(t._menuID,'"></div>')).appendTo(o),d={};s=$();return function e(n,o){if("object"!==$.type(n))return;o=parseInt(o)||0,n=$.extend(!0,{align:"vertical",menus:[]},n);const a=(e,t)=>(e&&"string"===$.type(e)&&(e=e.replace(/\W/g,"")).length||(e=t?l.uniqueID("mb"):""),e);if(n.id=a(n.id,!0),0===o){if("main"!==n.id)throw new Error("Menubar: first-level menu bar should always have id of `main`");m=!1===n.altMode,h=!1===n.keyboardMode,f=!0===n.keyboardModeOnFirstMenu}let i='<div class="menubar-wrapper'.concat(o?"":" level0",'" style="display: none;"><div class="menubar ').concat("horizontal"===n.align?n.align:"vertical",'" data-menu-id="').concat(n.id,'" data-menu-level="').concat(o,'">');const u={};n.menus.forEach((function(n){if("object"===$.type(n))if($.isEmptyObject(n))i+='<div class="menubar__divider">'.concat("<div>null</div>".repeat(4),'</div><div class="menubar__divider spacing">').concat("<div>null</div>".repeat(4),"</div>");else{const r=a(n.id,!1);if(d[r])throw new Error("Menubar: Duplicate id");d[r]=!0;let c=(n=$.extend(!0,{type:"hover",name:"",key:"",alt:0,disabled:!1,hidden:!1,ticked:!1},n)).name,l="";if(!1!==n.alt){const e=y(n.name);if(n.alt=parseInt(n.alt),n.alt<0||n.alt>=e.length)throw new Error("Menubar: Invalid alt shortcut key");if(l=e.charAt(n.alt).toUpperCase(),l<"A"||l>"Z")throw new Error("Menubar: Alt shortcut key must be a letter");if(u[l])throw new Error("Menubar: Duplicate alt shortcut key (case-insensitive) within one menu");u[l]=!0,c="";for(let t=0;t<e.length;++t)c+=t!==n.alt?e[t]:'<span class="key">'.concat(e[t],"</span>")}i+='<div class="menubar__item'.concat(n.disabled?" disabled":"").concat(n.ticked?" checked":"").concat(n.menus&&"array"===$.type(n.menus)&&n.menus.length?' more" data-trigger="'.concat(v(e(n,o+1)),'" data-submenu-type="').concat(y(n.type),'"'):'" data-trigger="'.concat(r,'"')).concat(l?' data-altkey="'.concat(l,'"'):"").concat(n.hidden?' style="display: none;"':"",'>\n <div class="menubar__item__icon"></div>\n <div class="menubar__item__name">').concat(c,'</div>\n <div class="menubar__item__key">').concat(y(n.key),'</div>\n <div class="menubar__item__more"></div>\n </div>'),r&&hotkeys(n.key,{element:s[0],keyup:!1},(function(e){const n=P(r);if(n.isDisabled())return;e.preventDefault(),x();let o=!0;t._events.call(r,t,{dontCloseAllMenus:()=>{o=!1},menuItem:n}),o&&x()}))}})),i+="</div></div>";const p=$(i);return s=s.add(p.appendTo(r)),n.id&&(Object.prototype.hasOwnProperty.call(c.userDict,n.id)||(c.userDict[n.id]=[]),c.userDict[n.id].push(p)),n.id}(e),s.find(".menubar__item").on("mouseenter",(function(e,t){e.stopPropagation(),t||s.find(".menubar").removeClass("keyboard");const n=$(this),o=n.attr("data-trigger"),r=n.attr("data-submenu-type"),l=n.parent(),d=l.attr("data-menu-id");if(!n.hasClass("disabled")&&!n.hasAttr("data-mouse-entered")){if(n.attr("data-mouse-entered",!0).addClass("hover"),!t)for(let e=b.length-1;e>=0;--e)if(b[e].menuId===d){b[e].moveToPosition(n.parent().children().index(n));break}if(++g,Object.prototype.hasOwnProperty.call(c.focusCounter,d)||(c.focusCounter[d]=0),++c.focusCounter[d],Object.prototype.hasOwnProperty.call(c.idle,d)||(c.idle[d]=0),++c.idle[d],function(e){for(const t in c.opening)parseInt(s.find('.menubar[data-menu-id="'.concat(t,'"]')).attr("data-menu-level"))>=e&&(c.focusCounter[t]=0)}(parseInt(l.attr("data-menu-level"))+1),"hover"===r||"click"===r&&n.hasAttr("data-clicked")){const e=function(){l.attr("data-triggered",!0),Object.prototype.hasOwnProperty.call(c.focusCounter,o)||(c.focusCounter[o]=0),++c.focusCounter[o],Object.prototype.hasOwnProperty.call(c.idle,o)||(c.idle[o]=0),++c.idle[o],C(a,o,[null,"bl","tr",null][l.hasClass("horizontal")+2*l.hasClass("vertical")])};if("hover"!==r)e();else{const t=g;setTimeout((()=>{g===t&&e()}),i)}}}})).on("mouseleave",(function(e){e.stopPropagation();const t=$(this),n=t.attr("data-trigger"),o=t.attr("data-submenu-type"),a=t.parent(),i=a.attr("data-menu-id");!t.hasClass("disabled")&&t.hasAttr("data-mouse-entered")&&(t.removeAttr("data-mouse-entered").removeClass("hover"),"hover"===o&&(a.removeAttr("data-triggered"),c.focusCounter[i]&&--c.focusCounter[i],c.focusCounter[n]&&--c.focusCounter[n]))})).on("click",(function(){const e=$(this),n=e.attr("data-trigger"),o=e.attr("data-submenu-type"),i=e.parent();if(e.hasClass("disabled"))return;let r=!e.hasClass("more");if(t._events.call(n,t,{dontCloseAllMenus:()=>{r=!1},menuItem:P(n,e)}),r&&x(),"click"===o)if(e.hasAttr("data-clicked")){i.removeAttr("data-triggered"),e.parent().children().removeAttr("data-clicked");const t=parseInt(s.find('.menubar[data-menu-id="'.concat(n,'"]')).attr("data-menu-level"));D(t+1),D(t,!1)}else i.attr("data-triggered",!0),e.parent().children().attr("data-clicked",!0),C(a,n,[null,"bl","tr",null][i.hasClass("horizontal")+2*i.hasClass("vertical")])})),m||$(window).on("keydown.".concat(t._menuID),(function(e){if(!e.originalEvent.repeat){if(18===e.which)return D(0)||u?void x():(e.preventDefault(),u=p=!0,b=[w.start("main",p)],void s.find(".menubar").addClass("alt keyboard alt-keydown"));if(u&&e.which>=65&&e.which<=90){const t=$(e.target).prop("tagName");if("input"===t||"textarea"===t||"select"===t)return;if(b.length>0){const t=s.find('.menubar[data-menu-id="'.concat(b[b.length-1].menuId,'"]')).find('.menubar__item[data-altkey="'.concat(String.fromCharCode(e.which),'"]'));t.length&&(b[b.length-1].moveToPosition(t.parent().children().index(t)),b[b.length-1].enter(),e.preventDefault(),e.cancelBubble=!0,e.stopPropagation&&e.stopPropagation())}}}})).on("keyup.".concat(t._menuID),(function(){s.find(".menubar").removeClass("alt-keydown")})),h||hotkeys("up,down,left,right,enter,esc",{element:s[0],keyup:!1},(function(e,t){if(!f&&!p){if(!(b.length>1))return;p=!0}s.find(".menubar").addClass("keyboard"),e.preventDefault(),e.cancelBubble=!0,e.stopPropagation&&e.stopPropagation();const n=function(e){for(let t=b.length-1;t>=0&&e(t);--t);};switch(t.key){case"up":n((e=>b[e].up()));break;case"down":n((e=>b[e].down()));break;case"left":n((e=>b[e].left()));break;case"right":n((e=>b[e].right()));break;case"enter":n((e=>b[e].enter()));break;case"esc":b.length>1?n((e=>b[e].esc())):x()}})),$(window).on("mousedown.".concat(t._menuID," blur.").concat(t._menuID," resize.").concat(t._menuID),(function(e){$(e.target).closest(s).length||x()})),n=!0,t},t.getMenuItemsById=function(e){return P(n?e:null)},Object.defineProperty(t.mainMenu,"$",{get:()=>s.find('.menubar[data-menu-id="'.concat(o,'"]'))}),t.mainMenu.show=function(e,t){if(!n)return!1;const a=Math.min(1,(c.explicit.main||0)+1);delete c.explicit.main;const i=C(0,o,e);return t&&(c.explicit.main=a),i},t.mainMenu.hide=function(){if(!n)return!1;const e=Math.max(-1,(c.explicit.main||0)-1);delete c.explicit.main;const t=k(0,o,!0);return c.explicit.main=e,t},t.destroy=function(){n&&(I=!1,s.remove(),$(window).off(".".concat(t._menuID)),l.destroyObj(t))},t}var t=n(129),o=n(279),a=n.n(o);function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}jQuery.fn.updateTitle=function(e){$(this).attr("title",e),$(document).tooltip(l.tooltipConfiguration)},jQuery.fn.hasAttr=function(e){const t=$(this).attr(e);return void 0!==t&&!1!==t},jQuery.fn.toggleAttr=function(e){return this.each((function(){const t=$(this);t.attr(e)?t.removeAttr(e):t.attr(e,e)}))};const r=(e,t)=>"".concat(e).split(" ").filter((e=>!!e)).map((e=>"".concat(e).concat(t))).join(" ");jQuery.fn.bindIframeFixEvents=function(e){return this.on(r(e,"start"),(()=>{$(document.body).addClass("iframe-fix")})).on(r(e,"stop"),(()=>{$(document.body).removeClass("iframe-fix")}))},jQuery.fn.unbindIframeFixEvents=function(e){return this.off("".concat(r(e,"start")," ").concat(r(e,"stop")))},window.getDimensions||(window.getDimensions=function(){const e=document,t=window,n=e.compatMode&&"CSS1Compat"===e.compatMode?e.documentElement:e.body;let o=n.clientWidth,a=n.clientHeight;return t.innerWidth&&o>t.innerWidth&&(o=t.innerWidth,a=t.innerHeight),{width:o,height:a}});const s=function(){const e={},t={get:function(t){let n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(Object.prototype.hasOwnProperty.call(e,t))return n?$.extend(!0,{},e[t]):e[t]},set:function(n,o){let a=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return e[n]=a?$.extend(!0,{},o):o,t},pop:function(e){const n=t.get(e);return t.remove(e),n},remove:function(n){return delete e[n],t},keys:function(t){const n=[],o=new RegExp(t);for(const t in e)o.test(t)&&n.push(t);return n}};return t}();function c(){let e={};const t={};function n(t,n,a){var i,r,s;const c=$(t);n="string"===$.type(n)&&n||"";c.parent().css("position","relative"),c.attrchange({trackValues:!0,callback:function(e){l.pausePositioning||"style"===e.attributeName&&o(c,n)}}),l.pausePositioning||(Object.prototype.hasOwnProperty.call(e,n)||(e[n]={top:0,left:0,zIndex:c.css("z-index")||""}),c.css({position:"absolute",top:null!==(i=a.top)&&void 0!==i?i:e[n].top,left:null!==(r=a.left)&&void 0!==r?r:e[n].left,zIndex:null!==(s=a.zIndex)&&void 0!==s?s:e[n].zIndex}).css({top:"+=".concat(null==a.top?"1em":0),left:"+=".concat(null==a.left?"1em":0)}),o(c,n),$(":animated").promise().done((function(){const e=c.parent(),t=[e.actual("height"),e.actual("width")];c.position().top+c.actual("height")>t[0]&&c.css("top",0),c.position().left+c.actual("width")>t[1]&&c.css("left",0),o(c,n)})))}function o(t,n){Object.prototype.hasOwnProperty.call(e,n)||(e[n]={}),e[n].top=t.css("top")||0,e[n].left=t.css("left")||0,e[n].zIndex=t.css("z-index")||""}return t.clear=function(){return e={},t},t.watch=function(e,o){let a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};a=$.extend({},a);const i={};return i.top=l.parseFloatSafe(a.top,null),i.left=l.parseFloatSafe(a.left,null),i.zIndex=l.parseIntSafe(a.zIndex,null),n(e,o,a),t},t.impose=function(e,n){return o($(e),n="string"===$.type(n)&&n||""),t},t.fixPosition=function(n,o){let{top:a,left:i,zIndex:r}=n;return e[o]={top:parseFloat(a)||0,left:parseFloat(i)||0,zIndex:parseInt(r)||0},t},t.savedPositions=function(){const t={};for(const n in e)t[n]={top:e[n].top,left:e[n].left,zIndex:e[n].zIndex};return t},t}class l{static parseFloatSafe(e,t){const n=parseFloat(e);return isNaN(n)?t:n}static parseIntSafe(e,t){const n=parseInt(e);return isNaN(n)?t:n}static getMode(){return new URLSearchParams(document.location.search).get("mode")||"prod"}}function d(){const e={eventObj:{}};function t(t,n,o){"string"==typeof t&&n&&{}.toString.call(n).match(/\[object [a-zA-Z]*Function\]/)&&(Object.prototype.hasOwnProperty.call(e.eventObj,t)||(e.eventObj[t]=[]),e.eventObj[t].push({fn:n,one:o}))}return e.on=function(n,o){return t(n,o,!1),e},e.one=function(n,o){return t(n,o,!0),e},e.call=function(t,n){for(var o=arguments.length,a=new Array(o>2?o-2:0),i=2;i<o;i++)a[i-2]=arguments[i];const r=[];return"string"==typeof t&&Object.prototype.hasOwnProperty.call(e.eventObj,t)&&(e.eventObj[t].forEach((function(e){r.push(e.fn.apply(n,a))})),e.eventObj[t].filter((e=>!e.one))),r},e.invoke=function(t,n){for(var o=arguments.length,a=new Array(o>2?o-2:0),i=2;i<o;i++)a[i-2]=arguments[i];const r=[];return"string"==typeof t&&Object.prototype.hasOwnProperty.call(e.eventObj,t)&&(e.eventObj[t].forEach((function(e){r.push(Promise.resolve(new Promise((function(t){t(e.fn.apply(n,a))}))))})),e.eventObj[t].filter((e=>!e.one))),Promise.all(r)},e.merge=function(t){for(const[n,o]of Object.entries(t.eventObj))o.forEach((function(t){t.one?e.one(n,t.fn):e.on(n,t.fn)}));return e},e.off=function(t,n){return Object.prototype.hasOwnProperty.call(e.eventObj,t)&&(n&&{}.toString.call(n).match(/\[object [a-zA-Z]*Function\]/)&&(e.eventObj[t]=e.eventObj[t].filter((e=>e.fn!==n)),e.eventObj[t].length||delete e.eventObj[t]),null==n&&delete e.eventObj[t]),e},e.clear=function(){for(const t in e.eventObj)e.off(t);return e},e}function u(e){const t="320897b91638aedd31e0f1963228ef9b938359e9",n="SIGNED. Please do not edit this file!",o={};if("object"!==$.type(e))throw new Error("Signature error: Invalid object.");return o.encrypt=function(i){const r=$.extend(!0,{},!0===i?o.utils.compress():e);r.__SECRET_KEY__=t;let s="";try{s=a().hash(JSON.stringify(r))}catch(e){}return delete r.__SECRET_KEY__,r[n]=s,r},o.decrypt=function(i){const r=$.extend(!0,{},e);if(!Object.prototype.hasOwnProperty.call(r,n))throw new Error("Signature error: Unknown signature.");const s=r[n];delete r[n],r.__SECRET_KEY__=t;let c="";try{c=a().hash(JSON.stringify(r))}catch(e){}if(c!==s)throw new Error("Signature error: Invalid signature.");return delete r.__SECRET_KEY__,!0===i?o.utils.decompress(r):r},o.utils={},o.utils.compress=function(t){const n=t||e,o={};let a=0;const i=function(e){switch($.type(e)){case"object":for(const t in e)Object.prototype.hasOwnProperty.call(o,t)||(o[t]=a++),i(e[t]);break;case"array":e.forEach((e=>i(e)))}};i(n);const r=function(e){let t;switch($.type(e)){case"object":t={};for(const n in e)t[""+o[n]]=r(e[n]);return t;case"array":return t=[],e.forEach((e=>t.push(r(e)))),t}return e};return{_:function(){const e=[];for(const t in o)e.push(t);return e.sort(((e,t)=>o[e]<o[t]?-1:1)).join(",")}(),o:r(n)}},o.utils.decompress=function(t){const n=t||e;if(!Object.prototype.hasOwnProperty.call(n,"_")||!Object.prototype.hasOwnProperty.call(n,"o")||"string"!==$.type(n._))return n;const o={};n._.split(",").forEach(((e,t)=>o[""+t]=e));const a=function(e){let t;switch($.type(e)){case"object":t={};for(const n in e)t[o[n]]=a(e[n]);return t;case"array":return t=[],e.forEach((e=>t.push(a(e)))),t}return e};return a(n.o)},o}function p(){const e={_events:d()},t=[],n=[];let o=!1;function a(o){if(o?n.length:t.length){const a=o?n.pop():t.pop();let i;"function"===$.type(a.caller)?i=!a.caller():(i=!0,$(a.caller).each((function(e,t){i&=!$.contains(document.documentElement,t)})));const r=[];if(a.reservedIDs.forEach((function(e){r.push({prefix:e.prefix,value:s.get("DashboardGlobals.uniqueID:".concat(e.prefix))||0}),s.set("DashboardGlobals.uniqueID:".concat(e.prefix),e.value-1)})),!i)try{o?a.redo():a.undo()}catch(e){i=!0}r.forEach((e=>s.set("DashboardGlobals.uniqueID:".concat(e.prefix),e.value))),i?o?e.redo():e.undo():(o?t.push(a):n.push(a),"dev"===l.getMode()&&$.toast($.extend({},l.toastConfiguration,{heading:o?"Redone":"Undone",text:a.type})),e._events.call(o?"redo":"undo",e,a))}}return e.do=function(a){if(o)return e;n.length=0,a=$.extend(!0,{type:"",reservedIDs:[],caller:"",undo:function(){},redo:function(){}},a);const i=[];return a.reservedIDs.forEach((function(e){i.push({prefix:e,value:s.get("DashboardGlobals.uniqueID:".concat(e))||1})})),a.reservedIDs=i,t.push(a),e},e.undo=function(){return a(),e},e.redo=function(){return a(!0),e},e.clear=function(){return t.length=0,n.length=0,e},e.pause=function(){o=!0},e.resume=function(){o=!1},e.isPaused=function(){return o},e.runWhenPaused=function(t){e.pause();const n=t.call(e);return n instanceof Promise?n.then((t=>(e.resume(),t))):(e.resume(),n)},e}i(l,"opacity",.8),i(l,"duration",{immediate:10,fastPace:100,normalPace:400,userInteractionWait:600}),i(l,"tooltipConfiguration",{classes:{"ui-tooltip":"ui-widget-shadow ui-widget ui-widget-content"},hide:{effect:"fade",duration:l.duration.fastPace},show:{effect:"fade",duration:l.duration.fastPace,delay:l.duration.userInteractionWait},position:{my:"center bottom",at:"center top",collision:"flipfit"},close:function(){$(".ui-helper-hidden-accessible").remove()}}),i(l,"uniqueID",(function(e){const t=s.get("DashboardGlobals.uniqueID:".concat(e))||0;return s.set("DashboardGlobals.uniqueID:".concat(e),t+1),"".concat(e).concat(t+1)})),i(l,"getQueryID",(function(e){const t=$(e);if(t.length){const e=l.uniqueID("qi");return t.addClass(e),e}return null})),i(l,"pausePositioning",!1),i(l,"alertConfiguration",{animation:"zoom",closeAnimation:"zoom",animateFromElement:!1,icon:"fas fa-exclamation-triangle",closeIcon:!0,type:"red",useBootstrap:!1,boxWidth:"75%"}),i(l,"confirmConfiguration",{animation:"zoom",closeAnimation:"zoom",animateFromElement:!1,icon:"fas fa-exclamation-triangle",closeIcon:"cancel",title:"Confirmation",type:"red",buttons:{cancel:()=>{}},useBootstrap:!1,boxWidth:"75%"}),i(l,"toastConfiguration",{stack:1,position:"bottom-right",hideAfter:3e3,allowToastClose:!0,loader:!1,showHideTransition:"slide",bgColor:"#000080",textColor:"#eee"}),i(l,"fixDuplicateNames",function(){const e={};let t=!1;return e.freeze=function(){t=!0},e.unfreeze=function(){t=!1},e.run=function(e,n){if(e=e.trim(),t)return e;const o=e.split("#");let a=1;o.length>1&&!isNaN(o[o.length-1])&&(a=Math.max(1,o.pop()),e=o.join("#").trim());for(var i=a,r=i>1?" #".concat(i):"";s.get("".concat(n,":").concat(e).concat(r));r=" #".concat(++i));return e+=r},e}()),i(l,"compressObj",(e=>JSON.stringify(u(e).encrypt(!0)))),i(l,"decompressObj",(e=>{try{return u(JSON.parse(e)).decrypt(!0)}catch(e){return{}}})),i(l,"destroyObj",(e=>{for(const[t,n]of Object.entries(e))n instanceof Object&&l.destroyObj(n),delete e[t]})),i(l,"menubarButtonsZIndex",99999998),i(l,"baseURL","http://localhost"),i(l,"launchInputBox",((e,t,n,o)=>{$.confirm({animation:"zoom",closeAnimation:"zoom",animateFromElement:!1,title:e,content:'<div class="g-row">\n <form action="" class="inputbox">\n <input type="text" value="'.concat(v(t),'" required />\n <label>').concat(y(n),'</label>\n <div class="line line-center"></div>\n </form>\n </div>'),buttons:{formSubmit:{text:"OK",action:function(){o(this.$content.find("input").val())}},cancel:{}},onContentReady:function(){const e=this;e.$content.find("form").on("submit",(function(t){t.preventDefault(),e.$$formSubmit.trigger("click")})),e.$content.find("input").focus()},boxWidth:"75%",useBootstrap:!1,escapeKey:"cancel"})})),i(l,"spectrumConfiguration",{type:"color",showPalette:!1,togglePaletteOnly:!0,showInput:!0,showButtons:!1,showAlpha:!1,allowEmpty:!1,preferredFormat:"hex",showInitial:!0});const m=function e(){let n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"temp";const o={clear:async function(){return await t.Z.events.SetStorage.invoke(n,JSON.stringify({})),o},getItem:async function(e){return await t.Z.events.GetField.invoke(n,e)},setItem:async function(e,a){return await t.Z.events.SetField.invoke(n,e,a),o},removeItem:async function(e){return await t.Z.events.SetField.invoke(n,e),o},getFull:async function(){return await t.Z.events.GetStorage.invoke(n)},setFull:async function(e){return await t.Z.events.SetStorage.invoke(n,e),o},getStorageOfField:function(t){return e(t)}};return o}();function h(e){if("string"!==$.type(e))return null;const t="DashboardVersion::".concat(e),n={};let o=!1;return n.maximumDepth=function(){return 1},n.initialized=function(){return o},n.destroy=async function(){o&&(await m.setItem(t,[]),l.destroyObj(n))},n.init=async function(e){const a=await m.getItem(t)||[];return a.length&&"function"===$.type(e)&&!1===e(a[a.length-1].content)&&m.setItem(t,[]),o=!0,n},n.commit=async function(e){if(!o||"string"!==$.type(e))return!1;const n=await m.getItem(t)||[];if(n.length&&n[n.length-1].content===e)return!1;for(n.push({time:((new Date).getTime()/1e3).toFixed(0),content:e});n.length>1;)n.shift();return await m.setItem(t,n),!0},n.rollback=async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;if(!o)return n;const a=await m.getItem(t)||[];for(;e>0&&a.length;)a.pop(),--e;return await m.setItem(t,a),n},n.viewCommit=async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!o)return null;const a=await m.getItem(t)||[];if(n){const t=[];for(let n=a.length-1;n>=0&&e>0;--n,--e)t.push(a[n]);return t}return e>a.length?null:a[a.length-Math.max(1,e)]},n}const f=e({align:"horizontal",id:"main",menus:[..."darwin"===window.platform.get()?[{name:'<div class="trafficlight maximize">\n <div class="trafficlight-close">\n <svg x="0px" y="0px" viewBox="0 0 6.4 6.4">\n <polygon fill="#4d0000" points="6.4,0.8 5.6,0 3.2,2.4 0.8,0 0,0.8 2.4,3.2 0,5.6 0.8,6.4 3.2,4 5.6,6.4 6.4,5.6 4,3.2"></polygon>\n </svg>\n </div>\n <div class="trafficlight-minimize">\n <svg x="0px" y="0px" viewBox="0 0 8 1.1">\n <rect fill="#995700" width="8" height="1.1"></rect>\n </svg>\n </div>\n <div class="trafficlight-fullscreen">\n <svg class="fullscreen-svg" x="0px" y="0px" viewBox="0 0 6 5.9">\n <path fill="#006400" d="M5.4,0h-4L6,4.5V0.6C5.7,0.6,5.3,0.3,5.4,0z"></path>\n <path fill="#006400" d="M0.6,5.9h4L0,1.4l0,3.9C0.3,5.3,0.6,5.6,0.6,5.9z"></path>\n </svg>\n <svg class="maximize-svg" x="0px" y="0px" viewBox="0 0 7.9 7.9">\n <polygon fill="#006400" points="7.9,4.5 7.9,3.4 4.5,3.4 4.5,0 3.4,0 3.4,3.4 0,3.4 0,4.5 3.4,4.5 3.4,7.9 4.5,7.9 4.5,4.5"></polygon>\n </svg>\n </div>\n </div>',id:"trafficlights",disabled:!0,alt:!1}]:[{name:'<img class="menubar-logo" src="icon.png" />',id:"logo",disabled:!0,alt:!1}],{name:"Untitled",type:"click",id:"file",alt:!1,menus:[{name:"New Project",key:"Ctrl+N",id:"newproject",alt:4},{name:"Open Project...",key:"Ctrl+O",id:"openproject",alt:8},{},{name:"Save Project",key:"Ctrl+S",id:"saveproject"},{name:"Save Project As...",key:"Ctrl+Shift+S",id:"saveprojectas",disabled:!0,alt:11},{},{name:"Exit",key:"Alt+F4",id:"exit",alt:1}]},{},{name:"Edit",type:"click",id:"edit",menus:[{name:"Undo",key:"Ctrl+Z",id:"undo"},{name:"Redo",key:"Ctrl+Y, Ctrl+Shift+Z",id:"redo"}]},{name:"Session",type:"click",id:"session",menus:[{name:"Auto Save Every 5 Minutes",id:"autosave",alt:1},{},{name:"New Session",key:"Ctrl+M",id:"newsession"},{name:"Open Session...",key:"Ctrl+Shift+O",id:"opensession"},{name:"Import Session...",key:"Ctrl+Shift+I",id:"importsession"},{},{name:"Save Session As...",key:"Ctrl+Shift+Alt+S",id:"savesessionas",alt:13},{},{name:"Absolute API Permission Check",id:"absoluteapicheck",ticked:!0,alt:13},{name:"Port API Warning",id:"portapiwarning",ticked:!0,alt:9},{name:"Strict Mode",id:"strict",ticked:!0}]},{name:"View",type:"click",id:"view",menus:[{name:"Layout",id:"layout",type:"hover",menus:[{name:"Browser",id:"browser"},{name:"Components",id:"components",ticked:!0}]}]}]}).init(document.body),_=e({align:"horizontal",id:"main",menus:[{name:'<svg width="12" height="12" viewBox="0 0 12 12" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M11 4.399V5.5H0V4.399h11z" fill="#000"/></svg>',id:"minimize",alt:!1},{name:'<svg width="12" height="12" viewBox="0 0 12 12" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M11 0v11H0V0h11zM9.899 1.101H1.1V9.9h8.8V1.1z" fill="#000"/></svg>',id:"maximize",alt:!1},{name:'<svg width="12" height="12" viewBox="0 0 12 12" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M11 8.798H8.798V11H0V2.202h2.202V0H11v8.798zm-3.298-5.5h-6.6v6.6h6.6v-6.6zM9.9 1.1H3.298v1.101h5.5v5.5h1.1v-6.6z" fill="#000"/></svg>',id:"unmaximize",alt:!1,hidden:!0},{name:'<svg width="12" height="12" viewBox="0 0 12 12" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M6.279 5.5L11 10.221l-.779.779L5.5 6.279.779 11 0 10.221 4.721 5.5 0 .779.779 0 5.5 4.721 10.221 0 11 .779 6.279 5.5z" fill="#000"/></svg>',id:"close",alt:!1}],altMode:!1,keyboardMode:!1}).init(document.body);function g(e){$.confirm($.extend({},l.confirmConfiguration,{content:"This will delete all unsaved changes. Are you sure?",buttons:{confirm:e,cancel:()=>{}}}))}function v(e){return e.replace('"','\\"')}function y(e){return $("<div>").text(e).html()}function b(e,t){return Math.abs(parseFloat(e)-parseFloat(t))<=.001}function w(){const e=this[A],t=e.target;let n,o,a;for(t.reverse(),n=0,o=t.length;n<o;n++)if((a=t[n])&&"object"==typeof a){const e=a[A];e&&(e.ownKey=n)}var i=[new L(O,[],void 0,void 0,this)];return H(e,i),this}function I(e){const t=this[A],n=t.target;let o,a,i;for(n.sort(e),o=0,a=n.length;o<a;o++)if((i=n[o])&&"object"==typeof i){const e=i[A];e&&(e.ownKey=o)}return e=[new L(S,[],void 0,void 0,this)],H(t,e),this}function x(e,t,n){const o=this[A],a=o.target,i=[],r=a.length,s=a.slice(0);if(t=void 0===t?0:t<0?Math.max(r+t,0):Math.min(t,r),n=void 0===n?r:n<0?Math.max(r+n,0):Math.min(n,r),t<r&&t<n){let r;a.fill(e,t,n);for(let e,c,l=t;l<n;l++)e=a[l],a[l]=B(e,l,o),l in s?(c=s[l],c&&"object"==typeof c&&(r=c[A],r&&(c=r.detach())),i.push(new L(D,[l],a[l],c,this))):i.push(new L(k,[l],a[l],void 0,this));H(o,i)}return this}function C(e,t,n){const o=this[A],a=o.target,i=a.length;e=e<0?Math.max(i+e,0):e,t=void 0===t?0:t<0?Math.max(i+t,0):Math.min(t,i),n=void 0===n?i:n<0?Math.max(i+n,0):Math.min(n,i);var r=Math.min(n-t,i-e);if(e<i&&e!==t&&0<r){const i=a.slice(0),s=[];a.copyWithin(e,t,n);for(let t,n,c,l=e;l<e+r;l++)t=a[l],t&&"object"==typeof t&&(t=B(t,l,o),a[l]=t),n=i[l],n&&"object"==typeof n&&(c=n[A],c&&(n=c.detach())),"object"!=typeof t&&t===n||s.push(new L(D,[l],t,n,this));H(o,s)}return this}const k="insert",D="update",P="delete",O="reverse",S="shuffle",A=Symbol.for("object-observer-meta-key-0"),M={async:1},z={observe:{value:function(e,t){if("function"!=typeof e)throw new Error("observer MUST be a function, got '".concat(e,"'"));const n=this[A].observers;n.some((t=>t[0]===e))?console.warn("observer may be bound to an observable only once; will NOT rebind"):n.push([e,(e=>{if(!e||"object"!=typeof e)return null;const t={},n=[];for(var[o,a]of Object.entries(e))if("path"===o){if("string"!=typeof a||""===a)throw new Error('"path" option, if/when provided, MUST be a non-empty string');t[o]=a}else if("pathsOf"===o){if(e.path)throw new Error('"pathsOf" option MAY NOT be specified together with "path" option');if("string"!=typeof a)throw new Error('"pathsOf" option, if/when provided, MUST be a string (MAY be empty)');t[o]=e.pathsOf.split(".").filter(Boolean)}else if("pathsFrom"===o){if(e.path||e.pathsOf)throw new Error('"pathsFrom" option MAY NOT be specified together with "path"/"pathsOf" option/s');if("string"!=typeof a||""===a)throw new Error('"pathsFrom" option, if/when provided, MUST be a non-empty string');t[o]=a}else n.push(o);if(n.length)throw new Error("'".concat(n.join(", "),"' is/are not a valid observer option/s"));return t})(t)])}},unobserve:{value:function(){const e=this[A].observers;let t=e.length;if(t){let n=arguments.length;if(n)for(;n--;){let o=t;for(;o--;)e[o][0]===arguments[n]&&(e.splice(o,1),t--)}else e.splice(0)}}}},E=(e,t)=>{const n=Object.defineProperties({},z);n[A]=t;for(const o in e)n[o]=B(e[o],o,t);return n},j=(e,t)=>{var n=e.length;const o=Object.defineProperties(new Array(n),z);o[A]=t;for(let a=0;a<n;a++)o[a]=B(e[a],a,t);return o},T=(e,t)=>(Object.defineProperties(e,z),e[A]=t,e),q=(e,t)=>{if(!e)return t;let n=t;if(e.path){const o=e.path;n=t.filter((e=>e.path.join(".")===o))}else if(e.pathsOf){const o=e.pathsOf,a=o.join(".");n=t.filter((e=>(e.path.length===o.length+1||e.path.length===o.length&&(e.type===O||e.type===S))&&e.path.join(".").startsWith(a)))}else if(e.pathsFrom){const o=e.pathsFrom;n=t.filter((e=>e.path.join(".").startsWith(o)))}return n},R=(e,t)=>{try{e(t)}catch(n){console.error("failed to notify listener ".concat(e," with ")+t,n)}},F=function(){var e,t,n=this.batches;for([e,t]of(this.batches=null,n))R(e,t)},H=(e,t)=>{let n,o,a,i,r,s=e;var c=t.length;do{for(n=s.observers,r=n.length;r--;)if([o,a]=n[r],(i=q(a,t)).length)if(s.options.async){let e;s.batches||(s.batches=[],queueMicrotask(F.bind(s)));for(const t of s.batches)if(t[0]===o){e=t;break}e||(e=[o,[]],s.batches.push(e)),Array.prototype.push.apply(e[1],i)}else R(o,i);if(s.parent){const e=new Array(c);for(let n=0;n<c;n++)e[n]={...t[n]},e[n].path=[s.ownKey,...e[n].path];t=e,s=s.parent}else s=null}while(s)},B=(e,t,n)=>e&&"object"==typeof e?Array.isArray(e)?new X({target:e,ownKey:t,parent:n}).proxy:ArrayBuffer.isView(e)?new U({target:e,ownKey:t,parent:n}).proxy:e instanceof Date?e:new Y({target:e,ownKey:t,parent:n}).proxy:e,Z={pop:function(){const e=this[A],t=e.target,n=t.length-1;let o=t.pop();if(o&&"object"==typeof o){const e=o[A];e&&(o=e.detach())}var a=[new L(P,[n],void 0,o,this)];return H(e,a),o},push:function(){const e=this[A],t=e.target,n=arguments.length,o=new Array(n),a=t.length;for(let t=0;t<n;t++)o[t]=B(arguments[t],a+t,e);var i=Reflect.apply(t.push,t,o);const r=[];for(let e=a,n=t.length;e<n;e++)r[e-a]=new L(k,[e],t[e],void 0,this);return H(e,r),i},shift:function(){const e=this[A],t=e.target;let n,o,a,i,r;for(n=t.shift(),n&&"object"==typeof n&&(r=n[A],r&&(n=r.detach())),o=0,a=t.length;o<a;o++)(i=t[o])&&"object"==typeof i&&(r=i[A],r&&(r.ownKey=o));var s=[new L(P,[0],void 0,n,this)];return H(e,s),n},unshift:function(){const e=this[A],t=e.target,n=arguments.length,o=new Array(n);for(let t=0;t<n;t++)o[t]=B(arguments[t],t,e);var a=Reflect.apply(t.unshift,t,o);for(let e,n=0,o=t.length;n<o;n++)if((e=t[n])&&"object"==typeof e){const t=e[A];t&&(t.ownKey=n)}var i=o.length;const r=new Array(i);for(let e=0;e<i;e++)r[e]=new L(k,[e],t[e],void 0,this);return H(e,r),a},reverse:w,sort:I,fill:x,copyWithin:C,splice:function(){const e=this[A],t=e.target,n=arguments.length,o=new Array(n),a=t.length;for(let t=0;t<n;t++)o[t]=B(arguments[t],t,e);const i=0===n?0:o[0]<0?a+o[0]:o[0],r=n<2?a-i:o[1],s=Math.max(n-2,0),c=Reflect.apply(t.splice,t,o),l=t.length;let d,u,p,m;for(let e,n=0;n<l;n++)(e=t[n])&&"object"==typeof e&&(d=e[A],d&&(d.ownKey=n));for(u=0,p=c.length;u<p;u++)(m=c[u])&&"object"==typeof m&&(d=m[A],d&&(c[u]=d.detach()));const h=[];let f;for(f=0;f<r;f++)f<s?h.push(new L(D,[i+f],t[i+f],c[f],this)):h.push(new L(P,[i+f],void 0,c[f],this));for(;f<s;f++)h.push(new L(k,[i+f],t[i+f],void 0,this));return H(e,h),c}},W={reverse:w,sort:I,fill:x,copyWithin:C,set:function(e,t){const n=this[A],o=n.target,a=e.length,i=o.slice(0);t=t||0,o.set(e,t);const r=new Array(a);for(let e=t;e<a+t;e++)r[e-t]=new L(D,[e],o[e],i[e],this);H(n,r)}};class L{constructor(e,t,n,o,a){this.type=e,this.path=t,this.value=n,this.oldValue=o,this.object=a}}class N{constructor(e,t){var{target:n,parent:o,ownKey:a}=e;o&&void 0!==a?(this.parent=o,this.ownKey=a):(this.parent=null,this.ownKey=null),n=t(n,this),this.observers=[],this.revocable=Proxy.revocable(n,this),this.proxy=this.revocable.proxy,this.target=n,this.options=this.processOptions(e.options)}processOptions(e){if(e){if("object"!=typeof e)throw new Error("Observable options if/when provided, MAY only be an object, got '".concat(e,"'"));const t=Object.keys(e).filter((e=>!(e in M)));if(t.length)throw new Error("'".concat(t.join(", "),"' is/are not a valid Observable option/s"));return Object.assign({},e)}return{}}detach(){return this.parent=null,this.target}set(e,t,n){let o=e[t];if(n!==o){if(n=B(n,t,this),e[t]=n,o&&"object"==typeof o){const e=o[A];e&&(o=e.detach())}n=void 0===o?[new L(k,[t],n,void 0,this.proxy)]:[new L(D,[t],n,o,this.proxy)],H(this,n)}return!0}deleteProperty(e,t){let n=e[t];if(delete e[t],n&&"object"==typeof n){const e=n[A];e&&(n=e.detach())}return t=[new L(P,[t],void 0,n,this.proxy)],H(this,t),!0}}class Y extends N{constructor(e){super(e,E)}}class X extends N{constructor(e){super(e,j)}get(e,t){return Z[t]||e[t]}}class U extends N{constructor(e){super(e,T)}get(e,t){return W[t]||e[t]}}const V=Object.freeze({from:(e,t)=>{if(e&&"object"==typeof e){if(e[A])return e;if(Array.isArray(e))return new X({target:e,ownKey:null,parent:null,options:t}).proxy;if(ArrayBuffer.isView(e))return new U({target:e,ownKey:null,parent:null,options:t}).proxy;if(e instanceof Date)throw new Error(e+" found to be one of a non-observable types");return new Y({target:e,ownKey:null,parent:null,options:t}).proxy}throw new Error("observable MAY ONLY be created from a non-null object")},isObservable:e=>!(!e||!e[A])});Symbol("observer-key"),Symbol("targets-key");const K=f.getMenuItemsById("absoluteapicheck"),G=f.getMenuItemsById("portapiwarning"),J={},Q=V.from({},{async:!0}),ee={};function te(t,n){let o=!1;const a={_contextMenuID:l.uniqueID("cm"),_events:d(),get initialized(){return o}},i=$('<div style="display: none; position: fixed; top: 0; left: 0; bottom: 0; right: 0; z-index: '.concat(l.menubarButtonsZIndex-2,';"></div>'));return a.init=function(){if(o)return a;return a.menu=e($.extend(function e(t){let n;switch($.type(t)){case"array":n=[],t.forEach((t=>n.push(e(t))));break;case"object":n=$.extend(!0,{},t),$.isEmptyObject(n)||(n.alt=!1),n.menus&&(n.menus=e(n.menus));break;default:n=t}return n}(n),{altMode:!1,keyboardMode:!0,keyboardModeOnFirstMenu:!0})).init(document.body),a.menu.mainMenu.$.addClass("context-menu"),a.menu.mainMenu.$.on("mouseenter mouseleave",(()=>{$(t).trigger("mouseenter")})).on("mousemove",(()=>{$(t).trigger("mousemove")})),a.menu._events.on("_show",(()=>{setTimeout((()=>{$(t).trigger("mouseenter")}),0)})),i.on("mousedown",(e=>{$(e.relatedTarget).closest(t).length||$(t).trigger("mouseleave")})),a.menu.mainMenu.$.on("click",(e=>{$(e.relatedTarget).closest(t).length||$(t).trigger("mouseleave")})),$(document.body).on("contextmenu.".concat(a._contextMenuID),t,(function(e){$(e.target).closest(n.ignore).length||(e.preventDefault(),e.stopPropagation(),a._events.call("beforeshow",a,e),a.menu.mainMenu.show({top:e.pageY,left:e.pageX},!1),a.menu.mainMenu.$.parent().css("z-index",l.menubarButtonsZIndex-1))})),i.appendTo(document.body),a.menu._events.on("_show",(()=>i.show())).on("_hide",(()=>i.hide())),o=!0,a},a.destroy=function(){return o&&(a.menu.destroy(),i.remove(),$(document.body).off("contextmenu.".concat(a._contextMenuID)),l.destroyObj(a)),a},a}function ne(e){const t={_compID:l.uniqueID("cp"),_mcompID:l.uniqueID("mc"),_events:d(),api:null,cache:{}};let n,o,a,i,r,c=!0,u=!1,p="!unknown",m="Untitled",h="",f=!1,_="#97d2fb",g="black",v=!0,b=!1,w=!1,I=200,x=200,C=!0;function k(e){let n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(!/^#[0-9A-F]{6}$/i.test(e))return;const o=_;_=e,"#"===e.slice(0,1)&&(e=e.slice(1)),3===e.length&&(e=e.split("").map((function(e){return e+e})).join(""));const i=parseInt(e.substr(0,2),16),s=parseInt(e.substr(2,2),16),c=parseInt(e.substr(4,2),16),l=(299*i+587*s+114*c)/1e3;g=l>=128?"#000":"#fff",a.find(".component__header").add(r).css({background:_,color:g}),n&&t._events.call("backgroundchange",t,_,g,o)}return e&&(void 0!==e.namespace&&(p=e.namespace),void 0!==e.name&&(m=e.name),!0===e.init&&(f=e.init),!1===e.primary&&(v=!1),!0===e.silent?b=!0:(a=$(e.compElm),o=a[0],r=$(e.minCompElm),i=r[0],void 0!==e.body&&(h=e.body),void 0!==e.background&&/^#[0-9A-F]{6}$/i.test(e.background)&&(_=e.background)),e.width&&(I=Math.max(0,parseInt(e.width))),e.height&&(x=Math.max(0,parseInt(e.height)))),t.destroy=function(e){return new Promise((n=>{if(!e&&v)return n();const o=()=>t.api.invoke("willremove",!0).then((()=>{if(t._events.call("beforedestroy",t),!b){var e=a.parent(),n=r.parent();a.remove(),r.remove()}s.remove("Component:".concat(m)),t._events.call("afterdestroy",t,b?void 0:{parentCompInstance:e,parentMinCompInstance:n}),t.api.disable(),l.destroyObj(t)}));if(b||e)return o().then(n);$.confirm($.extend({},l.confirmConfiguration,{content:"This will delete the component permanently. Are you sure?",buttons:{confirm:()=>{t.api.call("willremove",!1).then((e=>{!1!==e?o().then(n):$.confirm($.extend({},l.confirmConfiguration,{content:"The component prevented you from removing it. Do you want to force the removal?",buttons:{confirm:()=>{o().then(n)},cancel:n}}))}))},cancel:n}}))}))},t.options=function(){return b?{namespace:p,name:m,init:f,primary:v,silent:b}:{compElm:o,minCompElm:i,namespace:p,name:m,body:h,init:f,primary:v,silent:b,background:_,color:g,width:I,height:x}},t.compInstance=function(e){return b?null:e?a:o},t.minCompInstance=function(e){return b?null:e?r:i},t.background=function(e){return b||k(e),t},t.rename=function(e){var n;if((e="".concat(null!==(n=e)&&void 0!==n?n:"").trim()).length&&e!==m){const n=m;t._events.call("beforerename",t,e,n),s.remove("Component:".concat(m)),m=l.fixDuplicateNames.run(e,"Component"),s.set("Component:".concat(m),!0),b||(a.find(".component__header__title").text(m),r.find(".component-minimized__title").text(m)),t._events.call("afterrename",t,e,n)}return t},t.duplicate=function(){if(t._events.call("beforeduplicate",t),!b){var e=document.createElement("div"),n=document.createElement("div");a.after(e),r.after(n)}const o=t.options();o.primary=!1,b||(o.compElm=e,o.minCompElm=n);const i=ne(o);return t._events.call("afterduplicate",t,i),i},t.maximize=function(){return new Promise((e=>{b?e(t):(t._events.call("beforemaximize",t),a.fadeIn(l.duration.fastPace),r.fadeOut(l.duration.fastPace),a.add(r).promise().done((function(){try{C=!0,t._events.call("aftermaximize",t),e(t)}catch(e){}})))}))},t.minimize=function(){return new Promise((e=>{b?e(t):(t._events.call("beforeminimize",t),a.fadeOut(l.duration.fastPace),r.fadeIn(l.duration.fastPace),a.add(r).promise().done((function(){try{C=!1,t._events.call("afterminimize",t),e(t)}catch(e){}})))}))},t.isMaximized=function(){return C},t.enable=function(){return!b&&u&&(n||t._events.call("beforeenable",t),a.removeClass("disabled"),a.find(".component__header__modes__toggler.onoff").attr("title","Lock"),$(document).tooltip("disable"),$(document).tooltip("enable"),w=!0,n||t._events.call("afterenable",t)),t},t.disable=function(){return b||(t._events.call("beforedisable",t),a.addClass("disabled"),a.find(".component__header__modes__toggler.onoff").attr("title","Unlock"),$(document).tooltip("disable"),$(document).tooltip("enable"),w=!1,t._events.call("afterdisable",t)),t},t.toggle=function(){return!0===w?t.disable():t.enable()},t.reset=function(){if(t._events.call("beforereset",t),u=!1,n=!0,c||s.remove("Component:".concat(m)),c=!1,m=l.fixDuplicateNames.run(m,"Component"),s.set("Component:".concat(m),!0),!b){o.outerHTML='<div class="component disabled '.concat(t._compID).concat(v?" primary":"",'">\n <div class="component__header">\n <div class="component__header__modes">\n <div class="component__header__modes__toggler minimize" title="Minimize">&mdash;</div>\n <div class="component__header__modes__toggler onoff" title="Unlock"></div>\n </div>\n <div class="component__header__title">').concat(m,'</div>\n <div class="component__header__modes right">\n <div class="component__header__modes__toggler menu" title="Menu"></div>\n </div>\n <div class="component__header__menu">\n <div class="component__header__menu__item color">Color</div>\n <div class="component__header__menu__item rename">Rename</div>\n <div class="component__header__menu__item duplicate">Duplicate</div>\n <div class="component__header__menu__item reset">Reset</div>\n ').concat(v?"":'<div class="component__header__menu__item delete">Delete</div>','\n </div>\n <div class="component__header__overlay">\n <div class="inputgroup" style="display: none;">\n <div class="inputgroup__info">Rename:</div>\n <div class="inputgroup__input">\n <input class="component__header__overlay__namebox" placeholder="Enter a new name" />\n <small>ENTER to proceed, ESC to cancel.</small>\n </div>\n </div>\n <div class="component__header__overlay__text">Initializing...</div>\n </div>\n </div>\n <div class="component__body" style="height: ').concat(x,"px; width: ").concat(I,'px; box-sizing: content-box;"></div>\n </div>'),o=(a=$(".".concat(t._compID)))[0];const e=a.find(".component__body");a.css("width",I+e.innerWidth()-e.width()),i.outerHTML='<div class="component-minimized '.concat(t._mcompID,'" style="display: none;" data-belong-to-component="').concat(t._compID,'">\n <div class="component-minimized__modes">\n <div class="component-minimized__modes__toggler maximize" title="Maximize">&#65291;</div>\n </div>\n <div class="component-minimized__title">').concat(m,"</div>\n </div>"),i=(r=$(".".concat(t._mcompID)))[0];const n=te(".".concat(t._mcompID),{id:"main",align:"vertical",menus:[{name:"Color",id:"color",type:"click"},{name:"Rename",id:"rename",type:"click"},{name:"Duplicate",id:"duplicate",type:"click"}].concat(v?[]:[{},{name:"Delete",id:"remove",type:"click"}])}).init();n.menu._events.on("rename",(()=>{l.launchInputBox("Rename Component",m,"Type new name here",(e=>{t.rename(e)}))})).on("duplicate",(()=>{t.duplicate()})).on("remove",(()=>{t.destroy()})).on("color",(e=>{let{dontCloseAllMenus:t}=e;return t()})),n.menu.getMenuItemsById("color").$.spectrum({...l.spectrumConfiguration,type:"color",color:_,show:function(){n.menu.mainMenu.hide()},move:function(e){t.background(e.toHexString())},change:function(e){t.background(e.toHexString())}}),k(_,!1),a.find(".component__header__overlay__namebox").on("keyup",(function(e){13===e.which&&(t.rename($(this).val()),$(this).parents(".inputgroup").css("display","none")),27===e.which&&$(this).parents(".inputgroup").css("display","none")})).on("blur",(function(){$(this).parents(".inputgroup").css("display","none")}));const s=function(){a.find(".component__header__modes__toggler.menu").removeClass("active"),a.find(".component__header__menu").removeClass("active"),e.removeAttr("disabled")};$(document).on("mouseup",(function(e){const t=a.find(".component__header__menu").add(a.find(".component__header__modes__toggler.menu"));t.is(e.target)||0!==t.has(e.target).length||s()})),a.find(".component__header__menu__item.color").spectrum({...l.spectrumConfiguration,color:_,hide:s,move:function(e){t.background(e.toHexString())},change:function(e){t.background(e.toHexString())}}),a.find(".component__header__modes__toggler.menu").on("click",(function(){$(this).toggleClass("active"),a.find(".component__header__menu").toggleClass("active"),e.toggleAttr("disabled")})),a.find(".component__header__menu__item.color").on("click",(function(){$(this).spectrum("show")})),a.find(".component__header__menu__item.rename").on("click",(function(){a.find(".component__header__overlay__namebox").val(m),a.find(".component__header__overlay .inputgroup").css("display",""),a.find(".component__header__overlay__namebox").trigger("focus"),s()})),a.find(".component__header__menu__item.duplicate").on("click",(function(){t.duplicate(),s()})),a.find(".component__header__menu__item.reset").on("click",(function(){$.confirm($.extend({},l.confirmConfiguration,{content:"This will reset the component to its initial state. Are you sure?",buttons:{confirm:()=>{t.reset()},cancel:()=>{}}})),s()})),v||a.find(".component__header__menu__item.delete").on("click",(function(){t.destroy(),s()})),a.find(".component__header__modes__toggler.onoff").on("click",t.toggle),a.find(".component__header__modes__toggler.minimize").on("click",t.minimize),r.find(".component-minimized__modes__toggler.maximize").on("click",t.maximize),$.fn.updateTitle("");const c=$('<webview style="height: 100%; width: 100%;" preload="../app/preload.js" />');t.api=function(e,t,n){const o={_events:d()},a={},i=$(t),r=e=>{const t="object"===$.type(e)?e:{},n=Object.prototype.hasOwnProperty.call(t,"result")?{result:t.result}:Object.prototype.hasOwnProperty.call(t,"error")&&t.error instanceof Error?{error:t.error}:{args:"array"===$.type(t.args)?t.args:[]};return t.request?{request:""+t.request,...n}:null},s={promise:new Promise((e=>{const t=n=>{if("component-api"===n.channel){const o=r(n.args[0]);o&&"shake"===o.request&&(i[0].removeEventListener("ipc-message",t),e())}};i[0].addEventListener("ipc-message",t)}))},c={},u={call:function(t){for(var i=arguments.length,r=new Array(i>1?i-1:0),s=1;s<i;s++)r[s-1]=arguments[s];const c=(t,o,a)=>{K.isTicked()&&!Object.prototype.hasOwnProperty.call(J,e)?$.confirm($.extend({},l.confirmConfiguration,{title:"".concat(y(n.options().name),": Absolute Permission Required!"),content:'<div style="line-height: 1.25rem;">\n A component of id <strong>'.concat(y(e),'</strong> requires the permission to use absolute paths for reading/writing files. Request: <code style="vertical-align: unset;">').concat(t,'</code>.<br />This may expose your private data to the component provider. Are you sure to allow this action?\n </div><p style="font-size: 0.9em; margin-top: 0.5rem;">\n <input type="checkbox" />\n <label style="margin-left: 0.5rem;">Remember my choice for such components until the end of this session.</label>\n </p>'),buttons:{cancel:{btnClass:"btn-red",action:function(){this.$content.find('input[type="checkbox"]').is(":checked")&&(J[e]=!1),a()}},confirm:{text:"Allow",btnClass:"btn-blue",action:function(){this.$content.find('input[type="checkbox"]').is(":checked")&&(J[e]=!0),o()}}}})):J[e]?o():a()},d=(e,t,o)=>{G.isTicked()?$.confirm($.extend({},l.confirmConfiguration,{title:"".concat(y(n.options().name),": Port Connection Required!"),content:"This component wants to listen to the port <strong>".concat(e,"</strong>. Are you sure to make this connection?<br />Be careful that it might lead to cyclic updates that freeze the application."),buttons:{confirm:()=>{t()},cancel:()=>{o()}}})):t()},u=(e,t)=>{if(e=parseInt(e),!isNaN(e))return"".concat(e);t(new Error("Invalid port number"))};switch(t){case"alert":return new Promise((e=>{$.alert($.extend({},l.alertConfiguration,{title:"".concat(y(n.options().name),": Alert!"),content:y(r[0]||""),onClose:()=>e()}))}));case"confirm":return new Promise((e=>{$.confirm($.extend({},l.confirmConfiguration,{title:"".concat(y(n.options().name),": Confirmation"),content:y(r[0]||""),buttons:{confirm:()=>{e(!0)},cancel:()=>{e(!1)}}}))}));case"newoutput":return new Promise((e=>{n.trigger("outputchange",...r),e()}));case"readfileabsoluteconfirm":return new Promise((e=>{c("READ FROM <strong>".concat(r[0]||"N/A","</strong>"),(()=>{e(!0)}),(()=>{e(!1)}))}));case"savefileabsoluteconfirm":return new Promise((e=>{c("WRITE TO <strong>".concat(r[0]||"N/A","</strong>"),(()=>{e(!0)}),(()=>{e(!1)}))}));case"bindtoport":return new Promise(((e,t)=>{const i=u(r[0],t);i&&d(i,(()=>{Q.observe(a[i]=e=>{o.call("port.".concat(i),e[e.length-1].value)},{path:i}),Object.prototype.hasOwnProperty.call(Q,i)&&o.call("port.".concat(i),Q[i]),Object.prototype.hasOwnProperty.call(ee,i)||(ee[i]=[]),ee[i].push(n._compID),e(!0)}),(()=>{e(!1)}))}));case"unbindfromport":return new Promise(((e,t)=>{const o=u(r[0],t);o&&(Object.prototype.hasOwnProperty.call(a,o)&&(Q.unobserve(a[o]),delete a[o]),Object.prototype.hasOwnProperty.call(ee,o)&&(ee[o]=ee[o].filter((e=>e!==n._compID)),ee[o].length||(delete ee[o],delete Q[o])),e())}));case"sendtoport":return new Promise(((e,t)=>{const n=u(r[0],t);n&&(Object.prototype.hasOwnProperty.call(ee,n)&&ee[n].length?(Q[n]=r[1],e(ee[n].length)):e(0))}));case"componentgetentity":return e;case"componentgetname":return n.options().name;case"componentsetname":return n.rename(r[0]),n.options().name;case"componentgetbackground":return n.options().background;case"componentsetbackground":return n.background(r[0]),n.options().background;case"componentaddinputparam":return n._events.call("hub.parameter.input.add",null,...r)[0];case"componenthasinputparam":return n._events.call("hub.parameter.input.has",null,...r)[0];case"componentremoveinputparam":return n._events.call("hub.parameter.input.remove",null,...r)[0];case"componentaddoutputparam":return n._events.call("hub.parameter.output.add",null,...r)[0];case"componenthasoutputparam":return n._events.call("hub.parameter.output.has",null,...r)[0];case"componentremoveoutputparam":return n._events.call("hub.parameter.output.remove",null,...r)[0];case"componentgetallparams":return n._events.call("hub.parameter.all",null,...r)[0];default:$.alert($.extend({},l.alertConfiguration,{title:"".concat(y(n.options().name),": Method Call Declined!"),content:"The component calls an unreferenced API method, thus has been declined. Please contact the component developer."}))}}},p=e=>{"component-api"===e.channel&&s.promise.then((()=>{const t=r(e.args[0]);if(t){const e=t.request.split(":");"child"===e[0]?Promise.resolve((u[e.slice(2).join(":")]||(()=>{})).apply(null,t.args)).then((e=>{i[0].send("component-api",{request:t.request,result:e})}),(e=>{i[0].send("component-api",{request:t.request,error:e})})):c[t.request]&&(Object.prototype.hasOwnProperty.call(t,"error")?(c[t.request].reject(t.error),delete c[t.request]):Object.prototype.hasOwnProperty.call(t,"result")&&(c[t.request].resolve(t.result),delete c[t.request]))}}))};i[0].addEventListener("ipc-message",p);const m=e=>{const t="[".concat(n.options().name,"] ").concat(e.message);0===e.level?console.log(t):1===e.level?console.info(t):2===e.level?console.warn(t):console.error(t)};i[0].addEventListener("console-message",m);const h=()=>{$.alert($.extend({},l.alertConfiguration,{title:"".concat(y(n.options().name),": Crashed!"),content:"This component appeared to have crashed. Try resetting it or contacting the component developer."}))};i[0].addEventListener("crashed",h),s.destroy=()=>{i[0].removeEventListener("ipc-message",p),i[0].removeEventListener("console-message",m),i[0].removeEventListener("crashed",h)};let f=0;return o.call=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return s.promise.then((()=>new Promise(((e,n)=>{const o="parent:".concat(f++,":call");c[o]={resolve:e,reject:n},i[0].send("component-api",{request:o,args:t})}))))},o.invoke=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return s.promise.then((()=>new Promise((e=>{const n="parent:".concat(f++,":call");try{i[0].send("component-api",{request:n,args:t})}catch(e){}e()}))))},o.disable=function(){s.destroy(),l.destroyObj(o)},o.whenEstablished=function(e){return s.promise.then((()=>e()))},setTimeout((()=>{i.attr("src","data:text/html,".concat(encodeURIComponent(n.options().body)))}),0),o}(p,c,t),c.appendTo(e)}if(t.cache={},t._events.call("afterinit",t),b)u=!0,t.enable();else{const e=a.find(".component__header__overlay__text");e.text("Establishing a connection..."),t.api.whenEstablished((()=>{e.css("display","none"),u=!0,t.enable()}))}return t},t.trigger=function(e){e&&Object.prototype.hasOwnProperty.call(e,"length")&&e.length||(e="triggered");for(var n=arguments.length,o=new Array(n>1?n-1:0),a=1;a<n;a++)o[a-1]=arguments[a];return t._events.call.apply(null,Array.prototype.concat([e,t],o)),t},t.state={backup:function(){return t.api.call("backup").then((e=>{let t="{}";try{t=JSON.stringify(e)}catch(e){$.alert($.extend({},l.alertConfiguration,{title:"".concat(y(m),": Backup Failed"),content:"Invalid backup data. Error: "+(e&&e.message||"")}))}return t})).catch((()=>"{}"))},restore:function(e){let n={};try{n=JSON.parse(e)}catch(e){$.alert($.extend({},l.alertConfiguration,{title:"".concat(y(m),": Restore Failed"),content:"Backup data corrupted. Error: "+(e&&e.message||"")}))}return t.api.call("restore",n).catch((e=>{$.alert($.extend({},l.alertConfiguration,{title:"".concat(y(m),": Restore Failed"),content:e&&e.message||""}))}))}},t.init=function(){return c&&t.reset(),t},f&&t.init(),t}function oe(e,t,n,o){let a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{};t instanceof window.HTMLCollection||t instanceof window.NodeList?t=Array.from(t):Array.isArray(t)||(t=[t]),Array.isArray(n)||(n=[n]);for(const i of t)for(const t of n)i[e](t,o,{capture:!1,...a});return Array.prototype.slice.call(arguments,1)}const ae=oe.bind(null,"addEventListener"),ie=oe.bind(null,"removeEventListener"),re=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"px";return"number"==typeof e?e+t:e};function se(e,t,n){const o=e&&e.style;if(o)if("object"==typeof t)for(const[e,n]of Object.entries(t))o[e]=re(n);else n&&"string"==typeof t&&(o[t]=re(n))}function ce(e,t,n){switch(n||"touch"){case"center":{const n=t.left+t.width/2,o=t.top+t.height/2;return n>=e.left&&n<=e.right&&o>=e.top&&o<=e.bottom}case"cover":return t.left>=e.left&&t.top>=e.top&&t.right<=e.right&&t.bottom<=e.bottom;case"touch":return e.right>=t.left&&e.left<=t.right&&e.bottom>=t.top&&e.top<=t.bottom;default:throw new Error("Unknown intersection mode: ".concat(n))}}function le(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:document;Array.isArray(e)||(e=[e]);const n=[];for(let o=0,a=e.length;o<a;o++){const a=e[o];"string"==typeof a?n.push(...t.querySelectorAll(a)):a instanceof t.defaultView.HTMLElement&&n.push(a)}return n}function de(e){let t=e.path||e.composedPath&&e.composedPath();if(t&&t.length>0)return t;let n=e.target;for(t=[n];n=n.parentElement;)t.push(n);return t.push(document,window),t}function ue(e,t){const n=e.indexOf(t);~n&&e.splice(n,1)}function pe(e){const t=e.touches&&e.touches[0]||e;return{tap:t,x:t.clientX,y:t.clientY,target:t.target}}"function"!=typeof Object.assign&&Object.defineProperty(Object,"assign",{value:function(e,t){if(null==e)throw new TypeError("Cannot convert undefined or null to object");const n=Object(e);for(let e=1;e<arguments.length;e++){const t=arguments[e];if(null!=t)for(const e in t)Object.prototype.hasOwnProperty.call(t,e)&&(n[e]=t[e])}return n},writable:!0,configurable:!0});const{abs:me,max:he,min:fe,round:_e,ceil:ge}=Math,ve=e=>e.preventDefault(),ye=void 0===window.DOMRect?window.ClientRect:window.DOMRect;const be={utils:{on:ae,off:ie,css:se,intersects:ce,selectAll:le,eventPath:de,removeElement:ue},create:e=>function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const t={options:Object.assign({class:"selection-area",frame:document,mode:"touch",tapMode:"native",startThreshold:10,singleClick:!0,disableTouch:!1,selectables:[],scrollSpeedDivider:10,manualScrollSpeed:750,startareas:["html"],boundaries:["html"],selectionAreaContainer:"body"},e),_stored:[],_selectables:[],_selected:[],_changed:{added:[],removed:[]},_eventListener:{beforestart:[],start:[],move:[],stop:[]},_area:null,_areaDomRect:null,_clippingElement:null,_scrollAvailable:!0,_scrollSpeed:{x:null,y:null},_init(){const{frame:e}=t.options;t._area=e.createElement("div"),t._clippingElement=e.createElement("div"),t._clippingElement.appendChild(t._area),t._area.classList.add(t.options.class),se(t._area,{willChange:"top, left, bottom, right, width, height",top:0,left:0,position:"fixed"}),se(t._clippingElement,{overflow:"hidden",position:"fixed",transform:"translate3d(0, 0, 0)",pointerEvents:"none",zIndex:"1"}),t.enable()},_bindStartEvents(e){const{frame:n}=t.options,o="on"===e?ae:ie;o(n,"mousedown",t._onTapStart),t.options.disableTouch||o(n,"touchstart",t._onTapStart,{passive:!1})},_onTapStart(e){let n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const{x:o,y:a,target:i}=pe(e),{startareas:r,boundaries:s,frame:c}=t.options,l=i.getBoundingClientRect(),d=le(r,c);t._boundaries=le(s,c),t._targetContainer=t._boundaries.find((e=>ce(e.getBoundingClientRect(),l)));const u=de(e);t._targetContainer&&d.find((e=>u.includes(e)))&&t._boundaries.find((e=>u.includes(e)))&&(n||!1!==t._emit("beforestart",e))&&(t._ax1=o,t._ay1=a,t._ax2=0,t._ay2=0,t._singleClick=!0,t.clearSelection(!1),ae(c,"selectstart",ve),ae(c,["touchmove","mousemove"],t._delayedTapMove,{passive:!1}),ae(c,["mouseup","touchcancel","touchend"],t._onTapStop),e.preventDefault())},_onSingleTap(e){const{tapMode:n}=t.options,o=pe(e);let a=null;if("native"===n)a=o.target;else{if("touch"!==n)throw new Error("Unknown tapMode option: ".concat(n));{t.resolveSelectables();const{x:e,y:n}=o;a=t._selectables.find((t=>{const{right:o,left:a,top:i,bottom:r}=t.getBoundingClientRect();return e<o&&e>a&&n<r&&n>i}))}}if(!a)return!1;for(t.resolveSelectables();!t._selectables.includes(a);){if(!a.parentElement)return;a=a.parentElement}t._emit("start",e);const i=t._stored;if(e.shiftKey&&i.length){const n=i[i.length-1],[o,r]=4&n.compareDocumentPosition(a)?[a,n]:[n,a],s=[...t._selectables.filter((e=>4&e.compareDocumentPosition(o)&&2&e.compareDocumentPosition(r))),a];t.select(s),t._emit("move",e),t._emit("stop",e)}else t._stored.includes(a)?t.removeFromSelection(a):t.select(a),t._emit("move",e),t._emit("stop",e)},_delayedTapMove(e){const{x:n,y:o}=pe(e),{startThreshold:a,frame:i}=t.options,{_ax1:r,_ay1:s}=t,c=typeof a;if("number"===c&&me(n+o-(r+s))>=a||"object"===c&&me(n-r)>=a.x||me(o-s)>=a.y){ie(i,["mousemove","touchmove"],t._delayedTapMove,{passive:!1}),ae(i,["mousemove","touchmove"],t._onTapMove,{passive:!1}),se(t._area,"display","block"),le(t.options.selectionAreaContainer,i)[0].appendChild(t._clippingElement),t.resolveSelectables(),t._singleClick=!1;const n=t._targetBoundary=t._targetContainer.getBoundingClientRect();_e(t._targetContainer.scrollHeight)!==_e(n.height)||_e(t._targetContainer.scrollWidth)!==_e(n.width)?(t._scrollAvailable=!0,ae(window,"wheel",t._manualScroll,{passive:!1}),t._selectables=t._selectables.filter((e=>t._targetContainer.contains(e))),se(t._clippingElement,{top:n.top,left:n.left,width:n.width,height:n.height}),se(t._area,{marginTop:-n.top,marginLeft:-n.left})):(t._scrollAvailable=!1,se(t._clippingElement,{top:0,left:0,width:"100%",height:"100%"}),se(t._area,{marginTop:0,marginLeft:0})),t._onTapMove(e),t._emit("start",e)}e.preventDefault()},_onTapMove(e){const{x:n,y:o}=pe(e),{scrollSpeedDivider:a}=t.options,i=t._targetContainer;let r=t._scrollSpeed;t._ax2=n,t._ay2=o,!t._scrollAvailable||null===r.y&&null===r.x?(t._recalcAreaRect(),t._updatedTouchingElements(),t._emit("move",e),t._redrawArea()):requestAnimationFrame((function n(){r=t._scrollSpeed;const o=null!==r.y,s=null!==r.x;if(!o&&!s)return;const{scrollTop:c,scrollLeft:l}=i;o&&(i.scrollTop+=ge(r.y/a),t._ay1-=i.scrollTop-c),s&&(i.scrollLeft+=ge(r.x/a),t._ax1-=i.scrollLeft-l),t._recalcAreaRect(),t._updatedTouchingElements(),t._emit("move",e),t._redrawArea(),requestAnimationFrame(n)})),e.preventDefault()},_manualScroll(e){const{manualScrollSpeed:n}=t.options,o=e.deltaY?e.deltaY>0?1:-1:0,a=e.deltaX?e.deltaX>0?1:-1:0;t._scrollSpeed.y+=o*n,t._scrollSpeed.x+=a*n,t._onTapMove(e),e.preventDefault()},_recalcAreaRect(){const{scrollTop:e,scrollHeight:n,clientHeight:o,scrollLeft:a,scrollWidth:i,clientWidth:r}=t._targetContainer,s=t._targetBoundary,c=t._scrollSpeed;let l=t._ax2,d=t._ay2;l<s.left?(c.x=a?-me(s.left-l):null,l=s.left):l>s.left+s.width?(c.x=i-a-r?me(s.left+s.width-l):null,l=s.left+s.width):c.x=null,d<s.top?(c.y=e?-me(s.top-d):null,d=s.top):d>s.top+s.height?(c.y=n-e-o?me(s.top+s.height-d):null,d=s.top+s.height):c.y=null;const u=fe(t._ax1,l),p=fe(t._ay1,d),m=he(t._ax1,l),h=he(t._ay1,d);t._areaDomRect=new ye(u,p,m-u,h-p)},_redrawArea(){const{x:e,y:n,width:o,height:a}=t._areaDomRect,i=t._area.style;i.transform="translate3d("+e+"px,"+n+"px, 0)",i.width=o+"px",i.height=a+"px"},_onTapStop(e,n){const{frame:o,singleClick:a}=t.options;ie(o,["mousemove","touchmove"],t._delayedTapMove),ie(o,["touchmove","mousemove"],t._onTapMove),ie(o,["mouseup","touchcancel","touchend"],t._onTapStop),e&&t._singleClick&&a?t._onSingleTap(e):t._singleClick||n||(t._updatedTouchingElements(),t._emit("stop",e)),t._scrollSpeed.x=0,t._scrollSpeed.y=0,ie(window,"wheel",t._manualScroll),t._clippingElement.remove(),ie(o,"selectstart",ve),se(t._area,"display","none")},_updatedTouchingElements(){const{_selected:e,_selectables:n,options:o,_areaDomRect:a}=t,{mode:i}=o,r=[],s=[],c=[];for(let t=0;t<n.length;t++){const o=n[t];(i&&"[object Function]"==={}.toString.call(i)?i(a,o):ce(a,o.getBoundingClientRect(),i))&&(e.includes(o)||s.push(o),r.push(o))}for(let t=0;t<e.length;t++){const n=e[t];r.includes(n)||c.push(n)}t._selected=r,t._changed={added:s,removed:c}},_emit(e,n){let o=!0;for(const a of t._eventListener[e])o=a.call(t,{inst:t,area:t._area,selected:t._selected.concat(t._stored),changed:t._changed,oe:n})&&o;return o},trigger(e){let n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];t._onTapStart(e,n)},on:(e,n)=>(t._eventListener[e].push(n),t),off(e,n){const o=t._eventListener[e];if(o){const e=o.indexOf(n);~e&&o.splice(e,1)}return t},resolveSelectables(){t._selectables=le(t.options.selectables,t.options.frame)},keepSelection(){const{_selected:e,_stored:n}=t;for(let t=0;t<e.length;t++){const o=e[t];n.includes(o)||n.push(o)}},clearSelection(){(!(arguments.length>0&&void 0!==arguments[0])||arguments[0])&&(t._stored=[]),t._selected=[],t._changed.added=[],t._changed.removed=[]},removeFromSelection(e){t._changed.removed.push(e),ue(t._stored,e),ue(t._selected,e)},getSelection:()=>t._stored,cancel(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];t._onTapStop(null,!e)},option(e,n){const{options:o}=t;return void 0===n?o[e]:o[e]=n},disable(){t._bindStartEvents("off")},destroy(){t.disable(),t._clippingElement.remove()},enable(){t._bindStartEvents("on")},select(e){const{_selected:n,_stored:o,options:a}=t,i=le(e,a.frame).filter((e=>!n.includes(e)&&!o.includes(e)));return t._selected.push(...i),t._changed.added.push(...i),i}};return t._init(),t}(e)};function we(e,t){const n={_hubID:l.uniqueID("hu"),_events:d(),_commands:p()},o=$(e),a=o[0];let i,r,u,m=!0===t,h=null,f=null,_={};const g={CONNECTED:"connected",IDLE:"idle",ERROR:"error",PROCESSING:"processing",UNKNOWN:""},w=function(e,t){const n=0,o=1,a=2,i=4,r=8,s=function(t,s){let c=n;return t<e.minX?c|=o:t>e.maxX&&(c|=a),s<e.minY?c|=i:s>e.maxY&&(c|=r),c};return function(){let[n,c,l,d]=[t.fromX,t.fromY,t.toX,t.toY],u=s(n,c),p=s(l,d);for(;;){if(!u&!p)return!0;if(u&p)break;let t,m;const h=p>u?p:u;h&r?(t=n+(l-n)*(e.maxY-c)/(d-c),m=e.maxY):h&i?(t=n+(l-n)*(e.minY-c)/(d-c),m=e.minY):h&a?(m=c+(d-c)*(e.maxX-n)/(l-n),t=e.maxX):h&o&&(m=c+(d-c)*(e.minX-n)/(l-n),t=e.minX),h===u?u=s(n=t,c=m):p=s(l=t,d=m)}return!1}()},I=function(e,t){return!(e.minX>=t.maxX||t.minX>=e.maxX)&&!(e.maxY<=t.minY||t.maxY<=e.minY)},x=function(e,t){const n=function(e,t,n,o,a,i){return(i-t)*(n-e)>(o-t)*(a-e)?1:(i-t)*(n-e)==(o-t)*(a-e)?0:-1},o=function(e,t,n,o,a,i){return e<n&&e<a&&a<n||(n<e&&n<a&&a<e||(t<o&&t<i&&i<o||(o<t&&o<i&&i<t||(e===a&&t===i||n===a&&o===i))))};return function(e,t,a,i,r,s,c,l){const d=n(e,t,a,i,c,l),u=n(e,t,a,i,r,s),p=n(e,t,r,s,c,l),m=n(a,i,r,s,c,l);let h=d!==u&&p!==m;return 0===d&&0===u&&0===p&&0===m&&(h=o(e,t,a,i,r,s)||o(e,t,a,i,c,l)||o(r,s,c,l,e,t)||o(r,s,c,l,a,i)),h}(e.fromX,e.fromY,e.toX,e.toY,t.fromX,t.fromY,t.toX,t.toY)},C=function(){const e={};let t,o=[],a={},r=!1,s=!1;const c=new Set,d=function(){for(const t of c)e.update(i.find('[data-overlap-id="'.concat(v(t),'"]')));c.clear()};function u(e){const t=$(e).attr("data-overlap-id")||"";return!!Object.prototype.hasOwnProperty.call(a,t)&&t}function p(){for(let e=o.length-1;e>=0;--e)if(!$.contains(document.documentElement,o[e].get(0))){const t=u(o[e]);if(t){for(const e of a[t].front)a[e].behind.delete(t);for(const e of a[t].behind)a[e].front.delete(t);delete a[t]}o.splice(e,1)}}return $(window).on("mousedown.".concat(n._hubID,"overlapHelper keydown.").concat(n._hubID,"overlapHelper"),(()=>{r=!0})).on("mouseup.".concat(n._hubID,"overlapHelper keyup.").concat(n._hubID,"overlapHelper"),(function(){r=!1,(s?t:r)||d()})),e.add=function(t){if(p(),!u(t)){const n=$(t),i=l.uniqueID("ol");o.push(n.attr("data-overlap-id",i)),a[i]={front:new Set,behind:new Set},e.update(n),n.attrchange({trackValues:!0,callback:function(n){"style"===n.attributeName&&e.update(t)}})}return e},e.update=function(n){const i=$(n),l=i.siblings(),d=u(n);if(d)if(s?t:r)c.add(d);else{if(p(),!Object.prototype.hasOwnProperty.call(a,d))return;const e=i.is("svg"),t=e?K(i):{minX:parseFloat(i.css("left"),10),minY:-parseFloat(i.css("top"),10)-i.height(),maxX:parseFloat(i.css("left"),10)+i.width(),maxY:-parseFloat(i.css("top"),10)};o.forEach((function(n){const o=u(n);if(!o||i.is(n)||!l.is(n))return;const r=n.is("svg"),s=r?K(n):{minX:parseFloat(n.css("left"),10),minY:-parseFloat(n.css("top"),10)-n.height(),maxX:parseFloat(n.css("left"),10)+n.width(),maxY:-parseFloat(n.css("top"),10)};let c=!1,p=!1;c=e&&r?x(t,s):e||r?r?w(t,s):w(s,t):I(t,s),p=i.css("z-index")!==n.css("z-index")?(parseInt(n.css("z-index"))||0)>(parseInt(i.css("z-index"))||0):i.nextAll().is(n),a[d].front.delete(o),a[d].behind.delete(o),a[o].front.delete(d),a[o].behind.delete(d),c&&(p?(a[d].front.add(o),a[o].behind.add(d)):(a[d].behind.add(o),a[o].front.add(d)))}))}return e},e.destroy=function(e){o=[],a={},!0===e&&$(window).off("mousedown.".concat(n._hubID,"overlapHelper keydown.").concat(n._hubID,"overlapHelper")).off("mouseup.".concat(n._hubID,"overlapHelper keyup.").concat(n._hubID,"overlapHelper"))},e.countOverlaps=function(e){p();const t=u(e);return t?a[t].front.size:0},e.interaction={force:function(e){const n=!0===e;(s?t:r)===n||n||(t=n,d()),t=n,s=!0},release:function(){s=!1,t===r||r||d()}},e}(),k={relas:[],get:function(e,t,n,o){for(let a=0;a<k.relas.length;++a)if(k.relas[a].inputCompID===e&&k.relas[a].inputParam===t&&k.relas[a].outputCompID===n&&k.relas[a].outputParam===o)return{pos:a,id:k.relas[a].id};return{pos:-1,id:""}},query:function(e){let t=-1;for(let n=0;n<k.relas.length;++n)if(k.relas[n].id===e){t=n;break}return-1===t?{id:"",inputCompID:"",inputParam:"_",outputCompID:"",outputParam:"_"}:Object.assign({},k.relas[t])},add:function(e,t,n,o){let a=k.get(e,t,n,o).id;return 0===a.length&&(a=l.uniqueID("cn"),k.relas.push({id:a,inputCompID:e,inputParam:t,outputCompID:n,outputParam:o})),a},remove:function(e,t,n,o){const a=k.get(e,t,n,o);return-1!==a.pos&&k.relas.splice(a.pos,1),a.id}},D={count:{},inc:function(e,t){return Object.prototype.hasOwnProperty.call(D.count,e)||(D.count[e]={}),Object.prototype.hasOwnProperty.call(D.count[e],t)||(D.count[e][t]=0),i.find(t).addClass(e),++D.count[e][t],D},dec:function(e,t){return Object.prototype.hasOwnProperty.call(D.count,e)&&Object.prototype.hasOwnProperty.call(D.count[e],t)?((D.count[e][t]=Math.max(0,D.count[e][t]-1))||i.find(t).removeClass(e),D):D}},P={minZIndex:0,maxZIndex:0,lastFront:"",checkpoints:{},_chainEdges:{},_addToChain:function(e){if(!e)return P;const t=function(e){Object.prototype.hasOwnProperty.call(P._chainEdges,e)||(P._chainEdges[e]={})};t(e);for(var n=arguments.length,o=new Array(n>1?n-1:0),a=1;a<n;a++)o[a-1]=arguments[a];return o.forEach((function(n){t(n),P._chainEdges[e][n]=P._chainEdges[n][e]=!0})),P},_removeFromChain:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.forEach((function(e){if(Object.prototype.hasOwnProperty.call(P._chainEdges,e)){for(const t in P._chainEdges[e])delete P._chainEdges[t][e];delete P._chainEdges[e]}})),P},_getChain:function(){const e=[],t={};for(var n=arguments.length,o=new Array(n),a=0;a<n;a++)o[a]=arguments[a];return o.forEach((function(n){if(Object.prototype.hasOwnProperty.call(t,n))return;const o=[n];for(t[n]=!0;o.length;){const n=o.shift();e.push(n);for(const e in P._chainEdges[n])Object.prototype.hasOwnProperty.call(t,e)||(o.push(e),t[e]=!0)}})),[...new Set(e)]},bringToFront:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];if(!t.length)return P;let o=1/0;t.forEach((e=>{o=Math.min(o,parseInt(i.find(".".concat(e)).css("z-index"))||0)}));const a=P.maxZIndex++-o+1;return t.forEach((e=>i.find(".".concat(e)).css("z-index",(parseInt(i.find(".".concat(e)).css("z-index"))||0)+a))),P.lastFront=t[0],P},sendToBack:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];if(!t.length)return P;let o=-1/0;t.forEach((e=>{o=Math.max(o,parseInt(i.find(".".concat(e)).css("z-index"))||0)}));const a=o-P.minZIndex--+1;return t.forEach((e=>i.find(".".concat(e)).css("z-index",(parseInt(i.find(".".concat(e)).css("z-index"))||0)-a))),P},watch:function(){for(var e=arguments.length,t=new Array(e),o=0;o<e;o++)t[o]=arguments[o];return t.forEach((function(e){const t=i.find(".".concat(e));(t.is("svg")?t.find("line"):t).off("mousedown.layerhelper").on("mousedown.layerhelper",(function(){const o=[];if(P._getChain(e).forEach((e=>o.push(e))),o.includes(P.lastFront)||!C.countOverlaps(t))return;const a=P.lastFront,r=P.minZIndex,s=P.maxZIndex,c=[],l=[],d=[],u=[];let p=$();o.forEach((function(e){const t=i.find(".".concat(e));d.push(t.css("z-index")||""),t.is("svg")?l.push(e):c.push(e),p=p.add(t)})),P.lastCheckpoint.apply(P,o),P.bringToFront.apply(P,c),t.is("svg")||P.bringToFront(e),P.bringToFront.apply(P,l),t.is("svg")&&P.bringToFront(e),o.forEach((e=>u.push(i.find(".".concat(e)).css("z-index")||"")));const m=P.lastFront,h=P.minZIndex,f=P.maxZIndex;n._commands.do({type:"graph.layering.bringtofront",caller:p,undo:function(){P.lastFront=a,P.minZIndex=r,P.maxZIndex=s,o.forEach(((e,t)=>i.find(".".concat(e)).css("z-index",d[t])))},redo:function(){o.forEach(((e,t)=>i.find(".".concat(e)).css("z-index",u[t]))),P.lastFront=m,P.minZIndex=h,P.maxZIndex=f}})}))})),P._addToChain.apply(P,t),P},startCheckpoint:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.forEach((function(e){const t=i.find(".".concat(e)),n=l.uniqueID("pt");P.checkpoints[n]=t.css("z-index")||"",t.attr("data-checkpoint",n)})),P},lastCheckpoint:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.forEach((function(e){const t=i.find(".".concat(e)),n=t.attr("data-checkpoint")||"";n&&Object.prototype.hasOwnProperty.call(P.checkpoints,n)&&(t.removeAttr("data-checkpoint").css("z-index",P.checkpoints[n]),delete P.checkpoints[n])})),P}},O=[];let S=o.is(":visible");const A={relas:{},pairs:{},search:function(e){for(const[t,n]of Object.entries(A.pairs))if(n===e){const e=t.split("+");return{inputConnector:e[0],outputConnector:e[1]}}return{inputConnector:"",outputConnector:""}},draw:function(e,t){const n=l.uniqueID("ln");let o=e.left-X(i[0]).left,a=e.top-X(i[0]).top,r=t.left-X(i[0]).left,s=t.top-X(i[0]).top;const c=Math.abs(o-r),d=Math.abs(a-s);if((r<=o&&s<=a||r>o&&s<=a)&&([o,a,r,s]=[r,s,o,a]),o<=r&&a<=s){const e=$('<svg class="'.concat(n,'" style="width: ').concat(c,"px; height: ").concat(d,"px; position: absolute; top: ").concat(a,"px; left: ").concat(o,'px" data-line-type="diagonal">\n <line x1="0" y1="0" x2="100%" y2="100%" />\n </svg>'));i.append(e)}else{const e=$('<svg class="'.concat(n,'" style="width: ').concat(c,"px; height: ").concat(d,"px; position: absolute; top: ").concat(a,"px; left: ").concat(r,'px" data-line-type="subdiagonal">\n <line x1="0" y1="100%" x2="100%" y2="0" />\n </svg>'));i.append(e)}return n},add:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;const o=t||k.query(e);if(S){const t=i.find('.map__component__body__input__item__connector:not([data-param])[data-target="'.concat(v(o.inputCompID),'"]')).add(i.find('.map__component__body__input__item__connector[data-target="'.concat(v(o.inputCompID),'"][data-param="').concat(v(o.inputParam),'"]'))),a=i.find('.map__component__body__output__item__connector:not([data-param])[data-target="'.concat(v(o.outputCompID),'"]')).add(i.find('.map__component__body__output__item__connector[data-target="'.concat(v(o.outputCompID),'"][data-param="').concat(v(o.outputParam),'"]')));t.add(a).removeClass("active");const r=t.filter(":visible"),c=a.filter(":visible"),l=r.attr("class").match(/\bcc\w+/g)[0],d=c.attr("class").match(/\bcc\w+/g)[0];D.inc("chosen",".map__component__body__input__item__connector.".concat(l)),D.inc("chosen",".map__component__body__output__item__connector.".concat(d));const u=[l,d].join("+");let p="";if(Object.prototype.hasOwnProperty.call(A.pairs,u)){const t=i.find(".".concat(p=A.pairs[u]));t.attr("data-connection",(t.attr("data-connection")||"").split(",").concat([e]).join(","))}else{const t=i.find(".".concat(p=A.draw({left:X(r[0]).left+r.width()/2,top:X(r[0]).top+r.height()/2},{left:X(c[0]).left+c.width()/2,top:X(c[0]).top+c.height()/2})));P.bringToFront(p),P.watch(p,r.closest(".map__component").attr("class").match(/\bhc\w+/g)[0],c.closest(".map__component").attr("class").match(/\bhc\w+/g)[0]),t.find("line").on({mouseenter:function(){$(this).parent().add(r).add(c).addClass("hover")},mouseleave:function(){$(this).parent().add(r).add(c).removeClass("hover")}}),t.attr("data-connection",e),A.pairs[u]=p,C.add(t)}return s.set("Hub[".concat(n._hubID,"]:ActiveInput'").concat(e,"'"),!0),[o.inputCompID,o.outputCompID].forEach((function(t){Object.prototype.hasOwnProperty.call(A.relas,t)&&Array.isArray(A.relas[t])||(A.relas[t]=[]);let n=!1;for(let o=0;o<A.relas[t].length;++o)A.relas[t][o].connectionID===e&&(n=!0,A.relas[t][o].svgID=p);n||A.relas[t].push({connectionID:e,svgID:p})})),p}{let t=!1;for(let n=O.length-1;n>=0;--n)if(e===O[n].args[0]){t=!0,"remove"===O[n].calling&&O.splice(n,1);break}return t||O.push({calling:"add",args:[e,o]}),""}},remove:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;const o=t||k.query(e);if(S){if(s.pop("Hub[".concat(n._hubID,"]:ActiveInput'").concat(e,"'"))){[o.inputCompID,o.outputCompID].forEach((function(t){A.relas[t].forEach((function(t){if(t.connectionID===e){i.find(".".concat(t.svgID)).remove(),P._removeFromChain(t.svgID);for(const[e,n]of Object.entries(A.pairs))if(n===t.svgID){delete A.pairs[e];break}}}))})),A.relas[o.inputCompID]=A.relas[o.inputCompID].filter((t=>t.connectionID!==e)),A.relas[o.outputCompID]=A.relas[o.outputCompID].filter((t=>t.connectionID!==e));const t=i.find('.map__component__body__input__item__connector:not([data-param])[data-target="'.concat(v(o.inputCompID),'"]')).add(i.find('.map__component__body__input__item__connector[data-target="'.concat(v(o.inputCompID),'"][data-param="').concat(v(o.inputParam),'"]'))),n=i.find('.map__component__body__output__item__connector:not([data-param])[data-target="'.concat(v(o.outputCompID),'"]')).add(i.find('.map__component__body__output__item__connector[data-target="'.concat(v(o.outputCompID),'"][data-param="').concat(v(o.outputParam),'"]'))),a=t.filter(":visible"),r=n.filter(":visible");try{D.dec("chosen",".map__component__body__input__item__connector.".concat(a.attr("class").match(/\bcc\w+/g)[0]))}catch(e){}try{D.dec("chosen",".map__component__body__output__item__connector.".concat(r.attr("class").match(/\bcc\w+/g)[0]))}catch(e){}}}else{let t=!1;for(let n=O.length-1;n>=0;--n)if(e===O[n].args[0]){t=!0,"add"===O[n].calling&&O.splice(n,1);break}t||O.push({calling:"remove",args:[e,o]})}return A},has:function(e){return s.get("Hub[".concat(n._hubID,"]:ActiveInput'").concat(e,"'"))},update:function(e,t,n){if(t=!1!==t,n=!1!==n,!Object.prototype.hasOwnProperty.call(A.relas,e)||!Array.isArray(A.relas[e]))return A;const o=[];return[...A.relas[e]].forEach((function(e){t&&A.remove(e.connectionID),n&&o.push(A.add(e.connectionID))})),P.bringToFront.apply(P,o),A},updateAll:function(){for(const e in A.relas)A.update(e);return A},hide:function(e){return Object.prototype.hasOwnProperty.call(A.relas,e)&&Array.isArray(A.relas[e])?(A.relas[e].forEach((function(e){i.find(".".concat(e.svgID)).hide()})),A):A},moving:function(e){let t="";const n=$(e),a=X(n[0]).left+n.width()/2,r=X(n[0]).top+n.height()/2,s=function(e){t.length&&i.find(".".concat(t)).remove();const n=X(i[0]),o=Y(i[0]);i.find(".".concat(t=A.draw({left:a,top:r},{left:(e.pageX-o.translateX-n.left)/o.scaleX+n.left,top:(e.pageY-o.translateY-n.top)/o.scaleY+n.top}))).addClass("moving")};return o.on("mousemove",s).on("mousedown",(function(){t.length&&i.find(".".concat(t)).remove(),o.off("mousemove",s)})),A}};setTimeout((function e(){const t=o.is(":visible");if(S!==t&&(S=t,S))for(;O.length;){const e=O[0];O.splice(0,1),A[e.calling].apply(A,e.args)}setTimeout(e,l.duration.immediate)}),l.duration.immediate);const M=c();let z=[];const E=function(e){const t=$(e);if(!t.hasClass("selected")&&(t.addClass("selected"),t.is("svg"))){const e=t.attr("class").match(/\bln\w+/g)[0],n=A.search(e);D.inc("selected",".map__component__body__input__item__connector.".concat(n.inputConnector)),D.inc("selected",".map__component__body__output__item__connector.".concat(n.outputConnector)),P.startCheckpoint(e),P.bringToFront(e)}},j=function(e){const t=$(e);if(t.hasClass("selected")&&(t.removeClass("selected"),t.is("svg"))){const e=t.attr("class").match(/\bln\w+/g)[0],n=A.search(e);D.dec("selected",".map__component__body__input__item__connector.".concat(n.inputConnector)),D.dec("selected",".map__component__body__output__item__connector.".concat(n.outputConnector)),P.lastCheckpoint(e)}},T=()=>{u.cancel(),u.clearSelection();for(const e of z)u.select(e),E(e);u.keepSelection()};n.instance=function(e){return e?o:a},n.init=function(){o.addClass(n._hubID).html('<div class="map">\n <div class="map__panzoom"></div>\n <div class="map__coordinates">\n <div class="map__coordinates__item">x: <span class="x">N/A</span></div>\n <div class="map__coordinates__item">y: <span class="y">N/A</span></div>\n <div class="map__coordinates__item">s: <span class="s">N/A</span></div>\n </div>\n </div>'),i=o.find(".map__panzoom"),u=be.create({class:"map__selection",selectables:[".".concat(n._hubID," .map__panzoom svg"),".".concat(n._hubID," .map__panzoom .map__component")],boundaries:[".".concat(n._hubID," .map")],startareas:[".".concat(n._hubID," .map")],selectionAreaContainer:".".concat(n._hubID," .map"),mode:function(e,t){const n=Y(i[0]),o=X(i[0]),a={maxY:-1*(e.top-o.top-n.translateY)/n.scaleY,minX:1*(e.left-o.left-n.translateX)/n.scaleX,minY:-1*(e.bottom-o.top-n.translateY)/n.scaleY,maxX:1*(e.right-o.left-n.translateX)/n.scaleX},r=$(t),s=r.position();return r.is("svg")?w(a,K(t)):I(a,{minX:1*s.left/n.scaleX,maxY:-1*s.top/n.scaleY,maxX:1*s.left/n.scaleX+r.outerWidth(!0),minY:-1*s.top/n.scaleY-r.outerHeight(!0)})}}).on("beforestart",(e=>{let{oe:t,inst:n,selected:o}=e;const a=$.event.fix(t);if(3===a.which)return!1;const i=$(a.target),r=n.option("selectables").reduce(((e,t)=>e||i.closest(t).length),!1);if(!a.ctrlKey){for(const e of o)j(e),n.removeFromSelection(e);n.clearSelection()}return!i.closest(".map__component__body__input__item, .map__component__body__output__item").length&&(r||i.hasClass("map")||i.hasClass("map__panzoom"))})).on("move",(e=>{let{oe:t,inst:n,changed:{removed:o,added:a}}=e;$(t.target).closest(".move").length&&n.cancel();for(const e of a)E(e);for(const e of o)j(e)})).on("stop",(e=>{let{inst:t}=e;t.keepSelection()})),$(window).on("blur.".concat(n._hubID),(()=>u.cancel()));const e=te(".".concat(n._hubID," .map"),{id:"main",align:"vertical",menus:[{name:"Select all",id:"all",type:"click",key:"Ctrl+A"},{name:"Detach",id:"detach",type:"click",key:"Ctrl+Shift+D"},{},{name:"Reset pan/zoom",id:"reset",type:"click",disabled:!0}]}).init(),t=e.menu.getMenuItemsById("detach");let a;return e.menu._events.on("all",(()=>{const e=be.utils.selectAll(u.option("selectables"));u.select(u.option("selectables")),u.keepSelection(),e.forEach((e=>E(e)))})).on("detach",(()=>{const e=u.getSelection();e.length&&$.confirm($.extend({},l.confirmConfiguration,{content:"This will detach all selected connections permanently. Are you sure?",buttons:{confirm:function(){e.forEach((function(e){j(e);const t=k.query($(e).attr("data-connection"));n.removeConnection(t.inputCompID,t.inputParam,t.outputCompID,t.outputParam)})),u.clearSelection()},cancel:()=>{}}}))})).on("reset",(e=>{s.set("Hub[".concat(n._hubID,"]:ResetZoomInterrupted"),!1);!function t(){if(!e.menuItem.isDisabled()&&!s.get("Hub[".concat(n._hubID,"]:ResetZoomInterrupted"))){const e=Y(i[0]);b(e.scaleX,1)?r.smoothMoveTo(0,0):r.smoothZoomAbs(-e.translateX/(e.scaleX-1),-e.translateY/(e.scaleX-1),1),G(h,f),setTimeout(t,400)}}()})).on("_show",(()=>{u.getSelection().length?t.enable():t.disable()})),r=panzoom(i[0],{beforeMouseDown:function(e){return!e.shiftKey},filterKey:function(){return!0},smoothScroll:!1,bounds:!0,boundsPadding:0,zoomDoubleClickSpeed:1,disableTouch:!0}).on("panstart",(function(){i.closest(".map").addClass("move"),i.find(".map__component, .map__component *").addClass("persist")})).on("panend",(function(){i.closest(".map").removeClass("move"),i.find(".map__component, .map__component *").removeClass("persist")})).on("transform",(function(){const t=Y(i[0]);b(t.scaleX,1)&&b(t.scaleY,1)&&b(t.translateX,0)&&b(t.translateY,0)?e.menu.getMenuItemsById("reset").disable():(e.menu.getMenuItemsById("reset").enable(),s.set("Hub[".concat(n._hubID,"]:ResetZoomInterrupted"),!0)),G(h,f)})),$(document).on("keydown.".concat(n._hubID),(e=>{S&&(e.originalEvent.repeat||16!==e.which||a||(e.stopImmediatePropagation(),a=$.toast($.extend({},l.toastConfiguration,{heading:"Panning with Shift key",text:"While Shift key is pressed, double click to pan.",allowToastClose:!1,hideAfter:!1}))))})).on("keyup.".concat(n._hubID," blur.").concat(n._hubID),(e=>{S&&("keyup"===e.type&&16===e.which||"blur"===e.type)&&a&&(e.stopImmediatePropagation(),a.update({allowToastClose:!0}),a.close(),a=null)})),o.on("mouseenter mousemove",(e=>{G(e.pageX,e.pageY)})).on("mouseleave",(()=>{G(null,null)})),_={},M.clear(),k.relas.splice(0),D.count={},P.minZIndex=P.maxZIndex=0,P.checkpoints={},P._chainEdges={},O.splice(0),A.relas={},A.pairs={},C.destroy(),n._events.call("init",n),n},n.init(),n.destroy=function(){n.init(),o.remove(),C.destroy(!0),$(window).off(".".concat(n._hubID)),s.keys("^Hub\\[".concat(n._hubID,"\\]")).forEach((e=>s.remove(e))),n._commands.clear(),l.destroyObj(n)},n.hasComp=function(e){return Object.prototype.hasOwnProperty.call(_,e)},n.compList=function(){const e=[];for(const t in _)e.push(t);return e},n.compOptions=function(e){if(!n.hasComp(e))return{};const t=[];for(const n in _[e].input)t.push({limit:_[e].limit[n],name:n,required:_[e].required[n],type:_[e].inputType[n]});const o=[];for(const t in _[e].output)o.push({name:t,type:_[e].outputType[t]});return{component:_[e].component,input:t,output:o,listener:_[e].listener,autoUpdatable:_[e].autoUpdatable,minimized:_[e].minimized,hID:_[e].hID}},n.connections=function(){const e=[];return k.relas.forEach((t=>e.push({inputCompID:t.inputCompID,inputParam:t.inputParam,outputCompID:t.outputCompID,outputParam:t.outputParam}))),e};let q=!1;function R(e){let t=0;for(const n in _[e].required)_[e].input[n].length||(_[e].component.compInstance(!0).find('.component__hub__traffic__itembox[data-type="input"][data-param="'.concat(v(n),'"]')).html('<em class="required">Required</em>'),++t);return!!t&&(F(e,g.ERROR,"Missing ".concat(t," parameter").concat(t>1?"s":"",". Result of the last successful run (if any) is preserved.")),!0)}function F(e,t,n){if(_[e].flag=t,_[e].message=n,_[e].component.options().silent)return;const o=_[e].component.compInstance(!0).find(".component__hub");for(const[,e]of Object.entries(g))e!==t?o.removeClass(e):o.addClass(e);o.find(".component__hub__traffic__message").html(n)}n.removeConnection=function(e,t,o,a){if(!n.hasComp(e)||!n.hasComp(o))return n;"string"!=typeof t&&(t="_"),"string"!=typeof a&&(a="_");const i=k.get(e,t,o,a);if(-1===i.pos)return n;_[e].level=0;for(const[n,i]of Object.entries(_[e].input)){if(n!==t){i.forEach((function(t){_[e].level=Math.max(_[e].level,_[t.id].level+1)}));continue}let r=-1;i.forEach((function(n,i){if(n.id!==o||n.param!==a)_[e].level=Math.max(_[e].level,_[n.id].level+1);else{for(let n=0;n<_[o].output[a].length;++n)if(_[o].output[a][n].id===e&&_[o].output[a][n].param===t){_[o].output[a].splice(n,1);break}r=i}})),r>-1&&_[e].input[n].splice(r,1)}A.remove(i.id);let r=$();return _[e].component.options().silent||(r=r.add(_[e].component.compInstance(!0))),_[o].component.options().silent||(r=r.add(_[o].component.compInstance(!0))),r.find('.component__hub__traffic__itembox__item[data-connection="'.concat(v(i.id),'"]')).remove(),r.each((function(e,t){const n=$(t);n.children().length<1&&n.html("<em>None</em>")})),k.relas.splice(i.pos,1),q||Z(e),n._events.call("removeConnection",n,{inputCompID:e,inputParam:t,outputCompID:o,outputParam:a}),n},n.removeInputProviders=function(e,t){if(W(),n.hasComp(e))for(;_[e].input[t].length;)n.removeConnection(e,t,_[e].input[t][0].id,_[e].input[t][0].param);return L(),n},n.removeAllInputProviders=function(e){if(W(),n.hasComp(e))for(const t in _[e].input)n.removeInputProviders(e,t);return L(),n},n.addConnection=function(e,t,o,a){if("string"!=typeof t&&(t="_"),"string"!=typeof a&&(a="_"),!(n.hasComp(e)&&n.hasParam(e,t,"input")&&n.hasComp(o)&&n.hasParam(o,a,"output")))return n;if(_[e].limit[t]&&_[e].input[t].length>=_[e].limit[t])return $.alert($.extend({},l.alertConfiguration,{title:"Input Provider Limit Reached",content:"The input parameter <strong>".concat(y(t),"</strong> has reached its limit of connections.")})),n;const i=_[e].inputType[t],r=_[o].outputType[a];if(m&&i!==r&&"_"!==i&&"_"!==r)return F(e,g.ERROR,"Connection is denied."),F(o,g.ERROR,"Connection is denied."),$.alert($.extend({},l.alertConfiguration,{title:"Strict Mode",content:"Unable to make the connection: Type <strong>".concat(y(r),"</strong> to Type <strong>").concat(y(i),"</strong>."),onClose:function(){N(e),N(o)}})),n;if(k.get(e,t,o,a).id.length||function(e,t){if(_[e].level>_[t].level)return!1;const n=function e(t,n){if(_[t].level===_[n].level)return t===n;let o=!1;for(const[,a]of Object.entries(_[t].output))a.forEach((t=>{o|=e(t.id,n)}));return o}(e,t);n&&(F(e,g.ERROR,"Connection is denied."),F(t,g.ERROR,"Connection is denied."),$.alert($.extend({},l.alertConfiguration,{title:"Loop detected",content:"Cannot establish the required connection.",onClose:function(){N(e),N(t)}})));return n}(e,o))return n;q=!0,n.removeConnection(e,t,o,a),q=!1;const s=!_[e].input[t].length,c=!_[o].output[a].length;_[o].output[a].push({id:e,param:t}),_[e].input[t].push({id:o,param:a}),_[e].level=Math.max(_[e].level,_[o].level+1);const d=k.add(e,t,o,a);if(A.add(d),!_[e].component.options().silent){const n=_[e].component.compInstance(!0).find('.component__hub__traffic__itembox[data-type="input"][data-param="'.concat(v(t),'"]'));s&&n.html("");const i=_[o].outputType[a];n.append($('<div class="component__hub__traffic__itembox__item" data-connection="'.concat(v(d),'">\n <div class="component__hub__traffic__itembox__item__param">').concat(i!==a?'<span class="paramtype">'.concat(y(i),".</span>"):"").concat(y("_"===a?"Any":a),'</div>\n <div class="component__hub__traffic__itembox__item__name" data-name-dependency="').concat(v(o),'">').concat(y(_[o].component.options().name),"</div>\n </div>")))}if(!_[o].component.options().silent){const n=_[o].component.compInstance(!0).find('.component__hub__traffic__itembox[data-type="output"][data-param="'.concat(v(a),'"]'));c&&n.html("");const i=_[e].inputType[t];n.append($('<div class="component__hub__traffic__itembox__item" data-connection="'.concat(v(d),'">\n <div class="component__hub__traffic__itembox__item__param">').concat(i!==t?'<span class="paramtype">'.concat(y(i),".</span>"):"").concat(y("_"===t?"Any":t),'</div>\n <div class="component__hub__traffic__itembox__item__name" data-name-dependency="').concat(v(e),'">').concat(y(_[e].component.options().name),"</div>\n </div>")))}return Z(e),n._events.call("addConnection",n,{inputCompID:e,inputParam:t,outputCompID:o,outputParam:a}),n},n.add=function(e,t){if(!e.component)return n;const a=e.component._compID;if(n.hasComp(a))return n;_[a]={component:e.component,limit:{},inputType:{},outputType:{},input:{},required:{},output:{},autoUpdatable:!0,level:0,flag:g.UNKNOWN,message:"",minimized:!1,listener:function(){},hID:l.uniqueID("hc")};const r=_[a].component.options();!1!==e.autoUpdatable||e.component.options().silent||(_[a].autoUpdatable=!1),$.isFunction(e.listener)&&(_[a].listener=e.listener,n._events.on("".concat(a,".ontrigger"),e.listener)),_[a].component._events.on("triggered",(function(){if(R(a))return;!function(e){F(e,g.PROCESSING,"Component is being updated.")}(a);const e=U(a,!0).addClass("processing"),t={};for(const[e,o]of Object.entries(_[a].input))Object.prototype.hasOwnProperty.call(t,e)||(t[e]=[]),"_"===e?o.forEach((function(o){s.keys("^Hub\\[".concat(n._hubID,"\\]:").concat(o.id,"_")).forEach((function(n){t[e].push({param:n.slice(n.indexOf("_")+1),value:s.get(n)})}))})):o.forEach((function(o){t[e].push({param:o.param,value:s.get("Hub[".concat(n._hubID,"]:").concat(o.id,"_").concat(o.param))})}));n._events.invoke("".concat(this._compID,".ontrigger"),this,t).then((e=>{var t;null===(t=_[a])||void 0===t||t.component._events.call("outputchange",_[a].component,e[0]||{})})).catch((e=>{n.hasComp(a)&&F(a,g.ERROR,e instanceof Error?e.message:e)})).finally((()=>{e.removeClass("processing")}))})).on("outputchange",(function(e){const t={};for(const[o,i]of Object.entries(_[a].output)){const r="Hub[".concat(n._hubID,"]:").concat(a,"_").concat(o);Object.prototype.hasOwnProperty.call(e,o)&&s.get(r)!==e[o]&&(s.set(r,e[o]),i.forEach((function(e){t[e.id]=!0})))}N(a);for(const e in t)Z(e)})).on("component.levelchanged",(function(e){let t=[];for(const[,e]of Object.entries(_[a].output))t=t.concat(e);[...new Set(t)].forEach((function(t){_[t].component.trigger("levelchanged",e)}))})).on("afterinit",(function(){_[a].component.trigger()})).on("afterduplicate",(function(e){n.add({...n.compOptions(a),component:e,listener:t=>e.api.call("newinput",t)})})),_[a].component._events.on("beforedestroy",(function(){n.remove(this._compID)}));{const c=()=>{let e=$();for(const t of z){const n=$(t);n.hasClass("map__component")&&(e=e.add(n))}return e},d=$('<div class="map__component '.concat(_[a].hID,'" data-component-id="').concat(a,'">\n <div class="map__component__title">').concat(y(r.name),'</div>\n <div class="map__component__body" style="background: ').concat(r.background,"; color: ").concat(r.color,';">\n <div class="map__component__body__input">\n <div class="map__component__body__input__header">Input</div>\n <div class="map__component__body__input__item none">\n <div class="map__component__body__input__item__param"><em>None</em></div>\n </div>\n </div>\n <div class="map__component__body__input minimized">\n <div class="map__component__body__input__item">\n <div class="map__component__body__input__item__param"><strong>Input</strong></div>\n </div>\n </div>\n <div class="map__component__body__output">\n <div class="map__component__body__output__header">Output</div>\n <div class="map__component__body__output__item none">\n <div class="map__component__body__output__item__param"><em>None</em></div>\n </div>\n </div>\n <div class="map__component__body__output minimized">\n <div class="map__component__body__output__item">\n <div class="map__component__body__output__item__param"><strong>Output</strong></div>\n </div>\n </div>\n </div>\n </div>')).on("mousedown",(function(e){3!==e.which&&(z=[],[...u.getSelection()].forEach((e=>{"svg"!==e.tagName&&z.push(e)})),-1===$.inArray(this,z)&&(z=[this]))})).draggable().on("dragstart",(function(){T(),C.interaction.force(!0),c().each((function(){const e=$(this),t=e.attr("data-component-id");s.set("Hub[".concat(n._hubID,"]:Component[").concat(_[t].hID,"]_DraggableStartPosition"),{top:parseFloat(e.css("top")),left:parseFloat(e.css("left"))},!0),A.hide(t)}))})).on("dragstop",(function(){u.keepSelection();const e=[],t=[],o=c().each((function(){const o=$(this),a=o.attr("data-component-id");A.update(a);const i=s.get("Hub[".concat(n._hubID,"]:Component[").concat(_[a].hID,"]_DraggableStartPosition")),r={...o.position()};e.push((function(){try{o.css({top:i.top,left:i.left}),A.update(a)}catch(e){}})),t.push((function(){try{o.css({top:r.top,left:r.left}),A.update(a)}catch(e){}}))})).toArray();n._commands.do({type:"graph.component.drag",caller:()=>o.reduce(((e,t)=>e||$.contains(document.documentElement,t)),!1),undo:function(){e.forEach((e=>e()))},redo:function(){t.forEach((e=>e()))}}),C.interaction.release()})).on("drag",(function(e,t){const o=s.get("Hub[".concat(n._hubID,"]:Component[").concat(_[a].hID,"]_DraggableStartPosition"));if(t.helper.hasClass("persist"))t.position.top=o.top,t.position.left=o.left;else{const e=Y(i[0]),r=t.position.top/e.scaleY,l=t.position.left/e.scaleX,d=r-o.top,u=l-o.left;t.position.top=r,t.position.left=l,c().each((function(){const e=$(this),t=e.attr("data-component-id");if(a===t)return;const o=s.get("Hub[".concat(n._hubID,"]:Component[").concat(_[t].hID,"]_DraggableStartPosition"));e.css("top",o.top+d),e.css("left",o.left+u)}))}})).resizable({handles:"se",minWidth:-1e6,minHeight:-1e6}).on("resize",(function(e,t){t.element.css("height","auto");const o=s.get("Hub[".concat(n._hubID,"]:Component[").concat(_[a].hID,"]_ResizableStartWidth")),r=Y(i[0]),l=t.size.width-t.originalSize.width,d=t.originalSize.width+l/r.scaleX,u=(t.size.width=Math.max(d,t.element[0].scrollWidth))-o;c().each((function(){const e=$(this),t=e.attr("data-component-id");if(a===t)return;const o=s.get("Hub[".concat(n._hubID,"]:Component[").concat(_[t].hID,"]_ResizableStartWidth"));e.css("width",0),e.css("width",Math.max(o+u,this.scrollWidth))}))})).on("resizestart",(function(){T(),C.interaction.force(!0),c().each((function(){const e=$(this),t=e.attr("data-component-id");s.set("Hub[".concat(n._hubID,"]:Component[").concat(_[t].hID,"]_ResizableStartWidth"),parseFloat(e.css("width")||e.width())),A.hide(t)}))})).on("resizestop",(function(){u.keepSelection();const e=[],t=[],o=c().each((function(){const o=$(this),a=o.attr("data-component-id");A.update(a);const i=s.get("Hub[".concat(n._hubID,"]:Component[").concat(_[a].hID,"]_ResizableStartWidth")),r=o.css("width");e.push((function(){try{o.css("width",i),A.update(a)}catch(e){}})),t.push((function(){try{o.css("width",r),A.update(a)}catch(e){}}))})).toArray();n._commands.do({type:"graph.component.resize",caller:()=>o.reduce(((e,t)=>e||$.contains(document.documentElement,t)),!1),undo:function(){e.forEach((e=>e()))},redo:function(){t.forEach((e=>e()))}}),C.interaction.release()})).bindIframeFixEvents("drag resize");d.on("mousedown",(function(e){$(e.target).closest(".map__component__body__input__item, .map__component__body__output__item").hasClass("none")?d.draggable("enable"):d.draggable("disable")})).on("mouseup",(function(){d.draggable("enable")})).on("click",".map__component__body__input__item, .map__component__body__output__item",(function(){const e=$(this);if(e.hasClass("none"))return;const t=e.hasClass("map__component__body__input__item")?"input":"output",a=e.find(".map__component__body__".concat(t,"__item__connector")),r=a.attr("data-target"),c=a.attr("data-param");if(!t||!r||!c||"input"!==t&&"output"!==t)return;a.addClass("active");const l=s.get("Hub[".concat(n._hubID,"]:ActiveConnector"));if(l&&l.type&&l.target&&l.param){if(s.remove("Hub[".concat(n._hubID,"]:ActiveConnector")),i.find(".map__component__body__input__item__connector, .map__component__body__output__item__connector").removeClass("active"),"input"!==l.type&&"output"!==l.type)return;let e={type:t,target:r,param:c},a={type:l.type,target:l.target,param:l.param};"input"===a.type&&([e,a]=[a,e]),k.get(e.target,e.param,a.target,a.param).id.length?(n.removeConnection(e.target,e.param,a.target,a.param),n._commands.do({type:"graph.component.removeConnection",caller:o,reservedIDs:["ol","cn","pt","ln"],undo:function(){n.addConnection(e.target,e.param,a.target,a.param)},redo:function(){n.removeConnection(e.target,e.param,a.target,a.param)}})):(n.addConnection(e.target,e.param,a.target,a.param),n._commands.do({type:"graph.component.addConnection",caller:o,reservedIDs:["ol","cn","pt","ln"],undo:function(){n.removeConnection(e.target,e.param,a.target,a.param)},redo:function(){n.addConnection(e.target,e.param,a.target,a.param)}}))}else A.moving(a),s.set("Hub[".concat(n._hubID,"]:ActiveConnector"),{type:t,target:r,param:c})})),$(window).on("mousedown.".concat(n._hubID),(function(e){const t=$(e.target);t.closest(".map__component__body__input__item").length||t.closest(".map__component__body__output__item").length||(s.remove("Hub[".concat(n._hubID,"]:ActiveConnector")),i.find(".map__component__body__input__item__connector, .map__component__body__output__item__connector").removeClass("active"))})),_[a].component._events.on("afterrename",(function(e){d.find(".map__component__title").text(e)})).on("backgroundchange",(function(e,t){d.find(".map__component__body").css({background:e,color:t})})),d.on("dblclick",(function(e){$(e.target).closest(".map__component__body").length||(n.toggle(a),n._commands.do({type:"graph.component.toggle",caller:d,undo:()=>n.toggle(a),redo:()=>n.toggle(a)}))})),r.primary&&d.addClass("primary"),i.append(d),P.bringToFront(_[a].hID),P.watch(_[a].hID),M.watch(d,"MapComponent"),t&&(t=$.extend({top:0,left:0},t),d.css({top:parseFloat(t.top)||0,left:parseFloat(t.left)||0}));const p=te(".".concat(_[a].hID),{id:"main",align:"vertical",menus:[{name:"To Workspace...",id:"toworkspace",type:"click"},{},{name:"Color",id:"color",type:"click"},{name:"Rename",id:"rename",type:"click"},{name:"Duplicate",id:"duplicate",type:"click"}].concat(r.primary?[]:[{},{name:"Delete",id:"remove",type:"click"}])}).init();p.menu._events.on("_show",(()=>{for(const e of u.getSelection())j(e);u.clearSelection(),u.select(d[0]),u.keepSelection(),E(d)})).on("toworkspace",(()=>{n._events.call("toworkspace",_[a].component)})).on("rename",(()=>{l.launchInputBox("Rename Component",_[a].component.options().name,"Type new name here",(e=>{_[a].component.rename(e)}))})).on("duplicate",(()=>{M.impose(d,"MapComponent"),_[a].component.duplicate()})).on("remove",(()=>{_[a].component.destroy()})).on("color",(e=>{let{dontCloseAllMenus:t}=e;return t()})),p.menu.getMenuItemsById("color").$.spectrum({...l.spectrumConfiguration,color:r.background,show:function(){p.menu.mainMenu.hide()},move:function(e){_[a].component.background(e.toHexString())},change:function(e){_[a].component.background(e.toHexString())}}),!0===e.minimized&&n.minimize(a),C.add(d)}return"array"===$.type(e.input)&&e.input.forEach((function(e){n.addParam(a,e.name,{limit:e.limit,paramType:"input",required:e.required,type:e.type})})),"array"===$.type(e.output)&&e.output.forEach((function(e){n.addParam(a,e.name,{paramType:"output",type:e.type})})),n.refreshHubUtilities(a),_[a].component._events.on("hub.parameter.input.add",((e,t)=>{if(n.hasParam(a,e,"input"))return!1;try{return n.addParam(a,e,{...t,paramType:"input"}),!0}catch(e){return!1}})).on("hub.parameter.input.has",(e=>n.hasParam(a,e,"input"))).on("hub.parameter.input.remove",(e=>{if(!n.hasParam(a,e,"input"))return!1;try{return n.removeParam(a,e,"input"),!0}catch(e){return!1}})).on("hub.parameter.output.add",((e,t)=>{if(n.hasParam(a,e,"output"))return!1;try{return n.addParam(a,e,{...t,paramType:"output"}),!0}catch(e){return!1}})).on("hub.parameter.output.has",(e=>n.hasParam(a,e,"output"))).on("hub.parameter.output.remove",(e=>{if(!n.hasParam(a,e,"output"))return!1;try{return n.removeParam(a,e,"output"),!0}catch(e){return!1}})).on("hub.parameter.all",(()=>n.getAllParams(a))),n._events.call("add",n),n},n.hasParam=function(e,t){let o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"input";return"input"!==o&&"output"!==o&&(o="input"),n.hasComp(e)&&Object.prototype.hasOwnProperty.call("input"===o?_[e].input:_[e].output,t)},n.addParam=function(e,t){let o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(o=$.extend({limit:0,paramType:"input",required:!1,type:t},o),o.limit=Math.max(0,parseInt(o.limit)),o.type="_"===t?"_":o.type||t,"input"!==o.paramType&&"output"!==o.paramType&&(o.paramType="input"),!n.hasComp(e)||n.hasParam(e,t,o.paramType))return n;const a="input"===o.paramType?"Input":"Output",r=i.find(".".concat(_[e].hID)),s=r.find(".map__component__body__".concat(o.paramType,":not(.minimized)")),c=r.find(".map__component__body__".concat(o.paramType,".minimized"));let d=y(t);const u=o.type;d="_"===d?"Any":d;const p=$('<div class="map__component__body__'.concat(o.paramType,'__item">\n <div class="map__component__body__').concat(o.paramType,'__item__param">').concat(u!==t?'<span class="paramtype">'.concat(y(u),".</span>"):"").concat(d).concat(o.required?"<strong>*</strong>":"").concat(o.limit?" (".concat(o.limit,")"):"",'</div>\n <div class="map__component__body__').concat(o.paramType,"__item__connector ").concat(l.uniqueID("cc"),'" data-target="').concat(e,'" data-param="').concat(v(t),'"></div>\n </div>'));return Object.keys("input"===o.paramType?_[e].input:_[e].output).length||(s.html('<div class="map__component__body__'.concat(o.paramType,'__header">').concat(a,"</div>")),c.html('<div class="map__component__body__'.concat(o.paramType,'__item">\n <div class="map__component__body__').concat(o.paramType,'__item__param"><strong>').concat(a,'</strong></div>\n <div class="map__component__body__').concat(o.paramType,"__item__connector ").concat(l.uniqueID("cc"),'" data-target="').concat(e,'"></div>\n </div>'))),s.append(p),"input"===o.paramType?(_[e].input[t]=[],_[e].inputType[t]=o.type,_[e].required[t]=!!o.required,_[e].limit[t]=o.limit):(_[e].output[t]=[],_[e].outputType[t]=o.type),n.refreshHubUtilities(e),n},n.removeParam=function(e,t){let o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"input";if("input"!==o&&"output"!==o&&(o="input"),!n.hasParam(e,t,o))return n;if("input"===o)n.removeInputProviders(e,t),delete _[e].input[t],delete _[e].inputType[t],delete _[e].required[t],delete _[e].limit[t];else{for(;_[e].output[t].length;){const o=_[e].output[t][0];n.removeConnection(o.id,o.param,e,t)}delete _[e].output[t],delete _[e].outputType[t]}const a="input"===o?"Input":"Output",r=i.find(".".concat(_[e].hID)),s=r.find(".map__component__body__".concat(o,":not(.minimized)")),c=r.find(".map__component__body__".concat(o,".minimized"));return Object.keys("input"===o?_[e].input:_[e].output).length?s.find(".map__component__body__".concat(o,'__item__connector[data-target="').concat(v(e),'"][data-param="').concat(v(t),'"]')).parent().remove():(s.html('<div class="map__component__body__'.concat(o,'__header">').concat(a,'</div>\n <div class="map__component__body__').concat(o,'__item none">\n <div class="map__component__body__').concat(o,'__item__param"><em>None</em></div>\n </div>')),c.html('<div class="map__component__body__'.concat(o,'__item">\n <div class="map__component__body__').concat(o,'__item__param"><strong>').concat(a,"</strong></div>\n </div>"))),n.refreshHubUtilities(e),n},n.getAllParams=function(e){if(!n.hasComp(e))return[];const t=[];for(const n in _[e].input)t.push({limit:_[e].limit[n],name:n,paramType:"input",required:_[e].required[n],type:_[e].inputType[n]});for(const n in _[e].output)t.push({name:n,paramType:"output",type:_[e].outputType[n]});return t},n.refreshHubUtilities=function(e){if(!n.hasComp(e)||_[e].component.options().silent)return n;const t=_[e].component.compInstance(!0);t.find(".component__hub").length||n.ensureHubUtilities(e);let o="";for(const t in _[e].input){let n=y(t);const a=_[e].inputType[t];n="_"===n?"Any":n,o+='<tr>\n <td style="text-align: center;">'.concat(a!==t?'<span class="paramtype">'.concat(y(a),".</span>"):"").concat(n).concat(_[e].required[t]?"<strong>*</strong>":"",'</td>\n <td>\n <div class="component__hub__traffic__itembox" data-type="input" data-param="').concat(v(t),'"><em>None</em></div>\n </td>\n </tr>')}o.length||(o='<tr>\n <td style="text-align: center;" colspan="2">No input</td>\n <td style="display: none;"></td>\n </tr>');let a="";for(const t in _[e].output){let n=y(t);const o=_[e].outputType[t];n="_"===n?"Any":n,a+='<tr style="background: #eee;">\n <td style="text-align: center;">'.concat(o!==t?'<span class="paramtype">'.concat(y(o),".</span>"):"").concat(n,'</td>\n <td>\n <div class="component__hub__traffic__itembox" data-type="output" data-param="').concat(v(t),'"><em>None</em></div>\n </td>\n </tr>')}return a.length||(a='<tr style="background: #eee;">\n <td style="text-align: center;" colspan="2">No output</td>\n <td style="display: none;"></td>\n </tr>'),t.find('tbody[data-hub-utilities-of="'.concat(v(e),'"]')).html(o+a),N(e),n},n.ensureHubUtilities=function(e){if(!n.hasComp(e)||_[e].component.options().silent)return n;const t=_[e].component.compInstance(!0);if(t.find(".component__hub").length)return n;t.find(".component__header").after('<div class="component__hub">\n <div class="component__hub__status"></div>\n <div class="component__hub__toggler">\n <a href="javascript:void(0);">Show traffic</a>\n </div>\n <div class="component__hub__traffic" style="display: none;">\n <div class="component__hub__traffic__message"></div>\n <table>\n <thead>\n <tr>\n <th>Parameter</th>\n <th>Ally</th>\n </tr>\n </thead>\n <tbody data-hub-utilities-of="'.concat(v(e),'"></tbody>\n </table>\n </div>\n </div>')),t.find(".component__hub__toggler a").on("click",(function(){"Show traffic"===this.innerHTML?this.innerHTML="Hide traffic":this.innerHTML="Show traffic",t.find(".component__hub__traffic").toggle("blind",l.duration.normalPace)})),t.find(".component__hub__status").on("click",(function(){(t.find(".component__hub").hasClass("connected")||t.find(".component__hub").hasClass("idle"))&&(_[e].autoUpdatable=!_[e].autoUpdatable,N(e))})),t.find(".component__hub__traffic table").disableSelection().addClass("cell-border").DataTable({ordering:!1,responsive:!0,info:!1,paging:!1,searching:!1,autoWidth:!1,columnDefs:[{targets:"_all",createdCell:function(e){$(e).css("line-height","1.5em")}}],columns:[{width:"30%",targets:[0]},{width:"70%",targets:[1]}],dom:'<"component__hub__traffic__table"t>'}),_[e].component._events.on("afterrename",(function(e){$('.component__hub__traffic__itembox__item__name[data-name-dependency="'.concat(v(this._compID),'"]')).text(e)}))},n.isolate=function(e,t){if(!n.hasComp(e))return n;W(),n.removeAllInputProviders(e);for(const t in _[e].output)for(;_[e].output[t].length;){const o=_[e].output[t][0];n.removeConnection(o.id,o.param,e,t)}return L(),!0===t&&Z(e),n},n.isIsolated=function(e){for(let t=0;t<k.relas.length;++t)if(k.relas[t].inputCompID===e||k.relas[t].outputCompID===e)return!1;return!0},n.minimize=function(e){if(n.hasComp(e)&&!_[e].minimized){const t=(A.relas[e]||[]).slice();A.update(e,!0,!1);const n=i.find(".".concat(_[e].hID));n.find(".map__component__body__input").hide(),n.find(".map__component__body__output").hide(),n.find(".map__component__body__input.minimized").show(),n.find(".map__component__body__output.minimized").show(),_[e].minimized=!0,t.forEach((function(e){A.add(e.connectionID)}))}return n},n.maximize=function(e){if(n.hasComp(e)&&_[e].minimized){const t=(A.relas[e]||[]).slice();A.update(e,!0,!1);const n=i.find(".".concat(_[e].hID));n.find(".map__component__body__input").show(),n.find(".map__component__body__output").show(),n.find(".map__component__body__input.minimized").hide(),n.find(".map__component__body__output.minimized").hide(),_[e].minimized=!1,t.forEach((function(e){A.add(e.connectionID)}))}return n},n.toggle=function(e){var t;return null!==(t=_[e])&&void 0!==t&&t.minimized?n.maximize(e):n.minimize(e),n},n.remove=function(e){return n.hasComp(e)&&(n.isolate(e),U(e,!0).remove(),_[e].component.compInstance(!0).find(".component__hub").remove(),_[e].component._events.off("hub.parameter.input.add").off("hub.parameter.input.has").off("hub.parameter.input.remove").off("hub.parameter.output.add").off("hub.parameter.output.has").off("hub.parameter.output.remove").off("hub.parameter.all"),s.keys("^Hub\\[".concat(n._hubID,"\\]:").concat(e,"_")).forEach((e=>s.remove(e))),s.keys("^Hub\\[".concat(n._hubID,"\\]:Component\\[").concat(_[e].hID,"\\]_")).forEach((e=>s.remove(e))),delete _[e],n._events.call("remove",n,e)),n},n.isStrict=()=>m,n.unstrict=function(){return m=!1,n},n.restrict=function(){if(m)return n;let e=0;for(let t=0;t<k.relas.length;++t)k.relas[t].inputParam!==k.relas[t].outputParam&&++e;return e>0?($.alert($.extend({},l.alertConfiguration,{title:"Prohibited strict mode",content:"Detected <strong>".concat(e," connection").concat(e>1?"s":"","</strong> of lower strict level. Please check and try again.")})),!1):(m=!0,n)},n.state={backup:function(){const e=n.state.normalize({});n.compList().forEach((function(t){const n=U(t,!0);e.components.push({compID:t,css:{top:n.css("top")||"",left:n.css("left")||"",zIndex:n.css("z-index")||"",width:n[0].style.width||""}})})),n.connections().forEach((function(t){e.connections.push({inputCompID:t.inputCompID,inputParam:t.inputParam,outputCompID:t.outputCompID,outputParam:t.outputParam,zIndex:V(t.inputCompID,t.inputParam,t.outputCompID,t.outputParam,!0).css("z-index")})}));const t=Y(i[0]);e.props.transform="matrix(".concat(t.scaleX,", ").concat(t.skewY,", ").concat(t.skewX,", ").concat(t.scaleY,", ").concat(t.translateX,", ").concat(t.translateY,")"),e.props.layering.minZIndex=P.minZIndex,e.props.layering.maxZIndex=P.maxZIndex;const o=M.savedPositions();for(const t in o)e.props.positioning[t]=o[t];return e},restore:function(e){const t=n.state.normalize(e);t.components.forEach((function(e){n.hasComp(e.compID)&&(_[e.compID].component.options().silent||U(e.compID,!0).css({position:"absolute",top:e.css.top,left:e.css.left,zIndex:e.css.zIndex,width:e.css.width}))}));const a=o.is(":visible");o.css("display","block"),W(),t.connections.forEach((function(e){n.addConnection(e.inputCompID,e.inputParam,e.outputCompID,e.outputParam),V(e.inputCompID,e.inputParam,e.outputCompID,e.outputParam,!0).css("z-index",e.zIndex)})),L();const i=t.props.transform.match(/matrix.*\((.+)\)/)[1].split(", ");r.zoomAbs(parseFloat(i[4]),parseFloat(i[5]),parseFloat(i[0])),o.css("display",a?"block":"none"),P.minZIndex=t.props.layering.minZIndex,P.maxZIndex=t.props.layering.maxZIndex;for(const e in t.props.positioning)M.fixPosition(t.props.positioning[e],e)},normalize:function(e){let t={};t=$.extend({components:[],connections:[],props:{}},e);for(let e=0;e<t.components.length;++e)t.components[e]=$.extend({compID:"",css:{}},t.components[e]),t.components[e].css=$.extend({top:0,left:0,zIndex:"",width:""},t.components[e].css);for(let e=0;e<t.connections.length;++e)t.connections[e]=$.extend({inputCompID:"",inputParam:"",outputCompID:"",outputParam:"",zIndex:""},t.connections[e]);t.props=$.extend({transform:"",layering:{},positioning:{}},t.props),t.props.layering=$.extend({minZIndex:0,maxZIndex:0},t.props.layering),t.props.positioning=$.extend({},t.props.positioning);for(const e in t.props.positioning)t.props.positioning[e]=$.extend({top:0,left:0,zIndex:""},t.props.positioning[e]);return t}},n.getMapTransform=function(){return Y(i[0])};let H=0,B=[];function Z(e){H?B.push(e):_[e].autoUpdatable?_[e].component.trigger():(F(e,g.IDLE,'Congestion detected. <a class="component__hub__traffic__message__resolve" href="javascript:void(0);">Resolve</a>.'),_[e].component.options().silent||_[e].component.compInstance(!0).find(".component__hub__traffic__message__resolve").on("click",(function(){_[e].autoUpdatable=!0,N(e),Z(e)})))}function W(){++H}function L(){if(!--H){for(const e of new Set(B))Z(e);B=[]}}function N(e){R(e)||(_[e].autoUpdatable?F(e,g.CONNECTED,"Connected."):F(e,g.IDLE,"Paused."))}function Y(e){const t=window.getComputedStyle(e),n=t.transform||t.webkitTransform||t.mozTransform;if(!n||"none"===n||n.includes("3d"))return{scaleX:1,skewY:0,skewX:0,scaleY:1,translateX:0,translateY:0};const o=n.match(/matrix.*\((.+)\)/)[1].split(", ");return{scaleX:parseFloat(o[0]),skewY:parseFloat(o[1]),skewX:parseFloat(o[2]),scaleY:parseFloat(o[3]),translateX:parseFloat(o[4]),translateY:parseFloat(o[5])}}function X(e){let t=0,n=0;for(;e&&!isNaN(e.offsetLeft)&&!isNaN(e.clientLeft)&&!isNaN(e.offsetTop)&&!isNaN(e.clientTop);)t+=e.offsetLeft+e.clientLeft,n+=e.offsetTop+e.clientTop,e=e.offsetParent;return{top:n,left:t}}function U(e,t){const o=n.hasComp(e)?i.find(".".concat(_[e].hID)):$("<div>");return t?o:o[0]}function V(e,t,n,o,a){const r=i.find('[data-connection="'.concat(k.get(e,t,n,o).id,'"]'));return a?r:r[0]}function K(e){const t=$(e);if(t.length){const e="diagonal"===t.attr("data-line-type");return{fromX:parseFloat(t.css("left"),10),fromY:-parseFloat(t.css("top"),10)-t.height()*!e,toX:parseFloat(t.css("left"),10)+t.width(),toY:-parseFloat(t.css("top"),10)-t.height()*e}}}function G(e,t){const n={x:e=void 0===e?null:e,y:t=void 0===t?null:t,s:null};h=e,f=t;const a=Y(i[0]);n.s=a.scaleX||null,null===n.s&&(n.x=n.y=null);const r=o.offset();null!==n.x&&(n.x=(n.x-r.left-(a.translateX||0))/n.s),null!==n.y&&(n.y=(n.y-r.top-(a.translateY||0))/n.s);for(const e in n)o.find(".map__coordinates__item span.".concat(e)).text(null===n[e]?"N/A":n[e].toFixed(2))}return n}const Ie=.001;const xe=l.duration.fastPace;function Ce(e,t,n){const o={_events:d()},a=$(e);let i,r;return a.draggable({appendTo:"body",cursor:"grabbing",distance:5,helper:()=>'<div class="dragdrop__helper"><i class="fas fa-bars"></i> '.concat(y(o._events.call("helper",o)),"</div>"),opacity:l.opacity,revert:()=>!i.hasClass("dragdrop__hover"),revertDuration:l.duration.fastPace,scope:"dragdrop",scroll:!1,zIndex:l.menubarButtonsZIndex+10}).on("dragstart",(function(){$("body").css("overflow","hidden"),a.css("pointer-events","none"),i=$(t).addClass("dragdrop__active"),r=$(n)})).on("drag",(function(e,t){t.position.left=e.pageX,t.position.top=e.pageY;const n=$(document.elementFromPoint(e.pageX,e.pageY));n.closest(i).length&&!n.closest(r).length?i.addClass("dragdrop__hover"):i.removeClass("dragdrop__hover"),o._events.call("drag",o,e)})).on("dragstop",(function(e){$("body").css("overflow",""),a.css("pointer-events",""),i.hasClass("dragdrop__hover")&&o._events.call("drop",o,e),i.removeClass("dragdrop__active dragdrop__hover")})).bindIframeFixEvents("drag"),o.destroy=function(){a.draggable("destroy"),$(t).removeClass("dragdrop__active dragdrop__hover"),l.destroyObj(o)},o}function ke(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const n={};t=$.extend({destroyOnHide:!0,fixed:!1,title:"Notice",body:""},t);const o=$('<div class="overlay-container'.concat(t.fixed?" fixed":"",'" style="display: none;">\n <div class="overlay-backdrop"></div>\n <div class="overlay">\n <div class="overlay__title">\n <div class="overlay__title__text">').concat(v(t.title),'</div>\n <div class="overlay__title__close" title="Close"></div>\n </div>\n <div class="overlay__body"></div>\n </div>\n </div>'));return o.appendTo($(e)),$(t.body).appendTo(o.find(".overlay__body")),o.find(".overlay-backdrop").on("click",(()=>{t.destroyOnHide?n.destroy():n.hide()})),o.find(".overlay__title__close").on("click",(()=>{t.destroyOnHide?n.destroy():n.hide()})),n.show=function(){return new Promise((e=>{o.fadeIn(l.duration.normalPace,(()=>{e(n)}))}))},n.hide=function(){return new Promise((e=>{o.fadeOut(l.duration.normalPace,(()=>{e(n)}))}))},n.destroy=function(){return n.hide().then((()=>{o.remove(),l.destroyObj(n)}))},n}function $e(e,t){const n={},o=$('<div class="spinner'.concat(t?" ellipsis":"",'">\n <span class="spinner__spinner">\n <div></div><div></div><div></div>\n </span>').concat(e.length?'<span class="spinner__label">'.concat(y(e),"</span>"):"","\n </div>"));return n.instance=function(e){const t=$(o[0].outerHTML);return e?t:t[0]},n.html=function(){return o[0].outerHTML},n}function De(e,n){const o=$.extend(!0,{autoSave:!0,browser:{autoShow:!1,autoHide:!0,left:!0,show:!0},cleanCoExisting:!0,componentView:!0,componentViewHeight:150,forceInstall:!0,workspaceMode:!0},n),a={_wrapperID:l.uniqueID("sw"),_events:d()},i={};let r,u,f="";const _=function(){const e={};let t=$(),n=$(),a=$();function r(e,t,n){if(!t.attr("data-session"))throw new Error("Wrapper: ".concat(n," elements must have non-empty `data-session` attributes"));return e.add(t)}return e.addWorkspace=function(n){return t=r(t,n,"workspace"),e},e.addWorkspaceMin=function(t){return n=r(n,t,"workspace minimized"),e},e.addGraph=function(t){return a=r(a,t,"graph"),e},e.update=function(){!function(){const e=e=>e.filter(((e,t)=>Object.prototype.hasOwnProperty.call(i,$(t).attr("data-session"))));t=e(t),n=e(n),a=e(a)}();const r=e=>{e.filter('[data-session="'.concat(f.replace('"','\\"'),'"]')).show(),e.filter(':not([data-session="'.concat(f.replace('"','\\"'),'"])')).hide()};return r(n),o.workspaceMode?(r(t),a.hide(),u.find('.WORKSPACE[data-role="layout"]').show(),u.find('.GRAPH[data-role="layout"]').hide()):(t.hide(),r(a),u.find('.WORKSPACE[data-role="layout"]').hide(),u.find('.GRAPH[data-role="layout"]').show()),g(),e},e.query=function(e){return e=e.replace('"','\\"'),[t.filter('[data-session="'.concat(e,'"]')),n.filter('[data-session="'.concat(e,'"]')),a.filter('[data-session="'.concat(e,'"]'))]},e}();function g(){$(window).trigger("resize.".concat(a._wrapperID))}function b(e,n){o[e]=n,t.Z.events.SetStorage.invoke("layout",JSON.stringify(o)),a._events.call("layout-update",a,$.extend(!0,{},o))}return a.init=async function(){const n='style="height: '.concat(o.componentViewHeight,'px;"');$(e).replaceWith(u=$('<div class="session-wrapper '.concat(a._wrapperID,'" style="display: block; position: relative;">\n <div class="topnav">\n <div class="topnav__wrapper">\n <div class="topnav__wrapper__tablist">\n <div class="topnav__wrapper__tablist__item').concat(o.workspaceMode?" active":"",'" data-tab=".WORKSPACE">\n <div class="topnav__wrapper__tablist__item__title">Workspace</div>\n </div>\n <div class="topnav__wrapper__tablist__item').concat(o.workspaceMode?"":" active",'" data-tab=".GRAPH">\n <div class="topnav__wrapper__tablist__item__title">Graph</div>\n </div>\n </div>\n </div>\n </div>\n\n <div class="g-container-span" style="height: 100vh; overflow: hidden;">\n <div class="topnav__mirror" data-role="layout" data-occupy-height=true></div>\n <div data-role="container" style="position: relative;">\n <div class="empty">\n <div class="empty__content">\n <div class="logo"></div>\n <div class="text">Wow, I&#39;m the first one!</div>\n </div>\n <div class="empty__hint"><strong>Hint:</strong> Start by creating a session!</div>\n </div>\n </div>\n <div class="bottomtab" data-role="layout" data-occupy-height=true></div>\n <div class="WORKSPACE bottomnav__mirror" ').concat(n,' data-role="layout" data-occupy-height=true></div>\n </div>\n\n <div class="WORKSPACE bottomnav" data-role="layout">\n <div class="bottomnav__wrapper" ').concat(n,'>\n <div class="bottomnav__wrapper__header">\n <div class="bottomnav__wrapper__header__title">Components</div>\n </div>\n </div>\n </div>\n </div>')));const i=u.find('[data-role="container"]');a._sticky=function(e,t){const n={_stickyID:l.uniqueID("sm"),_events:d()},o=l.duration.normalPace,a=l.duration.userInteractionWait;t=$.extend(!0,{show:!0,left:!0,autoShow:!1,autoHide:!0},t);const i=$('<div class="sticky'.concat(t.left?"":" right").concat(t.autoShow?" autoshow":"",'"').concat(t.show?"":' style="display: none;"','>\n <div class="sticky__wrapper">\n <div class="sticky__edge"></div>\n <div class="sticky__placeholder">\n <div class="sticky__placeholder__logo"></div>\n <div class="sticky__placeholder__title">Browser</div>\n </div>\n <div class="sticky__menu">\n <div class="sticky__menu__wrapper">\n <div class="sticky__menu__tab"></div>\n <div class="sticky__menu__container"></div>\n </div>\n </div>\n </div>\n </div>'));i.appendTo($(e));const r=i.find(".sticky__wrapper");let s,c,u=!0;const p=()=>{s&&clearTimeout(s),c&&clearTimeout(c)};let m=!1;const h=te(".sticky__placeholder",{id:"main",align:"vertical",menus:[{name:"Move Library ".concat(t.left?"Right":"Left"),id:"switchside",type:"click"},{name:"Auto Show Library",id:"autoshow",type:"click",ticked:t.autoShow},{name:"Auto Hide Library",id:"autohide",type:"click",ticked:t.autoHide},{name:"Hide Library",id:"hide",type:"click"}]}).init().menu;return h._events.on("switchside",(()=>n.switchSide())).on("autoshow",(()=>n.toggleAutoShow())).on("autohide",(()=>n.toggleAutoHide())).on("hide",(()=>n.hide())).on("_show",(()=>{m=!0})).on("_hide",(()=>{m=!1})),i.find(".sticky__placeholder").on("click",(()=>{p(),r.toggleClass("active")})),i.on("mouseenter",(e=>{u||(u=!0,p()),$(e.target).is(i.find(".sticky__placeholder"))||t.autoShow&&!r.hasClass("active")&&(s=setTimeout((()=>{r.addClass("active"),s=null}),o))})).on("mouseleave",(()=>{const e=()=>{u&&(u=!1,p()),m?h._events.one("_hide",(t=>{"main"!==t||u||e()})):t.autoHide&&r.hasClass("active")&&(c=setTimeout((()=>{r.removeClass("active"),c=null}),a))};e()})),n.hide=function(){return t.show=!1,i.hide(),n._events.call("change",n,$.extend(!0,{},t)),n},n.show=function(){return t.show=!0,i.show(),n._events.call("change",n,$.extend(!0,{},t)),n},n.options=function(){return $.extend(!0,{},t)},n.switchSide=function(){return i.toggleClass("right"),t.left=!i.hasClass("right"),h.getMenuItemsById("switchside").name=["Move Library Left","Move Library Right"][+t.left],n._events.call("change",n,$.extend(!0,{},t)),n},n.toggleAutoShow=function(){const e=h.getMenuItemsById("autoshow");return e.isTicked()?e.untick():e.tick(),t.autoShow=!t.autoShow,t.autoShow?i.addClass("autoshow"):i.removeClass("autoshow"),t.autoShow&&u&&i.trigger("mouseenter"),n._events.call("change",n,$.extend(!0,{},t)),n},n.toggleAutoHide=function(){const e=h.getMenuItemsById("autohide");return e.isTicked()?e.untick():e.tick(),t.autoHide=!t.autoHide,t.autoHide&&!u&&i.trigger("mouseleave"),n._events.call("change",n,$.extend(!0,{},t)),n},n.destroy=function(){p(),i.remove(),h.destroy(),l.destroyObj(n)},n.tabs=new function(){const e=this,t=i.find(".sticky__menu__tab"),n=i.find(".sticky__menu__container");t.on("click",".sticky__menu__tab__item[data-sticky-id]",(t=>{e.setActive($(t.currentTarget).attr("data-sticky-id"))})),this.add=function(o,a){return o=v(o),e.has(o)||(t.append($('<div class="sticky__menu__tab__item" data-sticky-id="'.concat(o,'">\n <div class="sticky__menu__tab__item__title">').concat(y(a),"</div>\n </div>"))),n.append($('<div class="sticky__menu__container__item" data-sticky-id="'.concat(o,'" style="display: none;"><div>'))),t.children().length<=1&&e.setActive(o)),e},this.instance=function(t,o){if(t=v(t),!e.has(t))return null;const a=n.find('.sticky__menu__container__item[data-sticky-id="'.concat(t,'"]'));return o?a:a[0]},this.has=function(e){e=v(e);const o=t.find('.sticky__menu__tab__item[data-sticky-id="'.concat(e,'"]')),a=n.find('.sticky__menu__container__item[data-sticky-id="'.concat(e,'"]'));return!(!o.length||!a.length)||((o.length||a.length)&&(o.length?o.remove():a.remove()),!1)},this.remove=function(o){return o=v(o),t.find('.sticky__menu__tab__item[data-sticky-id="'.concat(o,'"]')).remove(),n.find('.sticky__menu__container__item[data-sticky-id="'.concat(o,'"]')).remove(),e},this.rename=function(n,o){return n=v(n),e.has(n)||t.find('.sticky__menu__tab__item[data-sticky-id="'.concat(n,'"]')).find(".sticky__menu__tab__item__title").text(o),e},this.setActive=function(n){return n=v(n),e.has(n)&&(t.find('.sticky__menu__tab__item[data-sticky-id="'.concat(n,'"]')).addClass("active").siblings().removeClass("active"),e.instance(n,!0).show().siblings().hide()),e}},n}(i,o.browser),a._sticky.tabs.add("components","Components").add("logs","Logs");const r=a._sticky.tabs.instance("components",!0),s=a._sticky.tabs.instance("logs",!0),c=u.find(".empty__hint"),p=()=>{a._sticky.options().left?c.addClass("right"):c.removeClass("right")};p(),a._sticky._events.on("change",(e=>{b("browser",e),p()}));let w="";const I=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"No items found.";const n={_events:d()},o={},a=$('<div class="treelist-container noitem">\n <div class="treelist-container__placeholder">'.concat(y("".concat(t)),"</div>\n </div>"));function i(e){let t=$('<div class="treelist" data-treelist-id="'.concat(v(e),'">\n <div class="treelist__header">\n <div class="treelist__header__text"></div>\n </div>\n <div class="treelist__body"></div>\n </div>')),n=t.children(".treelist__header"),o=n.children(".treelist__header__text"),a=t.children(".treelist__body");this.getTitle=()=>o.text(),this.setTitle=e=>(o.text(e),this),this.getMore=()=>n.hasClass("more"),this.setMore=e=>(e?n.addClass("more"):n.removeClass("more"),this),this.getOpen=()=>t.hasClass("open"),this.setOpen=e=>(e?t.addClass("open"):t.removeClass("open"),this),this.instance=e=>e?t:t[0],this.headerInstance=e=>e?n:n[0],this.bodyInstance=e=>e?a:a[0],this.remove=()=>{t.remove(),t=n=o=a=$()}}return a.appendTo($(e)),a.on("click",".treelist__header",(function(){const e=$(this).closest(".treelist").attr("data-treelist-id")||"";if(Object.prototype.hasOwnProperty.call(o,e)){const t=o[e];t.getMore()&&(t.getOpen()?(n._events.call("".concat(e,".collapse"),t),t.setOpen(!1)):(n._events.call("".concat(e,".expand"),t),t.setOpen(!0)))}})),n.getPlaceholder=function(){return t},n.setPlaceholder=function(e){return a.find(".treelist-container__placeholder").text(t="".concat(e)),n},n.add=function(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return Object.prototype.hasOwnProperty.call(o,e)||(o[e]=new i(e),t&&(o[e].instance(!0).appendTo(a),a.removeClass("noitem"))),o[e]},n.get=function(e){return Object.prototype.hasOwnProperty.call(o,e)?o[e]:null},n.remove=function(e){let t=!1;return Object.prototype.hasOwnProperty.call(o,e)&&(o[e].remove(),delete o[e],t=!0),a.children().length||a.addClass("noitem"),t},n.all=function(){const e=[];for(const t in o)e.push(t);return e},n.clear=function(){return n.all().reduce(((e,t)=>e+n.remove(t)),0)},n.destroy=function(){a.remove(),l.destroyObj(n)},n}(r).setPlaceholder("Loading..."),x=m.getStorageOfField("treelist");a._events.on("sticky-refresh-components",(async()=>{let e=await x.getFull();try{e=JSON.parse(e)}catch(t){e={}}I.clear();const n=t.Z.events.GetPackages.sendSync().sort(((e,t)=>"".concat(e).localeCompare("".concat(t))));w="";for(const i of n){const n="pkg: "+i,r=I.add(n).setTitle(n).setMore(!0).setOpen(!!e[n]);I._events.on("".concat(n,".collapse"),(()=>{x.setItem(n,!1)})).on("".concat(n,".expand"),(()=>{x.setItem(n,!0)}));const s=await t.Z.events.GetPackage.invoke(i);w+="<div".concat(w.length?' style="margin-top: 0.5rem;"':"",">\n <strong>Package:</strong> ").concat(y(s.name),'<br />\n <strong>Description:</strong> <span style="white-space: pre-wrap;">').concat(y(s.description)||'<em style="opacity: 0.7;">No description.</em>',"</span>\n </div>"),s.components.length||r.bodyInstance(!0).text("No components found."),s.components.forEach((i=>{t.Z.events.GetComponent.invoke(i,!0).then((t=>{if(!t)return;const s="com: "+i,c="".concat(n,"/").concat(s),d=I.add(c,!1).setTitle(s).setMore(!0).setOpen(!!e[c]);I._events.on("".concat(c,".collapse"),(()=>{x.setItem(c,!1)})).on("".concat(c,".expand"),(()=>{x.setItem(c,!0)})),d.bodyInstance(!0).html('<div style="padding: 0.5em;">\n <strong>Name:</strong> '.concat(y(t.name),"<br />\n <strong>Category:</strong> ").concat(y(t.category),"<br />\n <strong>Input:</strong> ").concat(t.input.length?t.input.map((e=>"".concat(e.type!==e.name?'<span class="paramtype">'.concat(y(e.type),".</span>"):"").concat(y(e.name)).concat(e.required?"*":"").concat(e.limit?" (".concat(e.limit,")"):""))).join(", "):"N/A","<br />\n <strong>Output:</strong> ").concat(t.output.length?t.output.map((e=>"".concat(e.type!==e.name?'<span class="paramtype">'.concat(y(e.type),".</span>"):"").concat(y(e.name)))).join(", "):"N/A","<br />\n <strong>Backward-compatible with:</strong> ").concat(y(t.compatibleUntil),'+<br />\n <hr />\n <div style="width: 100%; font-size: 0.9em; white-space: pre-wrap;">').concat(y(t.description)||"No description.","</div>\n </div>"));let u=null;Ce(d.headerInstance(!0),'[data-role="WORKSPACE"], [data-role="GRAPH"]',".sticky__edge, .sticky__placeholder, .sticky__menu")._events.on("helper",(()=>i)).on("drag",(async e=>{const t=$(document.elementFromPoint(e.pageX,e.pageY)).closest(".tab__list__item[data-tab-item-id]");t.length?u=setTimeout((()=>{a.switchTo(t.attr("data-tab-item-id")),u=null}),l.duration.userInteractionWait):u&&clearTimeout(u)})).on("drop",(e=>{const t=a.getCurrentSession();if(t)if(o.workspaceMode){const n=$(t.componentContainer).offset();t.add(i,null,{},{component:{left:e.pageX-n.left,top:e.pageY-n.top}})}else{const n=t.hub.instance(!0).offset(),o=t.hub.getMapTransform();t.add(i,null,{},{hub:{left:(e.pageX-n.left-o.translateX)/o.scaleX,top:(e.pageY-n.top-o.translateY)/o.scaleY}})}}));const p=te(".".concat(l.getQueryID(d.headerInstance(!0))),{id:"main",align:"vertical",menus:[{name:"Add to Current Session",id:"addtosession",type:"click"}]}).init();p.menu._events.on("addtosession",(()=>{a.getCurrentSession().add(i)}));const m=p.menu.getMenuItemsById("addtosession");p._events.on("beforeshow",(()=>{f?m.enable():m.disable()})),d.instance(!0).appendTo(r.bodyInstance(!0))}))})),te("."+l.getQueryID(r.headerInstance(!0)),{id:"main",align:"vertical",menus:[{name:"Remove This Package",id:"removepackage",type:"click"}]}).init().menu._events.on("removepackage",(()=>{$.confirm($.extend({},l.confirmConfiguration,{content:"This will remove the package (<strong>".concat(y(i),"</strong>) permanently. Are you sure?"),buttons:{confirm:()=>{t.Z.events.RemovePackage.invoke(i).then((e=>{e&&a._events.invoke("sticky-refresh-components")})),a._sticky.tabs.setActive("logs")},cancel:()=>{}}}))}))}I.setPlaceholder("No packages found."),w.length||(w="No packages found.")})),a._events.invoke("sticky-refresh-components");const C=te("."+l.getQueryID(r),{id:"main",align:"vertical",menus:[{name:"Add Packages...",id:"addpackages",type:"click"},{},{name:"Clean Co-Existing Versions After Installation",id:"cleancoexisting",type:"click",ticked:o.cleanCoExisting},{name:"Force Package Installation",id:"forceinstall",type:"click",ticked:o.forceInstall},{},{name:"View Package Info",id:"packageinfo",type:"click"}]}).init(),k=C.menu.getMenuItemsById("cleancoexisting"),D=C.menu.getMenuItemsById("forceinstall");C.menu._events.on("addpackages",(()=>{t.Z.events.AddPackages.invoke(k.isTicked(),D.isTicked()).then((e=>{e&&a._events.invoke("sticky-refresh-components")})),a._sticky.tabs.setActive("logs")})).on("cleancoexisting",(()=>{const e=k.isTicked();b("cleanCoExisting",!e),e?k.untick():k.tick()})).on("forceinstall",(()=>{const e=D.isTicked();b("forceInstall",!e),e?D.untick():D.tick()})).on("packageinfo",(()=>{ke(r,{body:$("<div></div>").html(w),title:"Package Information"}).show()})),s.addClass("logger").css("background","#000"),a._events.on("sticky-log",(e=>{!1===e?s.html(""):s.append(e)})),te(".logger",{id:"main",align:"vertical",menus:[{name:"Clear",id:"clear",type:"click"}]}).init().menu._events.on("clear",(()=>{s.html("")}));const P=u.find(".g-container-span");a._tabs=function(e,t){const n={_tabID:l.uniqueID("ta"),_events:d()};t=$.extend({noCloseIcon:!1,noCollapse:!1},t);const o=$('<div class="tab '.concat(n._tabID).concat(t.noCloseIcon?" no-close":"",'"').concat(t.noCollapse?"":' style="display: none;"','>\n <div class="tab__scroller left"></div>\n <div class="tab__scroller right"></div>\n <div class="tab__list"></div>\n </div>'));let a=[];o.appendTo($(e));const i=o.find(".tab__list");function r(){const e=o.find(".tab__scroller.left"),t=o.find(".tab__scroller.right"),n=i.scrollLeft();n>8?e.fadeIn(xe):e.fadeOut(xe),n<i[0].scrollWidth-i.width()-8?t.fadeIn(xe):t.fadeOut(xe)}function s(e){return i.find('.tab__list__item[data-tab-item-id="'.concat(v(e),'"]'))}return i.on("scroll",r),o.find(".tab__scroller.left").on("click",(()=>{i.animate({scrollLeft:Math.max(0,i.scrollLeft()-i.width())-1},xe,"swing",r)})),o.find(".tab__scroller.right").on("click",(()=>{i.animate({scrollLeft:Math.min(i[0].scrollWidth-i.width(),i.scrollLeft()+i.width())+1},xe,"swing",r)})),r(),i.sortable({cursor:"grabbing",distance:5,helper:"clone",items:".tab__list__item",opacity:.8,start:function(e,t){t.placeholder.width(t.item.width())}}),n.instance=function(e){return e?o:o[0]},n.add=function(e,t){if(n.hasItem(e))return n;const s=$('<div class="tab__list__item" data-tab-item-id="'.concat(v(e),'">\n <span>').concat(t,'</span>\n <div class="tab__list__item__close" title="Close (Ctrl+F4)">&times;</div>\n </div>'));return s.appendTo(i),o.show(),s.on("click",(()=>{if(s.hasClass("active"))return;a=a.filter((t=>t!==e)),a.push(e),s.addClass("active").siblings().removeClass("active");const t=s.position().left,o=i.scrollLeft(),r=s.outerWidth(!0),c=i.outerWidth(!0);t<0?i.scrollLeft(o+t):t+r>c&&i.scrollLeft(o+t+r-c),n._events.call(e,n,s)})).find(".tab__list__item__close").on("click",(()=>n.remove(e))),s.trigger("click"),n._events.call("add",n,e,t),r(),n},n.remove=function(e,i){if(n.hasItem(e)){let c=!0;i||n._events.call("beforeremove",n,e,(function(){c=!1})),c&&(s(e).remove(),n.currentActive()===e?(a.pop(),a.length&&n.setActive(a[a.length-1])):a=a.filter((t=>t!==e)),a.length||t.noCollapse||o.hide(),n._events.call("remove",n,e),r())}return n},n.hasItem=function(e){return s(e).length},n.setActive=function(e){return s(e).trigger("click"),n},n.currentActive=function(){return a.length?a[a.length-1]:null},n.updateTitle=function(e,t){return!!n.hasItem(e)&&(s(e).find("span").text(t),!0)},n.findItem=function(e){const t=$(e).closest(".tab__list__item[data-tab-item-id]").attr("data-tab-item-id")||"";return n.hasItem(t)?t:null},n.getState=function(){const e=[];return i.find(".tab__list__item").each((function(){const t=$(this);e.push({id:t.attr("data-tab-item-id"),active:t.hasClass("active")})})),e},n.destroy=function(){n.instance(!0).remove(),l.destroyObj(n)},n}(u.find(".bottomtab"),{noCloseIcon:!0,noCollapse:!0});const O=te(".bottomtab",{id:"main",align:"vertical",menus:[{name:"Add Session",id:"addsession",type:"click"},{},{name:"Duplicate",id:"duplicate",type:"click"},{name:"Rename Session...",id:"renamesession",type:"click"},{name:"Remove Session...",id:"removesession",type:"click"}]}).init();let S;O._events.on("beforeshow",(e=>{const t=$(e.target).closest(".tab__list__item");t.length?(S=t,O.menu.getMenuItemsById("duplicate").enable(),O.menu.getMenuItemsById("renamesession").enable(),O.menu.getMenuItemsById("removesession").enable()):(S=null,O.menu.getMenuItemsById("duplicate").disable(),O.menu.getMenuItemsById("renamesession").disable(),O.menu.getMenuItemsById("removesession").disable())})),O.menu._events.on("addsession",(()=>{a.switchTo(a.addSession())})).on("duplicate",(()=>{S&&a.duplicateSession(a._tabs.findItem(S))})).on("renamesession",(()=>{if(S){const e=a.getSession(a._tabs.findItem(S));e&&l.launchInputBox("Rename Session",e.options().name,"Type new name here",(t=>{e.rename(t)}))}})).on("removesession",(()=>{if(S){const e=a.getSession(a._tabs.findItem(S));e&&$.confirm($.extend({},l.confirmConfiguration,{content:"Are you sure to remove the session permanently?",buttons:{confirm:()=>a.removeSession(e._sessionID),cancel:()=>{}}}))}}));const A=u.find(".bottomnav__mirror");A.outerHeight(u.find(".bottomnav").outerHeight());const M=u.find(".bottomnav__wrapper");let z;M.resizable({handles:"n",minHeight:M.find(".bottomnav__wrapper__header").outerHeight(!0)+2,maxHeight:.5*P.height(),resize:function(e,t){t.element.css("top",""),t.element.css("width",""),A.height(M.outerHeight(!0)-1),g()},stop:function(){b("componentViewHeight",A.height())}}).bindIframeFixEvents("resize"),o.componentView||(M.hide(),A.outerHeight(0)),M.find(".ui-resizable-handle").on("dblclick",(function(){$(this).trigger("mousemove"),M.height(150),A.height(150),g(),b("componentViewHeight",A.height())})),$(window).on("resize.".concat(a._wrapperID),function e(){const t=.5*P.height()-8;M.resizable("option","maxHeight",t),M.height(Math.min(M.height(),t));const n=function(){let e=0;return P.find('[data-role="layout"][data-occupy-height]').each(((t,n)=>{const o=$(n);o.is(":visible")&&(e+=o.outerHeight(!0))})),e}(),o=function(){let e=0;return P.find('[data-role="layout"][data-occupy-width]').each(((t,n)=>{const o=$(n);o.is(":visible")&&(e+=o.outerWidth(!0))})),e}(),a=document.documentElement.scrollWidth>document.documentElement.clientWidth?8:0;return u.find('[data-role="container"]').height(P.height()-n-a+1).width(P.width()-o+1),e}()),u.find(".topnav__wrapper__tablist__item").on("click",(function(){const e=$(this);e.siblings(".active").each(((e,t)=>$(t).removeClass("active"))),".WORKSPACE"===e.attr("data-tab")?b("workspaceMode",!0):b("workspaceMode",!1),_.update(),e.addClass("active")})),a._ctxMenu=te('[data-role="container"]',{id:"main",align:"vertical",menus:[{name:"Add Session",id:"addsession",type:"click"},{},{name:"Rename Session...",id:"renamesession",type:"click"},{name:"Remove Session...",id:"removesession",type:"click"}],ignore:".component"}).init(),a._ctxMenu._events.on("beforeshow",(()=>{z=a.getCurrentSession(),z?(a._ctxMenu.menu.getMenuItemsById("renamesession").enable(),a._ctxMenu.menu.getMenuItemsById("removesession").enable()):(a._ctxMenu.menu.getMenuItemsById("renamesession").disable(),a._ctxMenu.menu.getMenuItemsById("removesession").disable())})),a._ctxMenu.menu._events.on("addsession",(()=>{a.switchTo(a.addSession())})).on("renamesession",(()=>{z&&l.launchInputBox("Rename Session",z.options().name,"Type new name here",(e=>{z.rename(e)}))})).on("removesession",(()=>{z&&$.confirm($.extend({},l.confirmConfiguration,{content:"Are you sure to remove the session permanently?",buttons:{confirm:()=>a.removeSession(z._sessionID),cancel:()=>{}}}))})),_.update(),a._events.call("layout-update",a,$.extend(!0,{},o)),a._version=h(a._wrapperID);let E=!1;return await a._version.init((function(e){E=!0;try{const t=l.decompressObj(e);return ke(u,{fixed:!0,body:$e("Found unrecovered data. Restoring",!0).html()}).show().then((e=>{a.state.restore(t).finally((()=>{e.destroy()}))})),!0}catch(e){return!1}})),!E&&o.autoSave&&(o.autoSave=!1,a.autoSave.init()),a},a.browserView={get isEnabled(){return o.browser.show},enable:()=>{a._sticky.show()},disable:()=>{a._sticky.hide()},toggle:()=>{o.browser.show?a.browserView.disable():a.browserView.enable()}},a.componentView={get isEnabled(){return o.componentView},enable:()=>{u.find(".bottomnav__wrapper").show(),u.find(".bottomnav__mirror").outerHeight(u.find(".bottomnav").outerHeight()),g(),b("componentView",!0)},disable:()=>{u.find(".bottomnav__wrapper").hide(),u.find(".bottomnav__mirror").outerHeight(0),g(),b("componentView",!1)},toggle:()=>{o.componentView?a.componentView.disable():a.componentView.enable()}},a.addSession=function(){const e=u.find('[data-role="container"]'),n=$('<div class="g-row" data-role="WORKSPACE" style="overflow: auto; height: 100%; width: 100%; background: #fff;"></div>'),o=$('<div class="g-row" data-role="GRAPH" style="height: 100%; width: 100%; background: #fff;"></div>'),r=u.find(".bottomnav__wrapper__header"),m=$('<div class="bottomnav__wrapper__body" data-role="WORKSPACE_MINIMIZED"></div>');n.appendTo(e),m.insertAfter(r),o.appendTo(e);const h=function(e,n){const o={};for(const[t,n]of Object.entries($.extend({componentContainer:$(),minComponentContainer:$(),hub:$(),tabWorkspace:$(),tabGraph:$()},e)))if(o[t]=$(n),!o[t].length)throw new Error("Session: containers.`".concat(t,"` is an invalid/non-existing element"));const a={_sessionID:l.uniqueID("ss"),_events:d(),_commands:p()};let i=!!(n=$.extend({strict:!0,readOnly:!1},n)).strict;const r=!!n.readOnly;let u="Session";n&&Object.prototype.hasOwnProperty.call(n,"name")&&"string"===$.type(n.name)&&(u=n.name),u=l.fixDuplicateNames.run(u,"Session"),s.set("Session:".concat(u),!0),o.componentContainer.attr("data-session",a._sessionID),o.minComponentContainer.attr("data-session",a._sessionID),o.hub.attr("data-session",a._sessionID);const m={},h=c(),f={maxZIndex:0,bringToFront:function(e){$(e).css("z-index",++f.maxZIndex)}},_=function(){const e={};let t={},n={},o={};return e.add=function(i,r,s,c){const l=function(e){for(const n in t)if(e===t[n])return!0;return!1};if(r&&!Object.prototype.hasOwnProperty.call(t,r._compID)){const e=r._compID;if(s&&!l(s))t[e]=s;else for(let n=1;;++n){const o="comp".concat(n);if(!l(o)){t[e]=o;break}}n[e]=r,o[e]={...c,entity:i},a._events.call("componentManager.add",a,t[e],n[e],o[e])}return e},e.id={has:function(e){return Object.prototype.hasOwnProperty.call(t,e)},query:function(e){return Object.prototype.hasOwnProperty.call(t,e)?t[e]:void 0},ref:function(e){return Object.prototype.hasOwnProperty.call(n,e)?n[e]:void 0},cache:function(e){return Object.prototype.hasOwnProperty.call(o,e)?o[e]:void 0},remove:async function(i){if(i in n){arguments.length>1&&void 0!==arguments[1]&&arguments[1]||(a.hub.remove(i),await n[i].destroy(!0));const e=t[i],r=o[i];delete t[i],delete n[i],delete o[i],e&&r&&a._events.call("componentManager.remove",a,e,i,r)}return e},getAll:function(){const e=[];for(const n in t)e.push(n);return e}},e.alt={has:function(e){for(const n in t)if(t[n]===e)return!0;return!1},query:function(e){for(const n in t)if(t[n]===e)return n},ref:function(t){return e.id.ref(e.alt.query(t))},cache:function(t){return e.id.cache(e.alt.query(t))},remove:async function(t){return await e.id.remove(e.alt.query(t))},getAll:function(){const e=[];for(const n in t)e.push(t[n]);return e}},e.clear=async function(){for(const t of e.id.getAll())await e.id.remove(t);return t={},n={},o={},e},e}();a.componentContainer=o.componentContainer.eq(0),a.minComponentContainer=o.minComponentContainer.eq(0),a.hub=we(o.hub.eq(0),i);const g=function(){const e={},t={};return e.minimize=function(n){const o=_.id.cache(n._compID).category;let i=a.minComponentContainer.find('.category[data-category="'.concat(o.replace('"','\\"'),'"]'));if(!i.length){let e=$();a.minComponentContainer.find(".category").each((function(t,n){const a=$(n);a.attr("data-category").localeCompare(o)<0&&(e=a)})),i=$('<div class="category active" data-category="'.concat(o.replace('"','\\"'),'">\n <div class="category__title">\n <div class="category__title__icon"></div>\n <div class="category__title__name">').concat(y(o),' (<span class="counter">0</span>)</div>\n </div>\n <div class="g-row category__body"></div>\n </div>')),i.find(".category__title").on("click",(function(){i.hasClass("active")?(i.find(".category__body").slideUp(),i.removeClass("active")):(i.find(".category__body").slideDown(),i.addClass("active"))})),e.length?i.insertAfter(e):i.appendTo(a.minComponentContainer)}const r=function(e){return a.componentContainer.find(".component").index(a.componentContainer.find(".component.".concat(e.attr("data-belong-to-component"))))},s=r(n.minCompInstance(!0));let c=$();return i.find(".component-minimized").each((function(e,t){const n=$(t);r(n)<s&&(c=n)})),c.length?n.minCompInstance(!0).parent().insertAfter(c.parent()):n.minCompInstance(!0).parent().prependTo(i.find(".category__body")),t[n._compID]||i.find(".counter").html(parseInt(i.find(".counter").html())+1),t[n._compID]=!0,e},e.maximize=function(e){const n=_.id.cache(e._compID).category,o=a.minComponentContainer.find('.category[data-category="'.concat(n.replace('"','\\"'),'"]'));e.minCompInstance(!0).parent().insertAfter(o);const i=parseInt(o.find(".counter").html())-1;t[e._compID]&&(i<=0?o.remove():o.find(".counter").html(i)),t[e._compID]=!1},e}(),v="componentWrapper",b=v,w="g-col-6 g-col-sm-4 g-col-md-3 ".concat("minComponentWrapper"),I=d().on("beforeminimize",(function(){this.minCompInstance(!0).parent().show(),g.minimize(this),_.id.cache(this._compID).isMinimized=!0})).on("beforemaximize",(function(){this.compInstance(!0).parent().show(),_.id.cache(this._compID).isMinimized=!1})).on("afterminimize",(function(){this.compInstance(!0).parent().hide(),a._commands.do({type:"workspace.component.minimize",caller:this.compInstance(!0),undo:()=>a._commands.runWhenPaused((()=>this.maximize())),redo:()=>a._commands.runWhenPaused((()=>this.minimize()))})})).on("aftermaximize",(function(){this.minCompInstance(!0).parent().hide(),g.maximize(this),a._commands.do({type:"workspace.component.maximize",caller:this.compInstance(!0),undo:()=>a._commands.runWhenPaused((()=>this.minimize())),redo:()=>a._commands.runWhenPaused((()=>this.maximize()))})})).on("afterrename",(function(e,t){const n=a.hub.instance(!0);n.is(":visible")?a.hub._commands.do({type:"graph.component.rename",caller:n,undo:()=>a.hub._commands.runWhenPaused((()=>this.rename(t))),redo:()=>a.hub._commands.runWhenPaused((()=>this.rename(e)))}):a._commands.do({type:"workspace.component.rename",caller:this.compInstance(!0),undo:()=>a._commands.runWhenPaused((()=>this.rename(t))),redo:()=>a._commands.runWhenPaused((()=>this.rename(e)))})})).on("backgroundchange",(function(e,t,n){const o=a.hub.instance(!0);o.is(":visible")?a.hub._commands.do({type:"graph.component.backgroundchange",caller:o,undo:()=>a.hub._commands.runWhenPaused((()=>this.background(n))),redo:()=>a.hub._commands.runWhenPaused((()=>this.background(e)))}):a._commands.do({type:"workspace.component.backgroundchange",caller:this.compInstance(!0),undo:()=>a._commands.runWhenPaused((()=>this.background(n))),redo:()=>a._commands.runWhenPaused((()=>this.background(e)))})})).on("afterinit",(function(){if(this.options().silent)return;const e=this.compInstance(!0),t=this.minCompInstance(!0),n=this,o=(e,t)=>{D(n._compID,e);const o=_.id.ref(n._compID),a=o.compInstance(!0),i=a.find(".component__body"),r=i.outerWidth()-i.width();i.css("width","".concat(Math.max(t-r,o.options().width),"px")),a.add(a.parents(".".concat(v))).width(i.outerWidth(!0))};e.resizable({handles:"se",start:function(t,n){e.attr("data-original-height",n.size.height).attr("data-original-width",n.size.width)},resize:function(e,t){o(t.size.height,t.size.width)},stop:function(t,n){const i=n.size.height,r=n.size.width,s=+e.attr("data-original-height"),c=+e.attr("data-original-width");(Math.abs(i-s)>Ie||Math.abs(r-c)>Ie)&&a._commands.do({type:"workspace.component.resize",caller:e,undo:function(){o(s,c)},redo:function(){o(i,r)}})}}).bindIframeFixEvents("resize"),$(window).on("resize.".concat(a._sessionID).concat(this._compID),(function(){const t=e.parent();e[0].scrollWidth>e.width()&&e.css("width",""),t[0].scrollWidth>t.width()&&t.css("width","")})),e.parent().hasClass(b)&&!e.siblings().length||e.wrap('<div class="'.concat(b,'" style="display: none;"></div>')),t.parent().hasClass(w)&&!t.siblings().length||t.wrap('<div class="'.concat(w,'" style="display: none;"></div>')),e.parents(".".concat(v)).css("width",e.css("width")),a._commands.runWhenPaused((()=>_.id.cache(this._compID).isMinimized?this.minimize():this.maximize())),C("enable",!0),a.hub.refreshHubUtilities(this._compID)})).on("afterduplicate",(function(e){e._events.merge(I);const t=_.id.cache(this._compID);_.add(t.entity,e,null,t),e.init();const n=this.compInstance(!0),o=this.minCompInstance(!0);n.parent().draggable("instance")&&e.compInstance(!0).parent().draggable(n.parent().draggable("option")).bindIframeFixEvents("drag"),n.parent().after(e.compInstance(!0).parent()),o.parent().after(e.minCompInstance(!0).parent());const a=e.compInstance(!0).parent();h.watch(a,"Component"),a.off("mousedown.layerhelper").on("mousedown.layerhelper",(()=>f.bringToFront(a)));const i=_.id.cache(e._compID);i.category=t.category,i.isMore=!0,i.version=t.version})).on("afterdestroy",(function(e){this.options().silent||(e.parentCompInstance.remove(),e.parentMinCompInstance.remove(),$(window).off("resize.".concat(a._sessionID).concat(this._compID)),g.maximize(this)),_.id.remove(this._compID,!0)})),x={handle:".component__header",opacity:l.opacity,cursor:"grabbing",start:(e,t)=>{$(e.target).attr("data-original-top",t.position.top).attr("data-original-left",t.position.left)},stop:(e,t)=>{const n=$(e.target),o=Math.max(0,t.position.top),i=Math.max(0,t.position.left),r=+n.attr("data-original-top"),s=+n.attr("data-original-left");n.css({top:o,left:i}),(Math.abs(o-r)>Ie||Math.abs(i-s)>Ie)&&a._commands.do({type:"workspace.component.drag",caller:n,undo:function(){n.css({top:r,left:s})},redo:function(){n.css({top:o,left:i})}})}},C=function(e,t){a.componentContainer.find(".".concat(v)).each((function(n,o){const a=$(o);a.draggable("instance")?a.draggable(e):t&&a.draggable(x).bindIframeFixEvents("drag").draggable(e)}))};function k(){a.componentContainer.find(".".concat(v)).get().reverse().forEach((function(e){const t=$(e),n=t.position();h.watch(t,"Component"),t.css({position:"absolute",top:Math.max(0,n.top),left:Math.max(0,n.left),"z-index":0}).off("mousedown.layerhelper").on("mousedown.layerhelper",(()=>f.bringToFront(t)))})),C("enable",!0)}function D(e,t){const n=_.id.cache(e),o=_.id.ref(e),a=o.options().height,i=o.compInstance(!0),r=i.find(".component__header").outerHeight(!0)||0,s=i.find(".component__hub").outerHeight(!0)||0,c=i.find(".component__body"),l=c.outerHeight()-c.height();i.css("height",""),c.css("height","".concat(Math.max(t-r-s-l,a),"px")),t<(a+r+s)/2?(i.height(r),i.removeClass("primary").css("overflow","hidden").find(".component__header__modes.right").hide(),n.isMore=!1):(o.options().primary&&i.addClass("primary"),i.css("overflow","").find(".component__header__modes.right").show(),n.isMore=!0)}return a.hub._events.on("toworkspace",(function(){o.tabWorkspace.trigger("click"),a.componentContainer.find(".focus").removeClass("focus");const e=this.isMaximized()?this.compInstance(!0):this.minCompInstance(!0);e.parent().addClass("focus").scrollintoview(),setTimeout((()=>e.parent().removeClass("focus")),5e3)})),a._events.on("redo",(()=>{a.hub.instance(!0).is(":visible")?a.hub._commands.redo():a._commands.redo()})).on("undo",(()=>{a.hub.instance(!0).is(":visible")?a.hub._commands.undo():a._commands.undo()})).on("save",(()=>l.compressObj(a.state.backup()))).on("strict",(()=>{a.hub.isStrict()?(a.hub.unstrict(),i=!1):i=!!a.hub.restrict()})).on("switch",(()=>{a._events.call("switch",a)})),k(),a.options=function(){return{strict:i,readOnly:r,name:u}},a.rename=function(e){var t;if((e="".concat(null!==(t=e)&&void 0!==t?t:"").trim()).length&&e!==u){const t=u;s.remove("Session:".concat(u)),u=l.fixDuplicateNames.run(e,"Session"),s.set("Session:".concat(u),!0),a._events.call("rename",a,u,t)}return a},a.destroy=async function(){r||(await _.clear(),a.hub.destroy(),a.componentContainer.remove(),a.minComponentContainer.remove(),a._commands.clear(),s.remove("Session:".concat(u)),l.destroyObj(a))},a.allow=function(e){return r||Object.prototype.hasOwnProperty.call(m,e)||(a._events.call("require",a,e),m[e]=!0),a},a.disallow=async function(e){if(r)return a;for(const t of _.id.getAll())_.id.cache(t).entity===e&&await _.id.remove(t);return delete m[e],a},a.add=async function(e,n,o,i){if(r)return a;let s={},c={};o&&"object"===$.type(o)&&(s=$.extend(s,o.comp),c=$.extend(c,o.hub)),i=$.extend(!0,{component:null,hub:null},i),a.allow(e);let l=await t.Z.events.GetComponent.invoke(e);s&&"object"===$.type(s)&&(l=$.extend(l,s));const d=l.id,u=l.name,p=l.body,m=l.defaultHeight,g=l.defaultWidth,v=l.input,y=l.output,b=l.category,w=!0===l.minimized,x=!(!1===l.more),C=l.version,k=$("<div>"),P=$("<div>");a.componentContainer.append(k),a.minComponentContainer.append(P);const O=ne({compElm:k,minCompElm:P,namespace:d+"@"+C,name:u,body:p,height:m,width:g,primary:!1});O._events.merge(I),_.add(e,O,n,{category:b,isMinimized:w,isMore:!0,version:C}),O.init(),x||D(O._compID,-1);const S=O.compInstance(!0).parent().css("position","absolute");return i.component?(i.component=$.extend({top:0,left:0},i.component),h.watch(S,"Component",{top:parseFloat(i.component.top)||0,left:parseFloat(i.component.left)||0})):h.watch(S,"Component"),S.off("mousedown.layerhelper").on("mousedown.layerhelper",(()=>f.bringToFront(S))),a.hub.add($.extend(!0,{component:O,input:v,output:y,listener:e=>O.api.call("newinput",e)},c),i.hub),a._events.call("add",a,O,e),a},a.state={backup:async function(){const e=a.state.normalize({});e.globals.strictMode=i,e.globals.name=u,e.globals.scroll.cTop=a.componentContainer.scrollTop(),e.globals.scroll.cLeft=a.componentContainer.scrollLeft(),e.globals.scroll.mcTop=a.minComponentContainer.scrollTop(),e.globals.scroll.mcLeft=a.minComponentContainer.scrollLeft(),e.globals.maxZIndex=f.maxZIndex;const t=_.id.getAll(),n=a.hub.state.backup(),o={};a.componentContainer.find('[class^="cp"]').each((function(e,t){const n=t.className.match(/\bcp\w+/g)[0];o[n]=e})),t.sort(((e,t)=>o[e]<o[t]?-1:1)),n.components.sort(((e,t)=>o[e.compID]<o[t.compID]?-1:1));for(let o=0;o<t.length;++o){const i=t[o],r=_.id.query(i),s=_.id.ref(i),c=_.id.cache(i),l=s.compInstance(!0).parent(),d=s.options(),u={top:l.css("top"),left:l.css("left"),zIndex:l.css("z-index"),height:l.find(".component__body").css("height"),width:l[0].style.width||""},p=c.entity,m=c.isMinimized,h=c.isMore,f=c.version,g=n.components[o].css,v=a.hub.compOptions(n.components[o].compID),y=await s.state.backup();e.components.push({alt:r,entity:p,isMinimized:m,isMore:h,version:f,css:u,state:y,extend:{name:d.name,primary:d.primary,silent:d.silent,background:d.silent?"":d.background},hub:{extend:{autoUpdatable:v.autoUpdatable,minimized:v.minimized},css:{top:g.top,left:g.left,zIndex:g.zIndex,width:g.width}}})}n.connections.forEach((function(t){e.hub.connections.push({inputCompAlt:_.id.query(t.inputCompID),inputParam:t.inputParam,outputCompAlt:_.id.query(t.outputCompID),outputParam:t.outputParam,zIndex:t.zIndex})})),e.hub.props=n.props;const r=h.savedPositions();for(const t in r)e.positioning[t]=r[t];return e},restore:async function(e){if(!(e=await a.state.sanitizeComponents(e)))return!1;const t={dict:{},secure:function(e){let n=e;for(let e=1;_.alt.has(n);n="comp".concat(e++));return t.dict[e]=n,t}};l.pausePositioning=!0,k(),i=e.globals.strictMode,i?a.hub.restrict():a.hub.unstrict(),a.rename(e.globals.name),f.maxZIndex=e.globals.maxZIndex;const n=a.hub.state.normalize({});for(const o of e.components){o.alt=t.secure(o.alt).dict[o.alt],await a.add(o.entity,o.alt,{comp:$.extend(o.extend,{minimized:o.isMinimized,more:o.isMore}),hub:o.hub.extend});const e=_.alt.ref(o.alt);await e.state.restore(o.state),e.compInstance(!0).css("width",o.css.width).parent().css({top:o.css.top,left:o.css.left,zIndex:o.css.zIndex,width:o.css.width}).find(".component__body").css("height",o.css.height).outerWidth(o.css.width),n.components.push({compID:e._compID,css:o.hub.css})}e.hub.connections.forEach((function(e){n.connections.push({inputCompID:_.alt.query(t.dict[e.inputCompAlt]),inputParam:e.inputParam,outputCompID:_.alt.query(t.dict[e.outputCompAlt]),outputParam:e.outputParam})})),n.props=$.extend(n.props,e.hub.props),a.hub.state.restore(n),l.pausePositioning=!1;for(const t in e.positioning)h.fixPosition(e.positioning[t],t);return a.componentContainer.scrollTop(e.globals.scroll.cTop).scrollLeft(e.globals.scroll.cLeft),a.minComponentContainer.scrollTop(e.globals.scroll.mcTop).scrollLeft(e.globals.scroll.mcLeft),!0},normalize:function(e){if("object"!==$.type(e))return{};let t={};t=$.extend(!0,{globals:{},components:[],hub:{},positioning:{}},e),t.globals=$.extend(!0,{strictMode:!0,name:"Session",scroll:{},maxZIndex:0},t.globals),t.globals.scroll=$.extend(!0,{cTop:0,cLeft:0,mcTop:0,mcLeft:0},t.globals.scroll);for(let e=0;e<t.components.length;++e)t.components[e]=$.extend(!0,{alt:"",entity:"",isMinimized:!1,isMore:!0,state:"{}",css:{},extend:{},hub:{}},t.components[e]),t.components[e].css=$.extend(!0,{top:"",left:"",zIndex:"",height:"",width:""},t.components[e].css),t.components[e].extend=$.extend(!0,{name:"",primary:!1,silent:!1,background:""},t.components[e].extend),t.components[e].hub=$.extend(!0,{extend:{},css:{}},t.components[e].hub),t.components[e].hub.css=$.extend(!0,{top:0,left:0,zIndex:"",width:""},t.components[e].hub.css),t.components[e].hub.extend=$.extend(!0,{name:"",primary:!1,silent:!1,background:""},t.components[e].hub.extend);t.hub=$.extend(!0,{connections:[],props:{}},t.hub);for(let e=0;e<t.hub.connections.length;++e)t.hub.connections[e]=$.extend(!0,{inputCompAlt:"",inputParam:"",outputCompAlt:"",outputParam:"",zIndex:""},t.hub.connections[e]);t.hub.props=$.extend(!0,{transform:"",layering:{},positioning:{}},t.hub.props),t.hub.props.layering=$.extend(!0,{minZIndex:0,maxZIndex:0},t.hub.props.layering);for(const e in t.hub.props.positioning)t.hub.props.positioning[e]=$.extend(!0,{top:0,left:0,zIndex:""},t.hub.props.positioning[e]);t.positioning=$.extend({},t.positioning);for(const e in t.positioning)t.positioning[e]=$.extend({top:0,left:0,zIndex:""},t.positioning[e]);return t},sanitizeComponents:async function(e){e=a.state.normalize(e);const n=[];for(let o=0;o<e.components.length;++o){const a=e.components[o],i=await t.Z.events.GetCompatibleComponent.invoke(a.entity);if(i){const e=await t.Z.events.GetComponent.invoke(i,!0);$.isEmptyObject(e)&&n.push({required:a.entity,error:"Missing"})}else n.push({required:a.entity,error:"Unsupported"});a.entity=i}if(n.length){let t='<div class="componentpass__text">Found <span class="counter">'.concat(n.length," error").concat(n.length>1?"s":"","</span> while importing <strong>").concat(y(e.globals.name),'</strong>:</div>\n <div class="componentpass">\n <div class="componentpass__item head">\n <div class="componentpass__item__col left">Required</div>\n <div class="componentpass__item__col right">Error</div>\n </div>');return n.forEach((function(e){t+='<div class="componentpass__item">\n <div class="componentpass__item__col left">'.concat(e.required,'</div>\n <div class="componentpass__item__col right error">').concat(e.error,"</div>\n </div>")})),t+="</div>",$.alert($.extend({},l.alertConfiguration,{title:"Import failed",content:t})),null}return e}},a}({componentContainer:n,minComponentContainer:m,hub:o,tabWorkspace:u.find('.topnav__wrapper__tablist__item[data-tab=".WORKSPACE"]'),tabGraph:u.find('.topnav__wrapper__tablist__item[data-tab=".GRAPH"]')});return _.addWorkspace(n),_.addWorkspaceMin(m),_.addGraph(o),h._events.on("rename",(function(e){a._tabs.updateTitle(h._sessionID,e)})).on("switch",a.openSwitcher).on("require",(function(e){i[this._sessionID].entities[e]=[]})).on("componentManager.add",(function(e,t,n){if(!Object.prototype.hasOwnProperty.call(i[this._sessionID].entities,n.entity))throw new Error("An entity [".concat(n.entity,"] has to be required before adding [session:").concat(this.options().name,"]."));i[this._sessionID].entities[n.entity].push(t._compID)})).on("componentManager.remove",(function(e,t,n){i[this._sessionID].entities[n.entity]=i[this._sessionID].entities[n.entity].filter((e=>e!==t))})),i[h._sessionID]={entities:{},ref:h},a._tabs.add(h._sessionID,h.options().name),a._tabs._events.on(h._sessionID,(()=>a.switchTo(h._sessionID))),a._events.call("add",a,h._sessionID),a.switchTo(h._sessionID),h._sessionID},a.duplicateSession=async function(e){const t=a.getSession(e);return t?await ke(u,{fixed:!0,body:$e("Please wait while we are duplicating the sesison",!0).html()}).show().then((async e=>{const n=await t.state.backup(),o=a.getSession(a.addSession());return o?(a.switchTo(o),await o.state.restore(n),await e.hide(),o._sessionID):null})):null},a.getSession=function(e){return e in i?i[e].ref:null},a.getCurrentSession=function(){return f?a.getSession(f):null},a.removeSession=async function(e){if(e in i){await i[e].ref.destroy(),delete i[e],a._tabs.remove(e,!0),a._events.call("remove",a,f),f="";for(const e in i)return a.switchTo(e),a;_.update(),a._events.call("switch",a,"")}return a},a.switchTo=function(e){return e in i&&e!==f&&(f=e,_.update(),a._tabs.setActive(e),a._events.call("switch",a,f)),a},a.autoSave={},a.autoSave.init=function(){return o.autoSave||(b("autoSave",!0),async function e(){o.autoSave&&(await a._version.commit(l.compressObj(await a.state.backup(!1))),$.toast($.extend({},l.toastConfiguration,{heading:"Auto Save",text:"Your latest work has just been saved for loss prevention."})),r=setTimeout(e,3e5))}()),a},a.autoSave.stop=function(){return o.autoSave&&(b("autoSave",!1),clearTimeout(r)),a},a.autoSave.running=()=>o.autoSave,a.state={backup:function(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return Promise.resolve(e?ke(u,{fixed:!0,body:$e("Please wait while we are saving your project",!0).html()}).show():void 0).then((async e=>{const t=a.state.normalize({});for(const{id:e}of a._tabs.getState())Object.prototype.hasOwnProperty.call(i,e)&&(e===f&&(t.opening=t.sessions.length),t.sessions.push(await i[e].ref.state.backup()));return Promise.resolve(e?e.destroy():void 0).then((()=>t))}))},restore:function(e){return ke(u,{fixed:!0,body:$e("Restoring your project",!0).html()}).show().then((async t=>{await async function(){await a._version.destroy();for(;f;)await a.removeSession(f);_.update()}(),e=a.state.normalize(e);let n="",i=!0;for(let t=0;t<e.sessions.length;++t){const o=e.sessions[t],r=a.addSession();i&&(i=await a.getSession(r).state.restore(o)),t===e.opening&&(n=r)}return a.switchTo(n),a._version=await h(a._wrapperID).init(),o.autoSave&&(o.autoSave=!1,a.autoSave.init()),Promise.resolve(t?t.destroy():void 0).then((()=>i))}))},normalize:e=>"object"!==$.type(e)?{}:e=$.extend(!0,{opening:"",sessions:[]},e)},a}let Pe=!1;let Oe=!1;function Se(e,t){const n=f.getMenuItemsById("file");n.name=e,n.$.attr("title",t)}let Ae=!1;let Me=!1;let ze=!1;let Ee=!1;let je=!1;let Te=!1,qe=!1;class Re{static getIsMaximized(){return qe}static bindAll(){Te||(t.Z.on({id:"Reload",name:"request-reload"}).on({id:"Unload",name:"request-unload"}).on({id:"Maximize",name:"request-maximize",caller:()=>{qe=!0,_.getMenuItemsById("maximize").hide(),_.getMenuItemsById("unmaximize").show()}}).on({id:"Unmaximize",name:"request-unmaximize",caller:()=>{qe=!1,_.getMenuItemsById("maximize").show(),_.getMenuItemsById("unmaximize").hide()}}).on({id:"IsMaximized",name:"request-is-maximized"}).on({id:"Minimize",name:"request-minimize"}).on({id:"RaiseError",name:"request-raise-error",caller:(e,t)=>{$.alert($.extend({},l.alertConfiguration,{title:"Error",content:'<span style="white-space: pre-wrap;">'.concat(y(t),"</span>")}))}}).on({id:"Destroy",name:"request-destroy"}).on({id:"WillClose",name:"request-will-close",caller:()=>{g((()=>{m.clear(),t.Z.events.Destroy.send()}))}}),Te=!0)}}$(window).on("DOMContentLoaded",(async function(){(class{static bindAll(){Pe||(t.Z.on({id:"ComponentFetch",name:"request-component-fetch",onlyInvoke:!0}),Pe=!0)}}).bindAll(),class{static bindAll(){ze||(t.Z.on({id:"ComponentRunFile",name:"request-component-run-file",onlyInvoke:!0}).on({id:"ComponentRunCommand",name:"request-component-run-command",onlyInvoke:!0}).on({id:"ComponentRunCommandInShell",name:"request-component-run-command-in-shell",onlyInvoke:!0}),ze=!0)}}.bindAll(),class{static bindAll(){Ee||(t.Z.on({id:"GetStorage",name:"request-get-storage",onlyInvoke:!0}).on({id:"SetStorage",name:"request-set-storage",onlyInvoke:!0}).on({id:"GetField",name:"request-get-field",onlyInvoke:!0}).on({id:"SetField",name:"request-set-field",onlyInvoke:!0}),Ee=!0)}}.bindAll(),class{static bindAll(){je||(t.Z.on({id:"ComponentSystemInfo",name:"request-component-system-info",onlyInvoke:!0}),je=!0)}}.bindAll(),Re.bindAll(),hotkeys("f5",(()=>{t.Z.events.Reload.send()}));let e=await t.Z.events.GetStorage.invoke("layout");try{e=JSON.parse(e)}catch(t){e={}}const n=De($("#app"),e);(class{static bindAll(e){Oe||(t.Z.on({id:"OpenProject",name:"request-open-project",caller:(t,n)=>{g((()=>{Se(n.ellipted,n.fullPath),e.state.restore(l.decompressObj(n.data))}))},onlyInvoke:!0}).on({id:"SaveProject",name:"request-save-project",caller:(e,t)=>{Se(t.ellipted,t.fullPath)},onlyInvoke:!0}).on({id:"SaveProjectAs",name:"request-save-project-as",onlyInvoke:!0}).on({id:"EnableSaveAs",name:"request-enable-save-as",caller:()=>{f.getMenuItemsById("saveprojectas").enable()}}).on({id:"OpenSession",name:"request-open-session",caller:(t,n)=>{const o=e.getSession(e.addSession());o.state.restore(n.data),e.switchTo(o._sessionID)},onlyInvoke:!0}).on({id:"ImportSession",name:"request-import-session",caller:(t,n)=>{const o=e.getCurrentSession();o&&o.state.restore(n.data)},onlyInvoke:!0}).on({id:"SaveSessionAs",name:"request-save-session-as",onlyInvoke:!0}).on({id:"ComponentReadFile",name:"request-component-read-file",onlyInvoke:!0}).on({id:"ComponentReadFileFrom",name:"request-component-read-file-from",onlyInvoke:!0}).on({id:"ComponentSaveFile",name:"request-component-save-file",onlyInvoke:!0}).on({id:"ComponentSaveFileAs",name:"request-component-save-file-as",onlyInvoke:!0}).on({id:"ReadFile",name:"request-read-file",onlyInvoke:!0}).on({id:"SaveFile",name:"request-save-file",onlyInvoke:!0}),Oe=!0)}}).bindAll(n),class{static bindAll(e){Ae||(t.Z.on({id:"PushLog",name:"request-push-log",caller:function(t,n){e._events.call("sticky-log",e,n)}}),Ae=!0)}}.bindAll(n),class{static bindAll(e){Me||(t.Z.on({id:"RefreshPackages",name:"request-refresh-packages",caller:function(){e._events.call("sticky-refresh-components")}}).on({id:"GetPackages",name:"request-get-packages"}).on({id:"GetPackage",name:"request-get-package",onlyInvoke:!0}).on({id:"GetComponent",name:"request-get-component",onlyInvoke:!0}).on({id:"GetCompatibleComponent",name:"request-get-compatible-component",onlyInvoke:!0}).on({id:"AddPackages",name:"request-add-packages",onlyInvoke:!0}).on({id:"CompilePackage",name:"request-compile-package",onlyInvoke:!0}).on({id:"RemovePackage",name:"request-remove-package",onlyInvoke:!0}),Me=!0)}}.bindAll(n),n._events.on("layout-update",(e=>{e.browser.show?f.getMenuItemsById("browser").tick():f.getMenuItemsById("browser").untick(),e.componentView?f.getMenuItemsById("components").tick():f.getMenuItemsById("components").untick()})),n._events.on("switch",a),a(),await n.init(),$.fn.updateTitle(""),"darwin"!==window.platform.get()&&(_.mainMenu.$.addClass("buttons").find(".menubar__item svg").css("margin","5px 8px"),_.mainMenu.show(null,!0),_.mainMenu.$.parent().css({left:"",right:0,boxShadow:"none",zIndex:l.menubarButtonsZIndex})),f.mainMenu.show(null,!0),f.mainMenu.$.parent().css({width:"100%",paddingRight:"darwin"===window.platform.get()?0:_.mainMenu.$.width(),overflow:"hidden"}).children().css({width:"100%",overflow:"auto"}).css("-webkit-app-region","drag");const o=m.getStorageOfField("common");if(f._events.on("newproject",(()=>{g((()=>{m.clear(),t.Z.events.Unload.send("newproject")}))})).on("openproject",(()=>{t.Z.events.OpenProject.invoke()})).on("saveproject",(()=>{n.state.backup().then((e=>{t.Z.events.SaveProject.invoke(l.compressObj(e))}))})).on("saveprojectas",(()=>{n.state.backup().then((e=>{t.Z.events.SaveProjectAs.invoke(l.compressObj(e))}))})).on("undo",(()=>{const e=n.getCurrentSession();e&&e._events.call("undo")})).on("redo",(()=>{const e=n.getCurrentSession();e&&e._events.call("redo")})).on("autosave",(e=>{n.autoSave.running()?$.confirm($.extend({},l.confirmConfiguration,{content:"Are you sure to disable auto save? Any unsaved progress will be lost in the event of crashes and shutdowns.",buttons:{confirm:()=>{n.autoSave.stop(),e.menuItem.untick()},cancel:()=>{}}})):$.confirm($.extend({},l.confirmConfiguration,{content:"Are you sure to enable auto save? It may reduce the performance when working on big projects.",buttons:{confirm:()=>{n.autoSave.init(),e.menuItem.tick()},cancel:()=>{}}}))})).on("newsession",(()=>{n.switchTo(n.addSession())})).on("opensession",(()=>{t.Z.events.OpenSession.invoke()})).on("importsession",(()=>{t.Z.events.ImportSession.invoke()})).on("savesessionas",(()=>{const e=n.getCurrentSession();e&&t.Z.events.SaveSessionAs.invoke(l.compressObj(e._events.call("save")))})).on("absoluteapicheck",(e=>{let{menuItem:t}=e;t.isTicked()?$.confirm($.extend({},l.confirmConfiguration,{content:"Are you sure to disable Absolute API Permission Check? This will allow the components to <strong>access your files</strong> via absolute paths <strong>without you knowing it</strong>.",buttons:{confirm:()=>{t.untick(),o.setItem("absolute_api_check","false")},cancel:()=>{}}})):(t.tick(),o.setItem("absolute_api_check","true"))})).on("portapiwarning",(e=>{let{menuItem:t}=e;t.isTicked()?$.confirm($.extend({},l.confirmConfiguration,{content:"Are you sure to disable Port API Warning? This will allow the components to <strong>arbitrarily</strong> listen to ports that might lead to <strong>cyclic updates</strong> that <strong>freeze</strong> the application.",buttons:{confirm:()=>{t.untick(),o.setItem("port_api_warning","false")},cancel:()=>{}}})):(t.tick(),o.setItem("port_api_warning","true"))})).on("strict",(e=>{const t=n.getCurrentSession();t&&(t._events.call("strict"),t.options().strict?e.menuItem.tick():e.menuItem.untick())})).on("exit",(()=>{t.Z.events.Unload.send("exit")})).on("browser",(()=>{n.browserView.toggle()})).on("components",(()=>{n.componentView.toggle()})),"darwin"!==window.platform.get())_._events.on("minimize",(()=>{t.Z.events.Minimize.send()})).on("maximize",(()=>{t.Z.events.Maximize.send()})).on("unmaximize",(()=>{t.Z.events.Unmaximize.send()})).on("close",(()=>{f._events.call("exit",null)}));else{const e=f.getMenuItemsById("trafficlights").$.find(".trafficlight"),n=e.find(".trafficlight-close"),o=e.find(".trafficlight-minimize"),a=e.find(".trafficlight-fullscreen"),i=()=>{Re.getIsMaximized()?t.Z.events.Unmaximize.send():t.Z.events.Maximize.send()};e.on("click",(e=>{const r=e.target;n.has(r).length?f._events.call("exit",null):o.has(r).length?t.Z.events.Minimize.send():a.has(r).length&&i()})).on("dblclick",(e=>{const t=e.target;n.has(t).length||o.has(t).length||a.has(t).length||i()}))}function a(e){["importsession","savesessionas","strict"].forEach((t=>{e?f.getMenuItemsById(t).enable():f.getMenuItemsById(t).disable()}));const t=f.getMenuItemsById("strict"),o=n.getCurrentSession();o&&o.options().strict?t.tick():t.untick()}n.autoSave.running()?f.getMenuItemsById("autosave").tick():f.getMenuItemsById("autosave").untick(),"false"!==await o.getItem("absolute_api_check")?f.getMenuItemsById("absoluteapicheck").tick():f.getMenuItemsById("absoluteapicheck").untick(),"false"!==await o.getItem("port_api_warning")?f.getMenuItemsById("portapiwarning").tick():f.getMenuItemsById("portapiwarning").untick(),t.Z.events.IsMaximized.sendSync()})).on("beforeunload",(()=>{m.clear()}))})()})();